<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Install archlinux on Thinkbook14 G4+ ARA</title>
      <link href="/2022/09/20/Install-archlinux-on-Thinkbook14-G4-ARA/"/>
      <url>/2022/09/20/Install-archlinux-on-Thinkbook14-G4-ARA/</url>
      
        <content type="html"><![CDATA[<h2 id="0-å‰è¨€">0 å‰è¨€</h2><p>â€‹æ–°åˆ°çš„Thinkbook 14+ AMD 6800h åˆ°æ‰‹åè¿«ä¸åŠå¾…çš„è¯•å›¾å®‰è£…åŒç³»ç»ŸWin11+Archlinux</p><p>ç”±äºæ˜¯æ–°ç¬”è®°æœ¬æ–°CPU,åœ¨å®‰è£…è¿‡ç¨‹ä¸­å‡ºç°äº†è®¸å¤šé—®é¢˜ï¼Œç‰¹æ„è®°å½•ä¸€ä¸‹ã€‚</p><h2 id="1-å®‰è£…windows11">1. å®‰è£…windows11</h2><p>â€‹å‡ºå‚windowså¸¦äº†å¤ªå¤šæ†ç»‘è½¯ä»¶ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºè”æƒ³ç®¡å®¶ç­‰ã€‚æœ¬äººé€‰æ‹©é‡æ–°å®‰è£…</p><ol><li><p>ä½¿ç”¨<a href="https://rufus.ie/zh/">rufus</a>å°†windows11é•œåƒçƒ§å½•è‡³Uç›˜åˆ¶ä½œç³»ç»Ÿå¯åŠ¨ç›˜</p></li><li><p>å¯åŠ¨é˜¶æ®µæŒ‰<code>F12</code>ï¼ˆä¸éœ€è¦æŒ‰ä½<code>Fn</code>ï¼‰è¿›å…¥å¯åŠ¨é€‰é¡¹ï¼Œé€‰æ‹©USBå¯åŠ¨</p></li><li><p>windowså®‰è£…ä¸€è·¯ç‚¹ç‚¹ç‚¹å°±å¥½</p></li><li><p>å®‰è£…é©±åŠ¨</p><p>ç”±äºwindowsé•œåƒä¸­ä¸åŒ…å«èƒèŸ¹æ— çº¿ç½‘å¡çš„é©±åŠ¨ï¼Œåœ¨å®‰è£…ç³»ç»Ÿè¿æ¥ç½‘ç»œéƒ¨åˆ†é€‰æ‹©è¿æ¥ç½‘çº¿(è¿™æ¬¾ç¬”è®°æœ¬å±…ç„¶æœ‰ç½‘å£)ã€‚</p><p>å½“ç„¶ä¹Ÿå¯ä»¥é€‰æ‹©è¿›å…¥ç³»ç»Ÿåå®‰è£…é©±åŠ¨ï¼Œ<a href="https://think.lenovo.com.cn/support/driver/newdriversdownlist.aspx?categoryid=15260&amp;CODEName=thinkbook%2014%20G4+%20ARA&amp;SearchType=%200&amp;wherePage=%202">é©±åŠ¨</a>ç”±è”æƒ³å®˜æ–¹æä¾›ï¼Œä¸‹è½½åç›´æ¥å®‰è£…å³å¯</p></li><li><p>è®¾ç½®ä¸­æ–‡è¾“å…¥æ³•</p><p>å®‰è£…ç³»ç»Ÿåå‘ç°å¾®è½¯æ‹¼éŸ³ä¸å‡ºç°å€™é€‰è¯ï¼Œè€Œæ˜¯ç›´æ¥æ•²å›è½¦åå‡ºç°æ–‡å­—</p><p>è§£å†³æ–¹æ³•ï¼šåœ¨é”®ç›˜ä¸­å…¶å¯ç”¨æ—§ç‰ˆå¾®è½¯æ‹¼éŸ³ï¼Œå…·ä½“æ“ä½œæµç¨‹å¦‚ä¸‹</p><p>è®¾ç½® -&gt; æ—¶é—´å’Œè¯­è¨€ -&gt; è¯­è¨€&amp;åŒºåŸŸ -&gt; Microsoftæ‹¼éŸ³ -&gt; å¸¸è§„ -&gt; å…¼å®¹æ€§ -&gt; ä½¿ç”¨ä»¥å‰ç‰ˆæœ¬çš„å¾®è½¯æ‹¼éŸ³è¾“å…¥æ³•</p></li></ol><h2 id="2-å®‰è£…Archlinux">2. å®‰è£…Archlinux</h2><h3 id="2-1-ç³»ç»Ÿå®‰è£…">2.1 ç³»ç»Ÿå®‰è£…</h3><p>â€‹Arch Linuxç³»ç»Ÿå®‰è£…è¿‡ç¨‹æ•´ä½“ä¸Šä¸<a href="https://arch.icekylin.online/prologue.html">archlinux ç®€æ˜æ•™æ</a>ä¸€è‡´ï¼Œä¸»è¦å·®åˆ«åœ¨äºæˆ‘ä½¿ç”¨<em>sysemd-boot</em>ä½œä¸ºbootloaderè¿›è¡Œç³»ç»Ÿçš„å¼•å¯¼ï¼Œæ²¡æœ‰é‡‡ç”¨åŸæ–‡ä¸­è¾ƒä¸ºè‡ƒè‚¿çš„grub2è¿›è¡Œç³»ç»Ÿå¼•å¯¼ã€‚</p><p>éœ€è¦æ”¹å˜çš„åœ°æ–¹</p><ul><li><p>EFIåˆ†åŒºæŒ‚è½½ç‚¹ä¸åŒ</p><p>åŸæ–‡åœ¨<a href="https://arch.icekylin.online/rookie/basic-install.html#_8-%E6%8C%82%E8%BD%BD">åŸºç¡€å®‰è£… æ­¥éª¤8</a>å°†EFIåˆ†åŒºæŒ‚è½½åˆ°ç³»ç»Ÿé•œåƒ<code>/boot/efi</code>ï¼Œè¦<strong>æŒç»­æ›´æ–°å†…æ ¸</strong>ï¼Œå»ºè®®å°† ESP æŒ‚è½½åˆ° <code>/boot</code>ï¼Œå®‰è£…å†…æ ¸æ—¶ä¼šè‡ªåŠ¨å¤åˆ¶åˆ°<code>/boot</code>ç›®å½•ä¸‹. å¦‚æœæ²¡å°† ESP æŒ‚è½½åˆ° <code>/boot</code>,éœ€è¦æ‰‹åŠ¨å°†å†…æ ¸å’Œ initramfs å¤åˆ¶åˆ° ESP</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mount -t btrfs -o subvol=/@,compress=zstd /dev/nvmexn1pn /mnt <span class="comment"># æŒ‚è½½ / ç›®å½•</span></span><br><span class="line">mkdir /mnt/home <span class="comment"># åˆ›å»º /home ç›®å½•</span></span><br><span class="line">mount -t btrfs -o subvol=/@home,compress=zstd /dev/nvmexn1pn /mnt/home <span class="comment"># æŒ‚è½½ /home ç›®å½•</span></span><br><span class="line">mkdir -p /mnt/boot <span class="comment"># åˆ›å»º /boot/efi ç›®å½•</span></span><br><span class="line">mount /dev/nvmexn1pn /mnt/boot <span class="comment"># æŒ‚è½½ /boot/efi ç›®å½•</span></span><br><span class="line">swapon /dev/nvmexn1pn <span class="comment"># æŒ‚è½½äº¤æ¢åˆ†åŒº</span></span><br></pre></td></tr></table></figure></li><li><p>bootloaderä¸åŒ</p><p>åŸæ–‡åœ¨<a href="https://arch.icekylin.online/rookie/basic-install.html#_17-%E5%AE%89%E8%A3%85%E5%BC%95%E5%AF%BC%E7%A8%8B%E5%BA%8F">åŸºç¡€å®‰è£… æ­¥éª¤17</a>ä½¿ç”¨grubè¿›è¡Œå¼•å¯¼ï¼Œç”±äºä¸éœ€è¦å¼•å¯¼legacyæˆ–è€…å…¶ä»–çš„ç³»ç»Ÿï¼Œæˆ‘é€‰æ‹©ä»…æ”¯æŒEFIå¯åŠ¨çš„<em>systemd-boot</em>ä½œä¸ºbootloader,å…·ä½“æ­¥éª¤å¦‚ä¸‹</p><ol><li><p>å®‰è£… <em>systemd-boot</em> EFI å¯åŠ¨ç®¡ç†å™¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">esp=/boot <span class="comment">#EFIåˆ†åŒºæŒ‚è½½ç‚¹</span></span><br><span class="line">bootctl --path=<span class="variable">$esp</span> install</span><br></pre></td></tr></table></figure></li><li><p>å¯åŠ¨èœå•é…ç½®</p><p>å¯åŠ¨èœå•æ–‡ä»¶ä½äº<code>$esp/loader/loader.conf</code>,å†…å®¹ç¤ºä¾‹å¦‚ä¸‹</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">default  arch.conf</span><br><span class="line">timeout  4</span><br><span class="line">console-mode max</span><br><span class="line">editor   no</span><br></pre></td></tr></table></figure></li><li><p>å¢åŠ å¯åŠ¨é€‰é¡¹</p><p>å¦‚æœå­˜åœ¨çš„è¯,bootctl ä¼šè‡ªåŠ¨ä¸º â€œ<strong>Windows Boot Manager (Windows å¯åŠ¨ç®¡ç†å™¨)</strong>â€ (<code>\EFI\Microsoft\Boot\Bootmgfw.efi</code>), â€œ<strong>EFI Shell</strong>â€ (<code>\shellx64.efi</code>) å’Œ â€œ<strong>EFI Default Loader</strong>â€ (<code>\EFI\Boot\bootx64.efi</code>)å¢åŠ å¯åŠ¨é€‰é¡¹. ä½†å¹¶ä¸ä¼šä¸ºå…¶ä»–EFIåº”ç”¨ç¨‹åºåˆ›å»ºå¯åŠ¨é€‰é¡¹,æ‰€ä»¥éœ€è¦è¿›è¡Œè¿›ä¸€æ­¥è®¾ç½®. å¦‚æœä½ æ˜¯å’ŒWindows ç»„æˆåŒé‡å¯åŠ¨,å»ºè®®ç¦ç”¨ <a href="https://wiki.archlinux.org/title/Dual_boot_with_Windows#Fast_Startup_and_hibernation">Windows ä¸­çš„&quot;å¿«é€Ÿå¯åŠ¨&quot;</a> é€‰é¡¹.</p><p>ä¸ºarchlinuxå¢åŠ å¯åŠ¨é€‰é¡¹ï¼Œæ–°å»ºæ–‡ä»¶<code>$esp/loader/entries/arch.conf</code></p><p>å†…å®¹å¦‚ä¸‹,å®é™…ä¸Šå°±æ˜¯kernelçš„å¯åŠ¨å‚æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">title          Arch Linux</span><br><span class="line">linux          /vmlinuz-linux</span><br><span class="line">initrd   /amd-ucode.img</span><br><span class="line">initrd         /initramfs-linux.img</span><br><span class="line">options        root=PARTUUID=14420948-2cea-4de7-b042-40f67c618660 rw rootflags=subvol=@</span><br></pre></td></tr></table></figure></li></ol></li></ul><p>â€‹4. reboot é‡å¯å³å¯è¿›å…¥è¿›å…¥ç³»ç»Ÿé€‰æ‹©ç•Œé¢è¿›å…¥ç³»ç»Ÿ</p><h3 id="2-2-å†…ç½®é”®ç›˜å¤±çµ">2.2 å†…ç½®é”®ç›˜å¤±çµ</h3><p>â€‹ThinkBook 14+/16+ 2022 é”é¾™ç‰ˆ(AMD é”é¾™ 6000ç³»åˆ—å¤„ç†å™¨ )ç”±äºå…¶ç‹¬ç‰¹çš„IRQè®¾è®¡ï¼Œé”®ç›˜æ— æ³•å…¼å®¹åŸç‰ˆLinuxå†…æ ¸ï¼Œå…¶ååº”ä¸ºé”®ç›˜åƒæ‰€æœ‰é”®åŒæ—¶æŒ‰ä½è€Œå¡ä½ï¼Œæƒ³è¦è§£å†³æ­¤é—®é¢˜ï¼Œéœ€è¦æ‰“ä¸Š<a href="https://patchwork.kernel.org/project/linux-acpi/patch/20220712020058.90374-1-gch981213@gmail.com/">path</a>è¿›è¡Œä¿®æ”¹å¹¶é‡æ–°ç¼–è¯‘Linuxå†…æ ¸</p><p>è¿™é‡Œé‡‡ç”¨ABS(Arch Build System)è¿›è¡Œè‡ªå®šä¹‰kernelçš„ç¼–è¯‘(æ—¢ç„¶archlinuxæä¾›äº†å¥½ç”¨çš„æ„å»ºç³»ç»Ÿï¼Œä¸ºä½•ä¸ç”¨å‘¢:) )</p><p>ä¸»è¦æ­¥éª¤å‚è€ƒ<a href="https://wiki.archlinux.org/title/Kernel/Arch_Build_System">Kernel/Arch Build System</a>,è¿™é‡Œè´´å‡ºè‡ªå·±çš„å…¨éƒ¨è¿‡ç¨‹</p><ol><li><p>æ–°å»ºç¼–è¯‘ç›®å½•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p ~/build</span><br><span class="line"><span class="built_in">cd</span> ~/build</span><br></pre></td></tr></table></figure></li><li><p>å®‰è£…asp å’Œbase-devel</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S asp base-devel</span><br></pre></td></tr></table></figure></li><li><p>è·å–åŸå§‹å†…æ ¸ä½œä¸ºè‡ªå·±ç¼–è¯‘kernelçš„åŸºç¡€</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">asp update linux <span class="comment">#ç”±äºç½‘ç»œé—®é¢˜æˆ‘æ— æ³•æ›´æ–°ï¼Œä¸å½±å“</span></span><br><span class="line">asp <span class="built_in">export</span> linux </span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå®ŒåæŸ¥çœ‹ç›®å½•æ ‘åº”è¯¥æ˜¯è¿™æ ·</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">â””â”€â”€ linux</span><br><span class="line">    â”œâ”€â”€ config</span><br><span class="line">    â”œâ”€â”€ keys</span><br><span class="line">    â”‚Â Â  â””â”€â”€ pgp</span><br><span class="line">    â”‚Â Â      â”œâ”€â”€ 647F28654894E3BD457199BE38DBBDC86092693E.asc</span><br><span class="line">    â”‚Â Â      â”œâ”€â”€ A2FF3A36AAA56654109064AB19802F8B0D70FC30.asc</span><br><span class="line">    â”‚Â Â      â”œâ”€â”€ ABAF11C65A2970B130ABE3C479BE3E4300411886.asc</span><br><span class="line">    â”‚Â Â      â””â”€â”€ C7E7849466FE2358343588377258734B41C31549.asc</span><br><span class="line">    â””â”€â”€ PKGBUILD</span><br><span class="line"></span><br><span class="line">3 directories, 6 files</span><br></pre></td></tr></table></figure></li><li><p>ä¸‹è½½éœ€è¦æ‰“ä¸Šçš„è¡¥ä¸ï¼Œå¹¶æ”¾åœ¨ä¸PKGBUILDåŒçº§ç›®å½•ä¸‹(æ”¹ä¸ºpatchåç¼€æ˜¯å› ä¸ºABSä¼šè‡ªåŠ¨ä¸ºåç¼€ä¸ºpatchè¿›è¡Œæ‰“è¡¥ä¸)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> linux</span><br><span class="line">wget https://patchwork.kernel.org/project/linux-acpi/patch/20220712020058.90374-1-gch981213@gmail.com/raw -O irq.patch <span class="comment">#ä¸‹è½½diffæ–‡ä»¶å¹¶é‡å‘½åä¸ºirq.patch(ä½ ä¹Ÿå¯ä»¥æ‰‹åŠ¨çš„ä¸‹è½½diffæ–‡ä»¶)</span></span><br></pre></td></tr></table></figure></li><li><p>ä¿®æ”¹PKGBUILDæ–‡ä»¶</p><p>æ‰¾åˆ° <code>pkgbase</code> ä¿®æ”¹ä¸ºè‡ªå®šä¹‰è½¯ä»¶åŒ…çš„åç§°</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pkgbase=linux-test</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ æƒ³è¦ç›´æ¥æ›¿æ¢åŸæœ‰çš„kernel,å°±å¯ä»¥ä¸æ”¹ã€‚æ”¹äº†ä¹‹åä½ è¦æ›´æ–°å¼•å¯¼åŠ è½½ç¨‹åºçš„é…ç½®æ–‡ä»¶ï¼Œä¸ºæ–°çš„å†…æ ¸å’Œinitramfsæ˜ åƒæ·»åŠ æ–°çš„å¼•å¯¼èœå•é¡¹ã€‚</p><p>æ‰¾åˆ° <code>source</code>æ•°ç»„(18è¡Œå·¦å³)æ·»åŠ éœ€è¦æ‰“çš„patch</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span>=(</span><br><span class="line">  <span class="string">&quot;<span class="variable">$_srcname</span>::git+https://github.com/archlinux/linux?signed#tag=<span class="variable">$_srctag</span>&quot;</span></span><br><span class="line">  irq.patch      <span class="comment"># ä¸‹è½½çš„è¡¥ä¸</span></span><br><span class="line">  config         <span class="comment"># the main kernel config file</span></span><br><span class="line">  )</span><br></pre></td></tr></table></figure><p>ä¸ºæé«˜ç¼–è¯‘é€Ÿåº¦ï¼Œå¯é‡‡ç”¨å¤šçº¿æ€§å¹¶è¡Œç¼–è¯‘ï¼Œæ‰¾åˆ°build(63è¡Œå·¦å³)ï¼Œä¿®æ”¹,å¯ä»¥è‡ªå·±é€‰æ‹©çº¿ç¨‹æ•°ï¼Œè¿˜å¯ä»¥å‚è€ƒ<a href="https://wiki.archlinux.org/title/Kernel/Arch_Build_System">Kernel/Arch Build System</a>çš„2.1é¿å…åˆ›å»ºæ–‡æ¡£</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">build</span></span>() &#123;</span><br><span class="line">   <span class="built_in">cd</span> <span class="variable">$_srcname</span></span><br><span class="line">   make all -j 16</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ç”Ÿæˆæ–°æ ¡éªŒå’Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S pacman-contrib</span><br><span class="line">updpkgsums</span><br></pre></td></tr></table></figure></li><li><p>ç¼–è¯‘</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S pahole cpio xmlto python-sphinx python-sphinx_rtd_theme graphviz imagemagick texlive-latexextra <span class="comment">#å®‰è£…å¿…è¦ä¾èµ–</span></span><br><span class="line">makepkg -s --skippgpcheck</span><br></pre></td></tr></table></figure></li><li><p>å®‰è£…</p><p>ç¼–è¯‘å®Œæˆåï¼Œ<code>build/linux</code>æ–‡ä»¶å¤¹ä¸­åº”æœ‰ä¸¤ä¸ªåŒ…ï¼Œåˆ†åˆ«æ˜¯å†…æ ¸å’Œå†…æ ¸çš„å¤´æ–‡ä»¶ã€‚è¿›è¡Œå®‰è£…(ä¼šåœ¨/bootä¸‹ç”Ÿæˆinitramfs-linux-testå’Œvmlinuz-linux-test)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pacman -U linux-test-5.19.19-x86_64.pkg.tar.zst linux-custom-headers-5.8.12-x86_64.pkg.tar.zst</span><br></pre></td></tr></table></figure></li><li><p>ä¸ºæ–°çš„kernelé…ç½®å¯åŠ¨é¡¹ï¼Œè§æœ¬æ–‡2.1ä¸­çš„å¢åŠ å¯åŠ¨é€‰é¡¹</p></li><li><p>å¦‚æœæ›´æ¢äº†å†…æ ¸ï¼Œåˆ«å¿˜äº†æŠŠä¹‹å‰åœ¨åŸæ¥å†…æ ¸çš„è½¯ä»¶é‡æ–°è£…ä¸€éï¼Œæ¯”å¦‚è¯´æ¡Œé¢ç¯å¢ƒï¼Œæˆ‘å‘ç°åç»­åœ¨æ–°å†…æ ¸å®‰è£…çš„ç¨‹åºåœ¨æ¡Œé¢åº”ç”¨ç¨‹åºæ‰¾ä¸åˆ°ï¼Œé‡æ–°å®‰è£…ä¸€ä¸‹kdeå°±å¥½äº†</p></li></ol><h3 id="2-3-ç½‘å¡é©±åŠ¨">2.3 ç½‘å¡é©±åŠ¨</h3><p>å®‰è£…<a href="https://github.com/lwfinger/rtw8852be">8852beé©±åŠ¨</a></p><h3 id="2-4-æ— æ³•æ’­æ”¾å£°éŸ³">2.4 æ— æ³•æ’­æ”¾å£°éŸ³</h3><p>å£°å¡é©±åŠ¨æœ‰ï¼Œä½†æ˜¯æ— æ³•æ’­æ”¾å£°éŸ³ï¼Œç¼ºå¤±<a href="https://wiki.archlinux.org/title/Advanced_Linux_Sound_Architecture">alaså›ºä»¶</a></p><p>è§£å†³æ–¹æ³•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S sof-firmware alsa-ucm-conf</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> archlinux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Archlinuxçš„åŒ…ç®¡ç†</title>
      <link href="/2022/09/03/Installation-on-Archlinux/"/>
      <url>/2022/09/03/Installation-on-Archlinux/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€">å‰è¨€</h3><p>æœ¬æ–‡ä¸»è¦è®²è¿°archlinuxå¸¸ç”¨çš„åŒ…ç®¡ç†å’Œå’Œå¯¹äºappçš„å®‰è£…æ–¹æ³•ã€‚ArchlinuxåŒ…ç®¡ç†è½¯ä»¶ä¸»è¦ç”±Pacmanä»¥åŠAURæä¾›</p><h3 id="Pacman">Pacman</h3><p><a href="https://wiki.archlinux.org/title/pacman">Pacman</a>æ˜¯Archä¸‹å®˜æ–¹çš„åŒ…ç®¡ç†è½¯ä»¶ï¼Œæ‰€æœ‰èƒ½å¤Ÿé€šè¿‡pacmanä¸‹è½½å®‰è£…ï¼Œè¢«çº³å…¥å®˜æ–¹è½¯ä»¶åŒ…åˆ—è¡¨çš„è½¯ä»¶ï¼Œéƒ½å¯ä»¥åœ¨<a href="https://archlinux.org/packages/">Arch Pachages</a>æ‰¾åˆ°</p><ol><li><p>å®‰è£…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S &lt;package-name&gt;</span><br></pre></td></tr></table></figure></li><li><p>æ›´æ–°/å‡çº§</p><p>æ›´æ–°AUR è½¯ä»¶åŒ…æ•°æ®åº“</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -Syy</span><br></pre></td></tr></table></figure><p>æ›´æ–° AUR è½¯ä»¶åŒ…æ•°æ®åº“å¹¶å‡çº§æ‰€æœ‰å·²å®‰è£…çš„è½¯ä»¶åŒ…(åŒ…æ‹¬å†…æ ¸ï¼Œå°å¿ƒé£æ»šè‰ğŸ˜ˆï¸)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -Syyu</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ -S è¡¨ç¤º syncï¼ˆåŒæ­¥ï¼‰ï¼Œ-y è¡¨ç¤ºä»æœåŠ¡å™¨ä¸‹è½½æ–°çš„è½¯ä»¶åŒ…æ•°æ®åº“ï¼Œ-yy è¡¨ç¤ºå¼ºåˆ¶æ›´æ–°è½¯ä»¶åŒ…æ•°æ®åº“,-u è¡¨ç¤º upgradeï¼ˆå‡çº§</p></li><li><p>å¸è½½</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman --Rscnu &lt;package-name&gt;</span><br></pre></td></tr></table></figure><p>-R è¡¨ç¤º Removeï¼ˆç§»é™¤ï¼‰ï¼Œ-s åˆ é™¤ä¸éœ€è¦çš„ä¾èµ–å…³ç³»ï¼Œ-cï¼ˆcascadeï¼‰åˆ é™¤è½¯ä»¶åŒ…åŠæ‰€æœ‰ä¾èµ–äºæ­¤çš„è½¯ä»¶åŒ…ï¼Œ-n è¡¨ç¤º nosaveï¼ˆåˆ é™¤é…ç½®æ–‡ä»¶ï¼‰ï¼Œ-u è¡¨ç¤º unneeded</p></li><li><p>æœç´¢</p><p>åœ¨çº¿æœç´¢</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -Ss &lt;key-word&gt;</span><br></pre></td></tr></table></figure><p>æœ¬åœ°æœç´¢</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -Qs &lt;key-word&gt; <span class="comment">#æ¨¡ç³ŠåŒ¹é…</span></span><br><span class="line">sudo pacman -Q &lt;package-name&gt; <span class="comment">#ç²¾ç¡®åŒ¹é… </span></span><br></pre></td></tr></table></figure></li><li><p>å®‰è£…æœ¬åœ°è½¯ä»¶åŒ…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -U &lt;package-path&gt;</span><br></pre></td></tr></table></figure></li><li><p>æ¸…ç†æ— ç”¨è½¯ä»¶åŒ…å’Œç¼“å­˜</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -Scc</span><br></pre></td></tr></table></figure></li></ol><h3 id="AUR">AUR</h3><p><a href="https://aur.archlinux.org/">Aur</a>æ˜¯Arch ç”¨æˆ·è½¯ä»¶ä»“åº“ï¼Œå…¨ç§° Arch User-community Repositoryï¼ŒAUR æ˜¯ä¸ºç”¨æˆ·è€Œå»ºã€ç”±ç”¨æˆ·ä¸»å¯¼çš„ Arch è½¯ä»¶ä»“åº“.</p><p>å¾ˆå¤šè½¯ä»¶ä»gitåˆ°ç¼–è¯‘åˆ°å®‰è£…åŸºæœ¬ä¸Šéƒ½æ˜¯ç›¸åŒçš„æ­¥éª¤ï¼Œå°†è¿™ä¸ªè¿‡ç¨‹æ‰“åŒ…æˆäº†ä¸€ä¸ªè„šæœ¬ï¼Œæˆ‘ä»¬åªéœ€è¦gitä¸‹æ¥è¿™ä¸ªè„šæœ¬ï¼Œå³å¯å®Œæˆè½¯ä»¶çš„è‡ªåŠ¨åŒ–å®‰è£…</p><p>æœ‰æ—¶å€™AUR helperæ²¡æœ‰ç”¨å°±æ‰‹åŠ¨è¯•è¯•å§ï¼</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> &lt;aur repo&gt; <span class="comment"># åœ¨æ‹‰å–ä»“åº“</span></span><br><span class="line"><span class="built_in">cd</span> &lt;repo&gt;</span><br><span class="line">makepkg <span class="comment">#æ‰§è¡ŒPKGBUILDè„šæœ¬ä¸­çš„å†…å®¹ï¼Œç”Ÿæˆä¸€ä¸ªæ–‡ä»¶å&quot;.xz&quot;ç»“å°¾çš„äºŒè¿›åˆ¶å®‰è£…æ–‡ä»¶</span></span><br><span class="line">sudo pacman -U &lt;pkg&gt;</span><br></pre></td></tr></table></figure><h3 id="yay">yay</h3><p>yayæ˜¯æ˜¯ä¸€ä¸ªç”¨ Go è¯­è¨€å¼€å‘çš„ AUR Helperï¼Œå…·æœ‰é«˜çº§ä¾èµ–è§£å†³ã€PKGBUILD ä¸‹è½½ã€AUR åŒ…åè‡ªåŠ¨è¡¥å…¨ã€ç§»é™¤ç”Ÿæˆä¾èµ–ç­‰åŠŸèƒ½ï¼Œä¸éœ€è¦ç”¨æˆ·æ‰‹åŠ¨è¿›è¡Œ<code>git clone</code>,<code>makepkg</code>,<code>pacman -U</code>ç­‰ä¸€ç³»åˆ—æ“ä½œï¼Œè§£æ”¾åŒæ‰‹ï¼Œç±»ä¼¼äºpacman</p><ol><li><p>å®‰è£…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yay -S &lt;package-name&gt;</span><br></pre></td></tr></table></figure></li><li><p>æ›´æ–°/å‡çº§</p><p>æ›´æ–°AUR è½¯ä»¶åŒ…æ•°æ®åº“</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yay -Syy</span><br></pre></td></tr></table></figure><p>æ›´æ–° AUR è½¯ä»¶åŒ…æ•°æ®åº“å¹¶å‡çº§æ‰€æœ‰å·²å®‰è£…çš„è½¯ä»¶åŒ…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yay -Syyu</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ -S è¡¨ç¤º syncï¼ˆåŒæ­¥ï¼‰ï¼Œ-y è¡¨ç¤ºä»æœåŠ¡å™¨ä¸‹è½½æ–°çš„è½¯ä»¶åŒ…æ•°æ®åº“ï¼Œ-yy è¡¨ç¤ºå¼ºåˆ¶æ›´æ–°è½¯ä»¶åŒ…æ•°æ®åº“,-u è¡¨ç¤º upgradeï¼ˆå‡çº§</p></li><li><p>å¸è½½</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yay --Rscnu &lt;package-name&gt;</span><br></pre></td></tr></table></figure><p>-R è¡¨ç¤º Removeï¼ˆç§»é™¤ï¼‰ï¼Œ-s åˆ é™¤ä¸éœ€è¦çš„ä¾èµ–å…³ç³»ï¼Œ-cï¼ˆcascadeï¼‰åˆ é™¤è½¯ä»¶åŒ…åŠæ‰€æœ‰ä¾èµ–äºæ­¤çš„è½¯ä»¶åŒ…ï¼Œ-n è¡¨ç¤º nosaveï¼ˆåˆ é™¤é…ç½®æ–‡ä»¶ï¼‰ï¼Œ-u è¡¨ç¤º unneeded</p></li><li><p>æœç´¢</p><p>åœ¨çº¿æœç´¢</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yay -Ss &lt;key-word&gt;</span><br></pre></td></tr></table></figure><p>æœ¬åœ°æœç´¢</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yay -Qs &lt;key-word&gt; <span class="comment">#æ¨¡ç³ŠåŒ¹é…</span></span><br><span class="line">yay -Q &lt;package-name&gt; <span class="comment">#ç²¾ç¡®åŒ¹é… </span></span><br></pre></td></tr></table></figure></li><li><p>å®‰è£…æœ¬åœ°è½¯ä»¶åŒ…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yay -U &lt;package-path&gt;</span><br></pre></td></tr></table></figure></li><li><p>æ¸…ç†æ— ç”¨è½¯ä»¶åŒ…å’Œç¼“å­˜</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yay -Scc</span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Archlinux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxç»Ÿè®¡æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹æ•°é‡</title>
      <link href="/2022/08/16/Linux%E7%BB%9F%E8%AE%A1%E6%96%87%E4%BB%B6%E6%88%96%E6%96%87%E4%BB%B6%E5%A4%B9%E6%95%B0%E9%87%8F/"/>
      <url>/2022/08/16/Linux%E7%BB%9F%E8%AE%A1%E6%96%87%E4%BB%B6%E6%88%96%E6%96%87%E4%BB%B6%E5%A4%B9%E6%95%B0%E9%87%8F/</url>
      
        <content type="html"><![CDATA[<p>ä»¥ä¸‹å†…å®¹æ‘˜è‡ª<a href="http://noahsnail.com/2017/02/07/2017-02-07-Linux%E7%BB%9F%E8%AE%A1%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%8B%E7%9A%84%E6%96%87%E4%BB%B6%E6%95%B0%E7%9B%AE/">Tyan</a>,æ–¹ä¾¿åç»­è‡ªå·±æŸ¥è¯¢ä½¿ç”¨ï¼Œæ„Ÿè°¢ä½œè€…</p><h3 id="ç»Ÿè®¡å‘½ä»¤">ç»Ÿè®¡å‘½ä»¤</h3><p>Linuxä¸‹æœ‰ä¸‰ä¸ªå‘½ä»¤:<code>ls</code>,<code>grep</code>,<code>wc</code>ã€‚é€šè¿‡è¿™ä¸‰ä¸ªå‘½ä»¤çš„ç»„åˆå¯å®ç°ç»Ÿè®¡ç›®å½•ä¸‹æ–‡ä»¶åŠæ–‡ä»¶å¤¹çš„ä¸ªæ•°ã€‚</p><ol><li><p>ç»Ÿè®¡å½“å‰ç›®å½•ä¸‹æ–‡ä»¶ä¸ªæ•°</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls -l | grep &quot;^-&quot; | wc -l</span><br></pre></td></tr></table></figure></li><li><p>ç»Ÿè®¡å½“å‰ç›®å½•ä¸‹æ–‡ä»¶çš„ä¸ªæ•°ï¼ˆåŒ…æ‹¬å­ç›®å½•ï¼‰</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls -lR| grep &quot;^-&quot; | wc -l</span><br></pre></td></tr></table></figure></li><li><p>æŸ¥çœ‹æŸç›®å½•ä¸‹æ–‡ä»¶å¤¹(ç›®å½•)çš„ä¸ªæ•°ï¼ˆåŒ…æ‹¬å­ç›®å½•ï¼‰</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls -lR | grep &quot;^d&quot; | wc -l</span><br></pre></td></tr></table></figure></li></ol><h3 id="å‘½ä»¤è¯¦è§£">å‘½ä»¤è¯¦è§£</h3><ul><li><p><code>ls -l</code></p><p>é•¿åˆ—è¡¨è¾“å‡ºè¯¥ç›®å½•ä¸‹æ–‡ä»¶ä¿¡æ¯(æ³¨æ„è¿™é‡Œçš„æ–‡ä»¶æ˜¯æŒ‡ç›®å½•ã€é“¾æ¥ã€è®¾å¤‡æ–‡ä»¶ç­‰)ï¼Œæ¯ä¸€è¡Œå¯¹åº”ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•ï¼Œ<code>ls -lR</code>æ˜¯åˆ—å‡ºæ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…æ‹¬å­ç›®å½•ã€‚</p></li><li><p><code>grep &quot;^-&quot;</code></p><p>è¿‡æ»¤<code>ls</code>çš„è¾“å‡ºä¿¡æ¯ã€‚æ­£åˆ™è¡¨è¾¾å¼&quot;^-&quot;è¡¨ç¤ºä»¥<code>-</code>å¼€å¤´ï¼Œå› ä¸ºç»Ÿè®¡æ–‡ä»¶å¤¹æ”¹ä¸º<code>^d</code></p></li><li><p><code>wc -l</code></p><p>ç»Ÿè®¡è¾“å‡ºä¿¡æ¯çš„è¡Œæ•°ï¼Œç»Ÿè®¡ç»“æœå°±æ˜¯è¾“å‡ºä¿¡æ¯çš„è¡Œæ•°ï¼Œä¸€è¡Œä¿¡æ¯å¯¹åº”ä¸€ä¸ªæ–‡ä»¶</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>C++ priority_queueä½¿ç”¨æ–¹æ³•</title>
      <link href="/2022/02/26/priority-queue%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/"/>
      <url>/2022/02/26/priority-queue%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¼˜å…ˆé˜Ÿåˆ—priority-queue">ä¼˜å…ˆé˜Ÿåˆ—priority_queue</h2><p>priority_queueæ˜¯C++æä¾›çš„ä¼˜å…ˆé˜Ÿåˆ—ï¼Œå®šä¹‰åœ¨å¤´æ–‡ä»¶<code>&lt;queue&gt;</code>ä¸­ï¼Œé»˜è®¤ä¸ºæœ€å¤§ä¼˜å…ˆé˜Ÿåˆ—<br>å®šä¹‰å¦‚ä¸‹</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">T</span>,</span></span><br><span class="line"><span class="class">    <span class="keyword">class</span> <span class="title">Container</span> =</span> std::vector&lt;T&gt;,</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Compare</span> =</span> std::less&lt;<span class="keyword">typename</span> Container::value_type&gt;</span><br><span class="line">&gt; <span class="class"><span class="keyword">class</span> <span class="title">priority_queue</span>;</span></span><br></pre></td></tr></table></figure><h3 id="æ¨¡æ¿å½¢å‚">æ¨¡æ¿å½¢å‚</h3><ul><li><p>T å­˜å‚¨å…ƒç´ ç±»å‹</p></li><li><p>Container ç”¨äºå­˜å‚¨å…ƒç´ çš„åº•å±‚å®¹å™¨ å¦‚<code>std::vector&lt;T&gt;</code>,<code>std::vector&lt;std::vector&lt;T&gt; &gt;</code>,ä¹Ÿå°±æ˜¯å®¹å™¨çš„ç±»å‹ï¼Œ</p></li><li><p>Compare ä¸¥æ ¼å¼±åºçš„<a href="https://zh.cppreference.com/w/cpp/named_req/Compare"><em>æ¯”è¾ƒ</em> <em>(Compare)</em> </a>ç±»å‹</p><p>å¯¹äºè‡ªå®šä¹‰çš„compareå‡½æ•°ï¼Œéœ€æä¾›ä¸¥æ ¼å¼±åºã€‚å¯¹äºæ¯”è¾ƒå‡½æ•°ï¼Œè‹¥è¿”å›true,è¯´æ˜left â€œå°äºâ€ right<br>æ¯”è¾ƒæ—¶ï¼Œè‹¥è¦å·¦æ“ä½œæ•°å…ˆäºå³æ“ä½œæ•°å¼¹å‡ºï¼Œåˆ™åº”è¯¥è¿”å›falseã€‚(å› ä¸ºpriority_queueæ€»æ˜¯è¿”å›**â€œæœ€å¤§â€**çš„)ï¼Œè‹¥è¦å³æ“ä½œæ•°å…ˆå¼¹å‡ºï¼Œåˆ™åº”è¯¥è¿”å›true</p></li></ul><h3 id="å¸¸ç”¨æˆå‘˜å‡½æ•°">å¸¸ç”¨æˆå‘˜å‡½æ•°</h3><table><thead><tr><th>æˆå‘˜å‡½æ•°</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>top</td><td>è®¿é—®æ ˆé¡¶å…ƒç´ </td></tr><tr><td>empty</td><td>æ£€æŸ¥é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º</td></tr><tr><td>size</td><td>è¿”å›å®¹çº³çš„å…ƒç´ æ•°</td></tr><tr><td>push</td><td>æ’å…¥å…ƒç´ ï¼Œå¹¶å¯¹åº•å±‚å®¹å™¨æ’åº(è‡ªåŠ¨å®Œæˆ)</td></tr><tr><td>pop</td><td>å¼¹å‡ºé˜Ÿåˆ—ç¬¬ä¸€ä¸ªå…ƒç´ </td></tr><tr><td>emplace</td><td>åŸä½æ„é€ å…ƒç´ å¹¶æ’åºåº•å±‚å®¹å™¨</td></tr><tr><td>swap</td><td>äº¤æ¢å†…å®¹</td></tr></tbody></table><h3 id="ä½¿ç”¨">ä½¿ç”¨</h3><p>å¦‚ä¸ç‰¹æ®Š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="keyword">void</span> <span class="title">print_queue</span><span class="params">(T&amp; q)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        std::cout &lt;&lt; q.<span class="built_in">top</span>() &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ç®€å•ä½¿ç”¨(å¤§é¡¶å †)</span></span><br><span class="line"><span class="comment">//è¿™é‡Œé»˜è®¤ä½¿ç”¨äº†std::less&lt;T&gt;ï¼Œè¿™æ˜¯ä¸€ä¸ªä»¿å‡½æ•°ç±»ï¼Œé‡è½½äº†()æ“ä½œç¬¦</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">constexpr bool operator()(const T &amp;lhs, const T &amp;rhs) const </span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">    return lhs &lt; rhs; </span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">std::priority_queue&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> n : &#123;<span class="number">1</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">2</span>&#125;)&#123;</span><br><span class="line">q.<span class="built_in">push</span>(n);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print_queue</span>(q);</span><br><span class="line"><span class="comment">//è¾“å‡º 9 8 7 6 5 4 3 2 1 0 </span></span><br><span class="line"></span><br><span class="line"><span class="comment">//å°é¡¶å †</span></span><br><span class="line">std::priority_queue&lt;<span class="keyword">int</span>, std::vector&lt;<span class="keyword">int</span>&gt;, std::greater&lt;<span class="keyword">int</span>&gt; &gt; q2;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> n : &#123;<span class="number">1</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">2</span>&#125;)</span><br><span class="line">        q2.<span class="built_in">push</span>(n);</span><br><span class="line"><span class="built_in">print_queue</span>(q2);</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¾“å‡º 0 1 2 3 4 5 6 7 8 9</span></span><br></pre></td></tr></table></figure><p>è‡ªå®šä¹‰æ¯”è¾ƒå‡½æ•°</p><p>è¿™é‡Œä½¿ç”¨<code>std::vector&lt;std::vector&lt;int&gt;&gt;</code>ä½œä¸ºåº•å±‚å®¹å™¨ï¼ŒæŒ‰äºŒå…ƒç»„std::vector<int>ç¬¬ä¸€ä¸ªåæ ‡ä»å°åˆ°å¤§æ’åºï¼Œè‹¥ç›¸åŒåˆ™ç¬¬äºŒä¸ªåæ ‡ä»å°åˆ°å¤§æ’åº</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="keyword">void</span> <span class="title">print_queue</span><span class="params">(T&amp; q)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        <span class="keyword">auto</span> temp = q.<span class="built_in">top</span>();</span><br><span class="line">        std::cout &lt;&lt; temp[<span class="number">0</span>] &lt;&lt; <span class="string">&quot; &quot;</span>&lt;&lt;temp[<span class="number">1</span>]&lt;&lt;std::endl;</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å®šä¹‰æ¯”è¾ƒå‡½æ•°</span></span><br><span class="line"><span class="comment">//å¯¹äºæ¯”è¾ƒå‡½æ•°ï¼Œè‹¥è¿”å›true,è¯´æ˜leftæ˜¯â€œå°äºâ€ rightçš„ï¼Œ</span></span><br><span class="line"><span class="comment">//priority_queueæ€»æ˜¯è¿”å›â€œæœ€å¤§â€çš„ï¼Œrightå°±ä¼šä¼˜å…ˆè¢«å¼¹å‡º</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> cmp = [](std::vector&lt;<span class="keyword">int</span>&gt; left, std::vector&lt;<span class="keyword">int</span>&gt; right) &#123; </span><br><span class="line">        <span class="keyword">if</span>(left[<span class="number">0</span>] == right[<span class="number">0</span>])</span><br><span class="line">            <span class="keyword">return</span> left[<span class="number">0</span>] &gt; right[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">return</span> left[<span class="number">0</span>] &gt; right[<span class="number">0</span>];</span><br><span class="line">    &#125;;</span><br><span class="line">    std::priority_queue&lt;std::vector&lt;<span class="keyword">int</span>&gt;, std::vector&lt;std::vector&lt;<span class="keyword">int</span>&gt;&gt;, <span class="keyword">decltype</span>(cmp)&gt; <span class="built_in">q3</span>(cmp);</span><br><span class="line">    std::vector&lt;std::vector&lt;<span class="keyword">int</span>&gt;&gt; arr&#123;&#123;<span class="number">3</span>,<span class="number">4</span>&#125;,&#123;<span class="number">1</span>,<span class="number">3</span>&#125;,&#123;<span class="number">5</span>,<span class="number">7</span>&#125;,&#123;<span class="number">1</span>,<span class="number">5</span>&#125;,&#123;<span class="number">9</span>,<span class="number">4</span>&#125;,&#123;<span class="number">4</span>,<span class="number">2</span>&#125;,&#123;<span class="number">3</span>,<span class="number">5</span>&#125;&#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span>&amp; n :arr)&#123;</span><br><span class="line">        q3.<span class="built_in">push</span>(n);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">print_queue</span>(q3);;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//è¾“å‡º</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">1 3</span></span><br><span class="line"><span class="comment">1 5</span></span><br><span class="line"><span class="comment">3 5</span></span><br><span class="line"><span class="comment">3 4</span></span><br><span class="line"><span class="comment">4 2</span></span><br><span class="line"><span class="comment">5 7</span></span><br><span class="line"><span class="comment">9 4</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> C++ </tag>
            
            <tag> priority_queue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C++11éšæœºæ•°</title>
      <link href="/2022/02/25/%E9%9A%8F%E6%9C%BA%E6%95%B0/"/>
      <url>/2022/02/25/%E9%9A%8F%E6%9C%BA%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="c-11-ä¼ªéšæœºæ•°ç”Ÿæˆ">c++11 ä¼ªéšæœºæ•°ç”Ÿæˆ</h2><p>c++11 éšæœºæ•°åº“<code>&lt;random&gt;</code>æä¾›ç”Ÿæˆéšæœºæ•°å’Œä¼ªéšæœºæ•°çš„ç±»ï¼Œ<br>ä¸ºç”Ÿæˆä¼ªéšæœºæ•°ï¼Œä¸»è¦åŒ…æ‹¬ä¸¤ç±»</p><ol><li>å‡åŒ€éšæœºä½ç”Ÿæˆå™¨(URBG)ï¼ŒåŒ…å«éšæœºæ•°å¼•æ“ï¼Œå®ƒä»¬æ˜¯ä¼ªéšæœºæ•°ç”Ÿæˆå™¨ï¼Œæ˜¯èƒ½å¤Ÿç”Ÿæˆå‡åŒ€åˆ†å¸ƒæ•´æ•°åºåˆ—çš„ä¼ªéšæœºæ•°</li><li>éšæœºæ•°åˆ†å¸ƒ(ä¾‹å¦‚å‡åŒ€åˆ†å¸ƒï¼Œæ­£æ€åˆ†å¸ƒå’Œæ³Šæ¾åˆ†å¸ƒç­‰)ï¼Œå®ƒä»¬å°† URBG çš„è¾“å‡ºè½¬æ¢ä¸ºå„ç§ç»Ÿè®¡åˆ†å¸ƒ<br>å‡åŒ€éšæœºä½ç”Ÿæˆå™¨å’Œéšæœºæ•°åˆ†å¸ƒç›¸äº’ä½¿ç”¨ã€‚æ‰€æœ‰éšæœºæ•°å¼•æ“éƒ½å¯ä»¥æŒ‡å®šåœ°æ’­ç§ã€åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œä»¥ç”¨äºå¯é‡å¤çš„æ¨¡æ‹Ÿå™¨</li></ol><h3 id="å‡åŒ€éšæœºä½ç”Ÿæˆå™¨">å‡åŒ€éšæœºä½ç”Ÿæˆå™¨</h3><p>å‡åŒ€éšæœºä½ç”Ÿæˆå™¨æ˜¯<strong>å‡½æ•°å¯¹è±¡(ä»¿å‡½æ•°ç±»)</strong>ï¼Œå®ƒè¿”å›æ— ç¬¦å·æ•´æ•°å€¼ï¼Œå¹¶ä½¿å¾—æ¯ä¸ªå€¼åœ¨å¯èƒ½ç»“æœçš„èŒƒå›´ä¸­æ‹¥æœ‰ï¼ˆç†æƒ³ä¸Šï¼‰ç›¸ç­‰çš„è¢«è¿”å›æ¦‚ç‡<br>ä¸»è¦æœ‰ä»¥ä¸‹4ç§,</p><ol><li>éšæœºæ•°å¼•æ“<br>éšæœºæ•°å¼•æ“æœ¬è´¨æ˜¯ä¸€ç§ç®—æ•°ç®—æ³•ï¼Œå› æ­¤ç›¸åŒçš„ç§å­å¤šæ¬¡è°ƒç”¨äº§ç”Ÿçš„éšæœºæ•°æ˜¯å®Œå…¨ç›¸åŒçš„<br>æ ‡å‡†æä¾›ä¸‰ç§å¸¸ç”¨çš„å¼•æ“ï¼šlinear_congruential_engineï¼Œmersenne_twister_engine å’Œ subtract_with_carry_engineã€‚ç¬¬ä¸€ç§æ˜¯çº¿æ€§åŒä½™ç®—æ³•ï¼Œç¬¬äºŒç§æ˜¯æ¢…æ£®æ—‹è½¬ç®—æ³•ï¼Œç¬¬ä¸‰ç§å¸¦è¿›ä½çš„çº¿æ€§åŒä½™ç®—æ³•ã€‚</li><li>éšæœºæ•°å¼•æ“é€‚é…å™¨<br>éšæœºæ•°å¼•æ“é€‚é…å™¨ç”Ÿæˆä»¥å¦ä¸€éšæœºæ•°å¼•æ“ä¸ºç†µæºçš„ä¼ªéšæœºæ•°</li><li>é¢„å®šä¹‰éšæœºæ•°ç”Ÿæˆå™¨<br>å…·ä½“è§<a href="!https://zh.cppreference.com/w/cpp/numeric/random">ä¼ªéšæœºæ•°ç”Ÿæˆ</a><br>å¸¸ç”¨çš„æœ‰default_random_engineï¼Œmt19937ï¼Œminstd_rand0ç­‰</li><li>éç¡®å®šéšæœºæ•°ç”Ÿæˆå™¨<br>ä½¿ç”¨ç¡¬ä»¶ç†µæºçš„éç¡®å®šéšæœºæ•°ç”Ÿæˆå™¨<br>std::random_device</li></ol><p>ä½¿ç”¨æ–¹æ³•<br>æ­£å¸¸ä½¿ç”¨æˆ‘ä»¬åªéœ€è¦ä½¿ç”¨é¢„å®šä¹‰éšæœºæ•°ç”Ÿæˆå™¨æˆ–è€…éç¡®å®šéšæœºæ•°å³å¯<br>éšæœºæ•°å¼•æ“æ¥å—ä¸€ä¸ªæ•´å½¢å‚æ•°å½“ä½œç§å­ï¼Œä¸æä¾›çš„è¯ï¼Œä¼šä½¿ç”¨é»˜è®¤å€¼ã€‚å¦‚æœæƒ³å¤šæ¬¡è¿è¡Œäº§ç”Ÿç›¸åŒçš„éšæœºæ•°ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªç¡®å®šçš„æ•°ä½œä¸ºç§å­ã€‚å¦‚æœæ˜¯æƒ³æ¯æ¬¡è¿è¡Œç”Ÿæˆä¸ä¸€æ ·çš„éšæœºæ•°ï¼ŒLinux æ¨èä½¿ç”¨ random_device æ¥äº§ç”Ÿä¸€ä¸ªéšæœºæ•°å½“ä½œç§å­ï¼Œwindows äº§ç”Ÿä¸€ä¸ªä¼ªéšæœºæ•°ä½œä¸ºç§å­ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;random&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//é€‰æ‹©æŸä¸€ç§éšæœºæ•°ç”Ÿæˆå™¨æˆ–è€…</span></span><br><span class="line">    std::random_device rd;  <span class="comment">//ä½¿ç”¨ç¡¬ä»¶ç†µæº</span></span><br><span class="line">    <span class="comment">//å°†rdç”Ÿæˆçš„éç¡®å®šéšæœºæ•°ä½œä¸ºéšæœºæ•°å¼•æ“çš„ç§å­ï¼Œå½“ç„¶è‡ªå®šä¹‰ä¹Ÿè¡Œï¼Œç›¸åŒçš„ç§å­å¤šæ¬¡è°ƒç”¨äº§ç”Ÿçš„éšæœºæ•°æ˜¯å®Œå…¨ç›¸åŒ</span></span><br><span class="line">    <span class="function">std::default_random_engine <span class="title">e</span><span class="params">(rd())</span></span>;</span><br><span class="line">    <span class="comment">//ç”Ÿæˆ10ä¸ªéšæœºæ•°</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)&#123;</span><br><span class="line">        std::cout&lt;&lt;<span class="built_in">e</span>()&lt;&lt;std::endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="éšæœºæ•°åˆ†å¸ƒ">éšæœºæ•°åˆ†å¸ƒ</h3><p>éšæœºæ•°åˆ†å¸ƒåå¤„ç† URBG çš„è¾“å‡ºï¼Œä»¥ä½¿å¾—è¾“å‡ºç»“æœæŒ‰ç…§å®šä¹‰çš„ç»Ÿè®¡æ¦‚ç‡å¯†åº¦å‡½æ•°åˆ†å¸ƒ<br>å…·ä½“é—´<a href="https://zh.cppreference.com/w/cpp/numeric/random">éšæœºæ•°åˆ†å¸ƒ</a>ä¸­æä¾›çš„ç±»ï¼Œå¸¸è§çš„æœ‰å‡åŒ€ï¼Œæ­£æ€ç­‰</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// ä»¥éšæœºå€¼æ’­ç§ï¼Œè‹¥å¯èƒ½</span></span><br><span class="line">    std::random_device r;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// é€‰æ‹© 1 ä¸ 6 é—´çš„éšæœºæ•°</span></span><br><span class="line">    <span class="function">std::default_random_engine <span class="title">e1</span><span class="params">(r())</span></span>;</span><br><span class="line">    <span class="function">std::uniform_int_distribution&lt;<span class="keyword">int</span>&gt; <span class="title">uniform_dist</span><span class="params">(<span class="number">1</span>, <span class="number">6</span>)</span></span>;</span><br><span class="line">    <span class="keyword">int</span> mean = <span class="built_in">uniform_dist</span>(e1);</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Randomly-chosen mean: &quot;</span> &lt;&lt; mean &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    <span class="comment">// å€¼æœ€å¯èƒ½æ¥è¿‘å¹³å‡</span></span><br><span class="line">    <span class="comment">// æ ‡å‡†å·®å½±å“ç”Ÿæˆçš„å€¼è·ç¦»å¹³å‡æ•°çš„åˆ†æ•£</span></span><br><span class="line">    std::random_device rd;</span><br><span class="line">    <span class="function">std::mt19937 <span class="title">gen</span><span class="params">(rd())</span></span>;</span><br><span class="line">    std::normal_distribution&lt;&gt; d&#123;<span class="number">5</span>,<span class="number">2</span>&#125;;</span><br><span class="line">    std::map&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; hist&#123;&#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> n=<span class="number">0</span>; n&lt;<span class="number">10000</span>; ++n) &#123;</span><br><span class="line">        ++hist[std::<span class="built_in">round</span>(<span class="built_in">d</span>(gen))];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> p : hist) &#123;</span><br><span class="line">        std::cout &lt;&lt; std::<span class="built_in">setw</span>(<span class="number">2</span>)</span><br><span class="line">                  &lt;&lt; p.first &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; std::<span class="built_in">string</span>(p.second/<span class="number">200</span>, <span class="string">&#x27;*&#x27;</span>) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>c++åˆ†å‰²å­—ç¬¦ä¸²</title>
      <link href="/2021/12/27/c-%E5%88%86%E5%89%B2%E5%AD%97%E7%AC%A6%E4%B8%B2/"/>
      <url>/2021/12/27/c-%E5%88%86%E5%89%B2%E5%AD%97%E7%AC%A6%E4%B8%B2/</url>
      
        <content type="html"><![CDATA[<h3 id="ä½¿ç”¨stringstream-getline">ä½¿ç”¨stringstream + getline</h3><p>ä½¿ç”¨<a href="https://www.cplusplus.com/reference/string/string/getline/">getline</a>è¿›è¡Œåˆ†å‰²<br>å±€é™æ€§ï¼Œåªèƒ½ä»¥å•ä¸ªå­—ç¬¦ä½œä¸ºåˆ†å‰²çº¿</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="function">istringstream <span class="title">ss</span><span class="params">(<span class="string">&quot;helloahelloahello&quot;</span>)</span></span>;</span><br><span class="line">    string word;</span><br><span class="line">    <span class="keyword">char</span> delim = <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">getline</span>(ss,word,delim))&#123;</span><br><span class="line">        cout&lt;&lt;word&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* Output</span></span><br><span class="line"><span class="comment">hello</span></span><br><span class="line"><span class="comment">hello</span></span><br><span class="line"><span class="comment">hello</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨std-string-find">ä½¿ç”¨std::string::find</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="comment">// for string delimiter</span></span><br><span class="line"><span class="function">vector&lt;string&gt; <span class="title">split</span> <span class="params">(<span class="keyword">const</span> string&amp; s, <span class="keyword">const</span> string&amp; delimiter)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">size_t</span> pos_start = <span class="number">0</span>, pos_end, delim_len = delimiter.<span class="built_in">length</span>();</span><br><span class="line">    string token;</span><br><span class="line">    vector&lt;string&gt; res;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> ((pos_end = s.<span class="built_in">find</span> (delimiter, pos_start)) != string::npos) &#123;</span><br><span class="line">        token = s.<span class="built_in">substr</span> (pos_start, pos_end - pos_start);</span><br><span class="line">        pos_start = pos_end + delim_len;</span><br><span class="line">        <span class="keyword">if</span>(!token.<span class="built_in">empty</span>())</span><br><span class="line">        res.<span class="built_in">push_back</span> (token);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(pos_start != s.<span class="built_in">size</span>())</span><br><span class="line">        res.<span class="built_in">push_back</span> (s.<span class="built_in">substr</span> (pos_start));</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    string str = <span class="string">&quot;adsf-+qwret-+nvfkbdsj-+orthdfjgh-+dfjrleih&quot;</span>;</span><br><span class="line">    string delimiter = <span class="string">&quot;-+&quot;</span>;</span><br><span class="line">    vector&lt;string&gt; v = <span class="built_in">split</span> (str, delimiter);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> i : v) cout &lt;&lt; i &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* Output</span></span><br><span class="line"><span class="comment">adsf</span></span><br><span class="line"><span class="comment">qwret</span></span><br><span class="line"><span class="comment">nvfkbdsj</span></span><br><span class="line"><span class="comment">orthdfjgh</span></span><br><span class="line"><span class="comment">dfjrleih</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>èƒŒåŒ…é—®é¢˜</title>
      <link href="/2021/12/23/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/"/>
      <url>/2021/12/23/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<blockquote><p><a href="https://github.com/tianyicui/pack">èƒŒåŒ…ä¹è®²</a></p></blockquote><h2 id="0-1èƒŒåŒ…">0-1èƒŒåŒ…</h2><h3 id="é¢˜ç›®">é¢˜ç›®</h3><p>æœ‰<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>ä»¶ç‰©å“å’Œæœ€å¤šæ‰¿è½½é‡<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span>çš„èƒŒåŒ…ã€‚ç¬¬<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>ä»¶ç‰©å“çš„é‡é‡æ˜¯<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">w_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œå…¶ä»·å€¼æ˜¯<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">v_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ã€‚<strong>æ¯ä»¶ç‰©å“åªèƒ½ç”¨ä¸€æ¬¡</strong>ï¼Œæ±‚è§£å°†å“ªäº›ç‰©å“è£…å…¥èƒŒåŒ…é‡Œç‰©å“ä»·å€¼æ€»å’Œæœ€å¤§ã€‚</p><h3 id="åŸºæœ¬æ€è·¯">åŸºæœ¬æ€è·¯</h3><p>ä½œä¸ºæœ€åŸºç¡€çš„èƒŒåŒ…é—®é¢˜ï¼Œå…¶ç‰¹ç‚¹æ˜¯<strong>æ¯ä»¶ç‰©å“æœ€å¤šç”¨ä¸€æ¬¡</strong><br>ç”¨å­é—®é¢˜å®šä¹‰çŠ¶æ€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>w</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">F[i,w]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">]</span></span></span></span>è¡¨ç¤ºå‰<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>ä»¶ç‰©å“æ”¾å…¥æ‰¿è½½é‡<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span>çš„èƒŒåŒ…å¯è·å¾—çš„æœ€å¤§ä»·å€¼ï¼Œåˆ™çŠ¶æ€è½¬ç§»æ–¹ç¨‹ä¾¿æ˜¯</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>F</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>w</mi><mo stretchy="false">]</mo><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><mi>F</mi><mo stretchy="false">[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo separator="true">,</mo><mi>w</mi><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>F</mi><mo stretchy="false">[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo separator="true">,</mo><mi>w</mi><mo>âˆ’</mo><msub><mi>w</mi><mi>i</mi></msub><mo stretchy="false">]</mo><mo>+</mo><msub><mi>v</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F[i,w] = max(F[i-1,w],F[i-1,w-w_i]+v_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ma</span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>å…¶ä»£è¡¨çš„æ„æ€æ˜¯è‹¥åªè€ƒè™‘ç¬¬<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>ä»¶ç‰©å“çš„ç­–ç•¥ï¼ˆæ”¾æˆ–ä¸æ”¾ï¼‰ï¼Œé‚£ä¹ˆå°±å¯ä»¥è½¬åŒ–ä¸ºä¸€ä¸ªåªå’Œå‰<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7429em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ä»¶ç‰©å“ç›¸å…³çš„é—®é¢˜ã€‚</p><ul><li>å¦‚æœä¸æ”¾ç¬¬<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>ä»¶ç‰©å“ï¼Œé—®é¢˜å°±è½¬åŒ–ä¸ºâ€œå‰<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7429em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ä»¶ç‰©å“æ”¾å…¥å®¹é‡ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span>çš„èƒŒåŒ…ä¸­â€ï¼Œä»·å€¼ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo separator="true">,</mo><mi>w</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">F[i-1,w]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">]</span></span></span></span>ï¼›</li><li>å¦‚æœæ”¾ç¬¬<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>ä»¶ç‰©å“ï¼Œé—®é¢˜å°±è½¬åŒ–ä¸ºâ€œå‰<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7429em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ä»¶ç‰©å“æ”¾å…¥å‰©ä¸‹çš„å®¹é‡ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>âˆ’</mo><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">w-w_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>çš„èƒŒåŒ…ä¸­â€ï¼Œæ­¤æ—¶èƒ½è·å¾—çš„æœ€å¤§ä»·å€¼å°±æ˜¯<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo separator="true">,</mo><mi>w</mi><mo>âˆ’</mo><msub><mi>w</mi><mi>i</mi></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">F[i-1,w-w_i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>å†åŠ ä¸Šé€šè¿‡æ”¾å…¥ç¬¬iä»¶ç‰©å“è·å¾—çš„ä»·å€¼ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">w_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ã€‚</li></ul><h3 id="ä»£ç å®ç°">ä»£ç å®ç°</h3><p>å…ˆéå†ç‰©å“å†éå†å®¹é‡(æ¨ªå‘æ›´æ–°)<br><img src="/img/algorithm/01pack_2d.png" alt="äºŒç»´å®ç°"></p><p>å…ˆéå†å®¹é‡å†éå†ç‰©å“(çºµå‘æ›´æ–°)<br><img src="/img/algorithm/01pack_2d_packfirst.png" alt="äºŒç»´å®ç°"><br>è“è‰²æ–¹å—è¡¨ç¤ºæ›´æ–°å®Œæˆï¼Œç»¿è‰²è¡¨ç¤ºå½“å‰éœ€è¦æ›´æ–°çš„å€¼ï¼Œçº¢è‰²è¡¨ç¤ºè¿˜æœªæ›´æ–°ï¼Œå¸¦æ–‡å­—çš„æ–¹å—è¡¨ç¤ºæ›´æ–°å½“å‰å€¼æ‰€éœ€è¦çš„å€¼ã€‚<br>å¯ä»¥çœ‹å‡ºï¼Œå¯¹äºäºŒç»´å®ç°ï¼Œå…ˆéå†èƒŒåŒ…å®¹é‡æˆ–è€…å…ˆéå†ç‰©å“éƒ½å¯ä»¥ï¼Œå› ä¸ºæ›´æ–°å½“å‰ä½ç½®æ‰€éœ€ä¿¡æ¯æ—¶æ‰€éœ€è¦çš„å€¼(è“è‰²å¸¦æ–‡å­—æ–¹å—)éƒ½å·²ç»æ›´æ–°å®Œæˆ</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi>a</mi><mi>g</mi><mi>W</mi><mi>e</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">bagWeight</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">ba</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord mathnormal">e</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">h</span><span class="mord mathnormal">t</span></span></span></span>ä¸ºèƒŒåŒ…é‡é‡ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mi>e</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">weight</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal">e</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">h</span><span class="mord mathnormal">t</span></span></span></span>è¡¨ç¤ºé‡é‡æ•°ç»„ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">value</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span></span></span></span>è¡¨ç¤ºä»·å€¼æ•°ç»„ï¼Œ</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å…ˆéå†ç‰©å“å†éå†å®¹é‡(æ¨ªå‘æ›´æ–°)      </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">zeroOnePack</span><span class="params">(<span class="keyword">int</span> bagWeight,vector&lt;<span class="keyword">int</span>&gt; weight,vector&lt;<span class="keyword">int</span>&gt; value)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> m = weight.<span class="built_in">size</span>(), n = bagWeight;</span><br><span class="line">    <span class="comment">// dp[i][j] è¡¨ç¤ºå¯¹äºå‰iä»¶ç‰©å“ï¼Œå®¹é‡ä¸ºjçš„èƒŒåŒ…æ‰€èƒ½è·å¾—çš„æœ€å¤§ä»·å€¼</span></span><br><span class="line">    <span class="comment">//åˆå§‹åŒ– dp[*][0] = 0 dp[0][*] = 0</span></span><br><span class="line">    <span class="keyword">int</span> dp[m+<span class="number">1</span>][n+<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m+<span class="number">1</span>; i++)</span><br><span class="line">        dp[i][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n+<span class="number">1</span>; i++)</span><br><span class="line">        dp[<span class="number">0</span>][i] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; weight.<span class="built_in">size</span>(); i++) &#123; <span class="comment">// éå†ç‰©å“</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= bagWeight; j++) &#123; <span class="comment">// éå†èƒŒåŒ…å®¹é‡</span></span><br><span class="line">            <span class="keyword">if</span> (j &lt; weight[i]) </span><br><span class="line">                dp[i][j] = dp[i - <span class="number">1</span>][j]; </span><br><span class="line">            <span class="keyword">else</span> </span><br><span class="line">                dp[i][j] = <span class="built_in">max</span>(dp[i - <span class="number">1</span>][j], dp[i - <span class="number">1</span>][j - weight[i]] + value[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dp[m][n];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å…ˆéå†å®¹é‡å†éå†ç‰©å“(çºµå‘æ›´æ–°)</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= bagWeight; j++) &#123; <span class="comment">// éå†èƒŒåŒ…å®¹é‡</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; weight.<span class="built_in">size</span>(); i++) &#123; <span class="comment">// éå†ç‰©å“</span></span><br><span class="line">        <span class="keyword">if</span> (j &lt; weight[i]) </span><br><span class="line">            dp[i][j] = dp[i - <span class="number">1</span>][j];</span><br><span class="line">        <span class="keyword">else</span> </span><br><span class="line">            dp[i][j] = <span class="built_in">max</span>(dp[i - <span class="number">1</span>][j], dp[i - <span class="number">1</span>][j - weight[i]] + value[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ç©ºé—´ä¼˜åŒ–">ç©ºé—´ä¼˜åŒ–</h3><p>é‡‡ç”¨ä¸€ç»´æ•°ç»„å»æ›¿ä»£äºŒç»´æ•°ç»„ï¼Œè¿™è¦æ±‚åœ¨dpèƒ½å¤ŸåŒæ—¶ä¿å­˜ä¸Šä¸€å±‚ä¿¡æ¯å’Œæ›´æ–°æœ¬å±‚<br>å› ä¸ºæ›´æ–°å½“å‰ä½ç½®æ‰€éœ€ä¿¡æ¯åªåœ¨<strong>ä¸Šä¸€å±‚å·¦è¾¹å’Œæ­£ä¸Šæ–¹</strong>ï¼Œå¿…éœ€é‡‡ç”¨é€†åºã€‚<br><img src="/img/algorithm/01pack_1d.png" alt="ä¸€ç»´å®ç°"></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">zeroOnePack</span><span class="params">(<span class="keyword">int</span> bagWeight,vector&lt;<span class="keyword">int</span>&gt; weight,vector&lt;<span class="keyword">int</span>&gt; value)</span></span>&#123;</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">dp</span><span class="params">(bagWeight+<span class="number">1</span>,<span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; weight.<span class="built_in">size</span>(); i++) &#123; <span class="comment">// éå†ç‰©å“</span></span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = bagWeight; j &gt;= weight[i]; j--) &#123; <span class="comment">// éå†èƒŒåŒ…å®¹é‡</span></span><br><span class="line">            <span class="comment">//è¿™æ ·ä¿è¯ç‰©ä½“iåªåœ¨æœ¬æ¬¡å¾ªç¯è¢«ä½¿ç”¨ï¼Œå› ä¸ºç­‰å¼å³è¾¹çš„dpä¿å­˜çš„æ˜¯å‰i-1ä¸ªç‰©å“</span></span><br><span class="line">            dp[j] = <span class="built_in">max</span>(dp[j], dp[j - weight[i]] + value[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dp[bagWeight];   </span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å®Œå…¨èƒŒåŒ…">å®Œå…¨èƒŒåŒ…</h2><p>å®Œå…¨èƒŒåŒ…ä¸0-1èƒŒåŒ…çš„åŒºåˆ«åœ¨äºç‰©å“çš„ä¸ªæ•°æ˜¯æ— é™çš„ï¼Œå³å¯é‡å¤é€‰æ‹©ç›¸åŒç‰©å“å¡«å……</p><h3 id="åŸºæœ¬æ€è·¯-2">åŸºæœ¬æ€è·¯</h3><ol><li>åŸºæœ¬æ€è·¯<br>æ¨¡ä»¿0-1èƒŒåŒ…çš„è§£æ³•</li></ol><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>F</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>w</mi><mo stretchy="false">]</mo><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">{</mo><mi>F</mi><mo stretchy="false">[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo separator="true">,</mo><mi>w</mi><mo>âˆ’</mo><mi>k</mi><mo>âˆ—</mo><msub><mi>w</mi><mi>i</mi></msub><mo stretchy="false">]</mo><mo>+</mo><mi>k</mi><mo>âˆ—</mo><msub><mi>v</mi><mi>i</mi></msub><mi mathvariant="normal">âˆ£</mi><mn>0</mn><mo>&lt;</mo><mo>=</mo><mi>k</mi><mo>âˆ—</mo><msub><mi>w</mi><mi>i</mi></msub><mo>&lt;</mo><mo>=</mo><mi>W</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">F[i,w] = max\{F[i-1,w-k*w_i]+k*v_i | 0&lt;=k*w_i&lt;=W\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ma</span><span class="mord mathnormal">x</span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">âˆ£0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6891em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mclose">}</span></span></span></span></span></p><ol start="2"><li>è½¬æ¢ä¸º0-1èƒŒåŒ…<br>æ¯ä¸ªç‰©å“i,æœ€å¤šèƒ½æ”¾<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mi>W</mi><msub><mi>w</mi><mi>i</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">\frac{W}{w_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3174em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0269em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>ä»¶ï¼Œé‚£ä¹ˆå°±æŠŠç¬¬<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>ä»¶æ‰©å……è‡³<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mi>W</mi><msub><mi>w</mi><mi>i</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">\frac{W}{w_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3174em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0269em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>ä»¶ï¼Œç„¶åè§£å†³è¿™ä¸ª0-1èƒŒåŒ…é—®é¢˜<br>åˆ™çŠ¶æ€è½¬ç§»æ–¹ç¨‹ä¾¿æ˜¯<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>F</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>w</mi><mo stretchy="false">]</mo><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><mi>F</mi><mo stretchy="false">[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo separator="true">,</mo><mi>w</mi><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>F</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>w</mi><mo>âˆ’</mo><msub><mi>w</mi><mi>i</mi></msub><mo stretchy="false">]</mo><mo>+</mo><msub><mi>v</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F[i,w] = max(F[i-1,w],F[i,w-w_i]+v_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ma</span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p></li></ol><ul><li>å¦‚æœä¸æ”¾ç¬¬<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>ä»¶ç‰©å“ï¼Œé—®é¢˜å°±è½¬åŒ–ä¸ºâ€œå‰<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7429em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ä»¶ç‰©å“æ”¾å…¥å®¹é‡ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span>çš„èƒŒåŒ…ä¸­â€ï¼Œä»·å€¼ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo separator="true">,</mo><mi>w</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">F[i-1,w]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">]</span></span></span></span>ï¼›</li><li>åœ¨è€ƒè™‘â€œé€‰ä¸€ä»¶ç¬¬<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>ç§ç‰©å“â€æ—¶ï¼Œéœ€è¦ä¸€ä¸ªå¯èƒ½å·²é€‰å…¥ç¬¬<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>ç§ç‰©å“çš„å­ç»“æœ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>w</mi><mo>âˆ’</mo><msub><mi>w</mi><mi>i</mi></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">F[i,w-w_i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>ã€‚è€Œä¸æ˜¯åªé€‰åˆ°å‰<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7429em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>çš„å­ç»“æœ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo separator="true">,</mo><mi>w</mi><mo>âˆ’</mo><msub><mi>w</mi><mi>i</mi></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">F[i-1,w-w_i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></li></ul><h3 id="äºŒç»´å®ç°">äºŒç»´å®ç°</h3><p>å…ˆéå†ç‰©å“å†éå†å®¹é‡(æ¨ªå‘æ›´æ–°)<br><img src="/img/algorithm/completepack_2d.png" alt="äºŒç»´å®ç°"><br>å…ˆéå†å®¹é‡å†éå†ç‰©å“(çºµå‘æ›´æ–°)<br><img src="/img/algorithm/completepack_2d_packfirst.png" alt="äºŒç»´å®ç°"></p><p>å’Œ0-1èƒŒåŒ…ä¸€æ ·ï¼Œå¯¹äºäºŒç»´å®ç°ï¼Œå…ˆéå†ç‰©å“å’Œå…ˆéå†å®¹é‡éƒ½æ˜¯å¯è¡Œçš„ã€‚åŸå› å°±åœ¨äºä¸ç®¡é‡‡ç”¨é‚£ç§éå†é¡ºåˆ©æ€»æ˜¯ä¿è¯æ›´æ–°å½“å‰ä½ç½®æ—¶æ‰€éœ€è¦çš„ä¿¡æ¯å·²ç»å‡†å¤‡å¥½äº†</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi>a</mi><mi>g</mi><mi>W</mi><mi>e</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">bagWeight</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">ba</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord mathnormal">e</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">h</span><span class="mord mathnormal">t</span></span></span></span>ä¸ºèƒŒåŒ…é‡é‡ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mi>e</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">weight</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal">e</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">h</span><span class="mord mathnormal">t</span></span></span></span>è¡¨ç¤ºé‡é‡æ•°ç»„ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">value</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span></span></span></span>è¡¨ç¤ºä»·å€¼æ•°ç»„ï¼Œ</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">completePack</span><span class="params">(<span class="keyword">int</span> bagWeight,vector&lt;<span class="keyword">int</span>&gt; weight,vector&lt;<span class="keyword">int</span>&gt; value)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> m = weight.<span class="built_in">size</span>(), n = bagWeight;</span><br><span class="line">    <span class="comment">// dp[i][j] è¡¨ç¤ºå¯¹äºå‰iä»¶ç‰©å“ï¼Œå®¹é‡ä¸ºjçš„èƒŒåŒ…æ‰€èƒ½è·å¾—çš„æœ€å¤§ä»·å€¼</span></span><br><span class="line">    <span class="comment">//åˆå§‹åŒ– dp[*][0] = 0 dp[0][*] = 0</span></span><br><span class="line">    <span class="keyword">int</span> dp[m+<span class="number">1</span>][n+<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m+<span class="number">1</span>; i++)</span><br><span class="line">        dp[i][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n+<span class="number">1</span>; i++)</span><br><span class="line">        dp[<span class="number">0</span>][i] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; weight.<span class="built_in">size</span>(); i++) &#123; <span class="comment">// éå†ç‰©å“</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= bagWeight; j++) &#123; <span class="comment">// éå†èƒŒåŒ…å®¹é‡</span></span><br><span class="line">            <span class="keyword">if</span> (j &lt; weight[i]) </span><br><span class="line">                dp[i][j] = dp[i - <span class="number">1</span>][j]; </span><br><span class="line">            <span class="keyword">else</span> </span><br><span class="line">                dp[i][j] = <span class="built_in">max</span>(dp[i - <span class="number">1</span>][j], dp[i][j - weight[i]] + value[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dp[m][n];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç©ºé—´ä¼˜åŒ–-2">ç©ºé—´ä¼˜åŒ–</h3><p>é‡‡ç”¨ä¸€ç»´æ•°ç»„å»æ›¿ä»£äºŒç»´æ•°ç»„ï¼Œ<br>å› ä¸ºæ›´æ–°å½“å‰ä½ç½®æ‰€éœ€ä¿¡æ¯<strong>æœ¬å±‚å·¦è¾¹å’Œæ­£ä¸Šæ–¹</strong>ï¼Œå¯¹åº”åˆ°ä¸€ç»´å°±æ˜¯å½“å‰ä½ç½®å·¦è¾¹å’Œè‡ªèº«ä½ç½®ï¼Œéœ€é‡‡ç”¨æ­£å‘éå†ï¼ŒåŠæ—¶æ›´æ–°æœ¬å±‚å·¦è¾¹æ–¹å—<br><img src="/img/algorithm/completepack_1d.png" alt="ä¸€ç»´å®ç°"></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">completePack</span><span class="params">(<span class="keyword">int</span> bagWeight,vector&lt;<span class="keyword">int</span>&gt; weight,vector&lt;<span class="keyword">int</span>&gt; value)</span></span>&#123;</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">dp</span><span class="params">(bagWeight+<span class="number">1</span>,<span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; weight.<span class="built_in">size</span>(); i++) &#123; <span class="comment">// éå†ç‰©å“       </span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = weight[i]; j &lt;= bagWeight; j++) &#123; <span class="comment">// éå†èƒŒåŒ…å®¹é‡</span></span><br><span class="line">            dp[j] = <span class="built_in">max</span>(dp[j], dp[j - weight[i]] + value[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dp[bagWeight];   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“">æ€»ç»“</h2><ol><li>ä¸ç®¡æ˜¯0-1èƒŒåŒ…è¿˜æ˜¯å®Œå…¨èƒŒåŒ…ï¼Œå…¶äºŒç»´å®ç°ä¸¤ç§éå†é¡ºåºéƒ½æ˜¯å¯ä»¥çš„</li><li>0-1èƒŒåŒ…å’Œå®Œå…¨èƒŒåŒ…è§£å†³çš„æ˜¯ç»„åˆé—®é¢˜ï¼Œå¹¶éæ’åˆ—é—®é¢˜ï¼Œæ’åˆ—é—®é¢˜å‚è€ƒçˆ¬æ¥¼æ¢¯</li><li>0-1èƒŒåŒ…å’Œå®Œå…¨èƒŒåŒ…ç»„åˆé—®é¢˜éƒ½æ˜¯å¤–å±‚éå†ç‰©å“ï¼Œå†…å±‚éå†èƒŒåŒ…å®¹é‡ã€‚</li><li>0-1èƒŒåŒ…æ˜¯<strong>é€†å‘</strong>éå†èƒŒåŒ…å®¹é‡ï¼Œä¿è¯å½“å‰ç‰©å“æœ€å¤šä¸€ä¸ªè¢«åŠ å…¥ã€‚å®Œå…¨èƒŒåŒ…<strong>æ­£å‘</strong>éå†ï¼Œä½¿å¾—å¯ä»¥å½“å‰ç‰©å“å¯å¤šæ¬¡è¢«åŠ å…¥</li><li>å¯¹äºæ’åˆ—é—®é¢˜ï¼Œå…ˆéå†èƒŒåŒ…ï¼Œåœ¨éå†ç‰©å“ã€‚<a href="https://leetcode-cn.com/problems/combination-sum-iv/">å‚è€ƒçˆ¬æ¥¼æ¢¯è¿›é˜¶ç‰ˆ</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> èƒŒåŒ…é—®é¢˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ’åºç®—æ³•(ä¸‰)â€”â€”å †ã€è®¡æ•°ã€æ¡¶ã€åŸºæ•°æ’åº</title>
      <link href="/2021/12/09/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%9503/"/>
      <url>/2021/12/09/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%9503/</url>
      
        <content type="html"><![CDATA[<h3 id="å †æ’åº">å †æ’åº</h3><p>å †æ’åº(Heapsort)æ˜¯æŒ‡åˆ©ç”¨å †ç§¯æ ‘ï¼ˆå †ï¼‰è¿™ç§æ•°æ®ç»“æ„æ‰€è®¾è®¡çš„ä¸€ç§æ’åºç®—æ³•ï¼Œå®ƒæ˜¯é€‰æ‹©æ’åºçš„ä¸€ç§ã€‚å¯ä»¥åˆ©ç”¨æ•°ç»„çš„ç‰¹ç‚¹å¿«é€Ÿå®šä½æŒ‡å®šç´¢å¼•çš„å…ƒç´ ã€‚å †æ’åºå°±æ˜¯æŠŠæœ€å¤§å †å †é¡¶çš„æœ€å¤§æ•°å–å‡ºï¼Œå°†å‰©ä½™çš„å †ç»§ç»­è°ƒæ•´ä¸ºæœ€å¤§å †ï¼Œå†æ¬¡å°†å †é¡¶çš„æœ€å¤§æ•°å–å‡ºï¼Œè¿™ä¸ªè¿‡ç¨‹æŒç»­åˆ°å‰©ä½™æ•°åªæœ‰ä¸€ä¸ªæ—¶ç»“æŸã€‚</p><h4 id="å †çš„æ¦‚å¿µ">å †çš„æ¦‚å¿µ</h4><p>å †æ˜¯ä¸€ç§å®Œå…¨äºŒå‰æ ‘ï¼Œè¿™ä½¿å¾—å †(å®Œå…¨äºŒå‰æ ‘)å¯ä»¥ç”¨æ•°ç»„è¿›è¡Œè¡¨ç¤ºã€‚å¦‚ä¸‹å›¾æ¯ä¸€ä¸ªèŠ‚ç‚¹å¯¹åº”æ•°ç»„çš„ä¸€ä¸ªå…ƒç´ ä¸”å¯ä»¥é€šè¿‡æ•°ç»„ä¸‹æ ‡æ¥åˆ¤æ–­èŠ‚ç‚¹é—´ä½ç½®ã€‚<br>å¯¹äºç»™å®šä¸‹æ ‡ä¸º<code>i</code>çš„æ•°ç»„ä¸­çš„æ•°ç»„,å…¶è¯¥å…ƒç´ æ‰€å¯¹åº”çš„çˆ¶èŠ‚ç‚¹ã€å­©å­èŠ‚ç‚¹ä¸‹æ ‡ä¸º(ä»¥1ä½œä¸ºå¼€å§‹)ï¼š<br>çˆ¶èŠ‚ç‚¹ï¼š    <code>Parent(i) = floor(i/2)</code><br>å·¦å­©å­èŠ‚ç‚¹ï¼š <code>Left(i) = 2*i</code><br>å³å­©å­èŠ‚ç‚¹:  <code>Right(i)= 2*i +1</code><br><img src="/img/algorithm/heap.png" alt="heap"></p><ul><li>æœ€å¤§å †å³æœ€å¤§å…ƒç´ å€¼å‡ºç°åœ¨æ ¹ç»“ç‚¹ï¼Œå †ä¸­æ¯ä¸ªçˆ¶èŠ‚ç‚¹çš„å…ƒç´ å€¼éƒ½å¤§äºç­‰äºå…¶å­©å­ç»“ç‚¹ ç”¨äº<strong>å‡åº</strong>æ’åˆ—</li><li>æœ€å°å †ä¸­çš„æœ€å°å…ƒç´ å€¼å‡ºç°åœ¨æ ¹ç»“ç‚¹ï¼Œå †ä¸­æ¯ä¸ªçˆ¶èŠ‚ç‚¹çš„å…ƒç´ å€¼éƒ½å°äºç­‰äºå…¶å­©å­ç»“ç‚¹ ç”¨äº<strong>é™åº</strong>æ’åˆ—</li></ul><h4 id="ç®—æ³•æè¿°">ç®—æ³•æè¿°</h4><p>å †æ’åºå°±æ˜¯æŠŠæœ€å¤§å †å †é¡¶çš„æœ€å¤§æ•°å–å‡ºï¼Œå°†å‰©ä½™çš„å †ç»§ç»­è°ƒæ•´ä¸ºæœ€å¤§å †ï¼Œå†æ¬¡å°†å †é¡¶çš„æœ€å¤§æ•°å–å‡ºï¼Œè¿™ä¸ªè¿‡ç¨‹æŒç»­åˆ°å‰©ä½™æ•°åªæœ‰ä¸€ä¸ªæ—¶ç»“æŸã€‚åœ¨å †ä¸­å®šä¹‰ä»¥ä¸‹å‡ ç§æ“ä½œ</p><ul><li><p>æœ€å¤§å †è°ƒæ•´ï¼ˆMax-Heapifyï¼‰ï¼šå°†å †çš„æœ«ç«¯å­èŠ‚ç‚¹ä½œè°ƒæ•´ï¼Œä½¿å¾—å­èŠ‚ç‚¹æ°¸è¿œå°äºçˆ¶èŠ‚ç‚¹</p></li><li><p>åˆ›å»ºæœ€å¤§å †ï¼ˆBuild-Max-Heapï¼‰ï¼šå°†å †æ‰€æœ‰æ•°æ®é‡æ–°æ’åºï¼Œä½¿å…¶æˆä¸ºæœ€å¤§å †<br><img src="/img/algorithm/buildHeap.gif" alt="buildHeap"></p></li><li><p>ç§»é™¤ä½åœ¨ç¬¬ä¸€ä¸ªæ•°æ®çš„æ ¹èŠ‚ç‚¹ï¼Œå¹¶åšæœ€å¤§å †è°ƒæ•´çš„é€’å½’è¿ç®—<br><img src="/img/algorithm/adjustHeap.gif" alt="adjustHeap"></p></li></ul><h4 id="ç®—æ³•å®ç°">ç®—æ³•å®ç°</h4><p>éœ€è¦æ³¨æ„çš„ä¸€ä¸ªé—®é¢˜æ˜¯ï¼šæ•°ç»„éƒ½æ˜¯ Zero-Basedï¼Œè¿™å°±æ„å‘³ç€æˆ‘ä»¬çš„å †æ•°æ®ç»“æ„æ¨¡å‹è¦å‘ç”Ÿæ”¹å˜å³<br>å¯¹äºç»™å®šä¸‹æ ‡ä¸º<code>i</code>çš„æ•°ç»„ä¸­çš„æ•°ç»„,å…¶è¯¥å…ƒç´ æ‰€å¯¹åº”çš„çˆ¶èŠ‚ç‚¹ã€å­©å­èŠ‚ç‚¹ä¸‹æ ‡ä¸º(ä»¥0ä½œä¸ºå¼€å§‹)ï¼š<br>çˆ¶èŠ‚ç‚¹ï¼š    <code>Parent(i) = floor((i-1)/2)</code><br>å·¦å­©å­èŠ‚ç‚¹ï¼š <code>Left(i) = 2*i+1</code><br>å³å­©å­èŠ‚ç‚¹:  <code>Right(i)= 2*(i+1)</code></p><p>å¯¹äºåˆ©ç”¨å †æ’åºï¼Œåªå…³å¿ƒä¸¤ä¸ªé—®é¢˜</p><ol><li>ç»™å®šä¸€ä¸ªæ— åºæ•°ç»„ï¼Œå¦‚ä½•å»ºç«‹å †</li><li>åˆ é™¤å †é¡¶å…ƒç´ ï¼Œå¦‚ä½•è°ƒæ•´æˆä¸ºæ–°çš„å †</li></ol><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">heapSort</span><span class="params">(<span class="keyword">int</span> arr[],<span class="keyword">int</span> len)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> lastIndex = len<span class="number">-1</span>;</span><br><span class="line">    <span class="comment">//åˆå§‹åŒ–æœ€å¤§å †</span></span><br><span class="line">    <span class="comment">//ä»ç¬¬ä¸€ä¸ªéå¶å­èŠ‚ç‚¹å¼€å§‹</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="built_in">getParentIndex</span>(lastIndex); i&gt;=<span class="number">0</span>;i--)</span><br><span class="line">        <span class="built_in">adjustHeap</span>(arr,i,lastIndex);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆ é™¤å †é¡¶å…ƒç´ ,é‡æ–°è°ƒæ•´å †</span></span><br><span class="line">    <span class="keyword">while</span>(lastIndex&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="built_in">swap</span>(arr[<span class="number">0</span>],arr[lastIndex]);</span><br><span class="line">        lastIndex--;</span><br><span class="line">        <span class="built_in">adjustHeap</span>(arr,<span class="number">0</span>,lastIndex);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">adjustHeap</span><span class="params">(<span class="keyword">int</span> arr[], <span class="keyword">int</span> curIndex, <span class="keyword">int</span> endIndex)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> left,right,exchangeIndex;</span><br><span class="line">    left = <span class="built_in">getLeftChildIndex</span>(curIndex);</span><br><span class="line">    <span class="keyword">while</span>(left &lt;= endIndex)&#123;</span><br><span class="line">        <span class="comment">//é€‰æ‹©å·¦å³å­©å­ä¸­è¾ƒå¤§çš„è¿›è¡Œäº¤æ¢</span></span><br><span class="line">        right = left  + <span class="number">1</span>;</span><br><span class="line">        exchangeIndex = left;</span><br><span class="line">        <span class="keyword">if</span>(right &lt;= endIndex &amp;&amp; arr[left] &lt; arr[right])&#123;</span><br><span class="line">            exchangeIndex = right;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//è‹¥å½“å‰èŠ‚ç‚¹å°äºå…¶å­©å­èŠ‚ç‚¹ï¼Œäº¤æ¢å¹¶ä¸‹æ²‰</span></span><br><span class="line">        <span class="keyword">if</span>(arr[curIndex] &lt; arr[exchangeIndex])&#123;</span><br><span class="line">            <span class="built_in">swap</span>(arr[curIndex],arr[exchangeIndex]);</span><br><span class="line">            curIndex = exchangeIndex;</span><br><span class="line">            left = <span class="built_in">getLeftChildIndex</span>(curIndex);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getParentIndex</span><span class="params">(<span class="keyword">int</span> index)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (index<span class="number">-1</span>) /<span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getLeftChildIndex</span><span class="params">(<span class="keyword">int</span> index)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">2</span> * index + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ç®—æ³•ç‰¹ç‚¹">ç®—æ³•ç‰¹ç‚¹</h4><ol><li>å †æ’åºå­˜åœ¨å¤§é‡çš„ç­›é€‰å’Œç§»åŠ¨è¿‡ç¨‹ï¼Œå±äºä¸ç¨³å®šçš„æ’åºç®—æ³•</li><li>å †æ’åºåœ¨å»ºç«‹å †å’Œè°ƒæ•´å †çš„è¿‡ç¨‹ä¸­ä¼šäº§ç”Ÿæ¯”è¾ƒå¤§çš„å¼€é”€ï¼Œåœ¨å…ƒç´ å°‘çš„æ—¶å€™å¹¶ä¸é€‚ç”¨</li><li>åœ¨å…ƒç´ æ¯”è¾ƒå¤šçš„æƒ…å†µä¸‹,å°¤å…¶æ˜¯åœ¨è§£å†³è¯¸å¦‚â€œå‰nå¤§çš„æ•°â€ä¸€ç±»é—®é¢˜æ—¶ï¼Œå‡ ä¹æ˜¯é¦–é€‰ç®—æ³•ã€‚</li></ol><h3 id="è®¡æ•°æ’åº">è®¡æ•°æ’åº</h3><p>è®¡æ•°æ’åºä¸æ˜¯åŸºäºæ¯”è¾ƒçš„æ’åºç®—æ³•ï¼Œå…¶æ ¸å¿ƒåœ¨äºå°†è¾“å…¥çš„æ•°æ®å€¼è½¬åŒ–ä¸ºé”®å­˜å‚¨åœ¨é¢å¤–å¼€è¾Ÿçš„æ•°ç»„ç©ºé—´ä¸­ã€‚ ä½œä¸ºä¸€ç§çº¿æ€§æ—¶é—´å¤æ‚åº¦çš„æ’åºï¼Œè®¡æ•°æ’åºè¦æ±‚è¾“å…¥çš„æ•°æ®å¿…é¡»æ˜¯<strong>æœ‰ç¡®å®šèŒƒå›´çš„æ•´æ•°</strong>ã€‚</p><h4 id="ç®—æ³•æè¿°-2">ç®—æ³•æè¿°</h4><ol><li>æ‰¾å‡ºå¾…æ’åºçš„æ•°ç»„ä¸­æœ€å¤§å’Œæœ€å°çš„å…ƒç´ ï¼›</li><li>ç»Ÿè®¡æ•°ç»„ä¸­æ¯ä¸ªå€¼ä¸ºiçš„å…ƒç´ å‡ºç°çš„æ¬¡æ•°ï¼Œå­˜å…¥æ•°ç»„Cçš„ç¬¬ié¡¹ï¼›</li><li>å¯¹æ‰€æœ‰çš„è®¡æ•°ç´¯åŠ ï¼ˆä»Cä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹ï¼Œæ¯ä¸€é¡¹å’Œå‰ä¸€é¡¹ç›¸åŠ ï¼‰ï¼›</li><li>åå‘å¡«å……ç›®æ ‡æ•°ç»„ï¼šå°†æ¯ä¸ªå…ƒç´ iæ”¾åœ¨æ–°æ•°ç»„çš„ç¬¬C(i)é¡¹ï¼Œæ¯æ”¾ä¸€ä¸ªå…ƒç´ å°±å°†C(i)å‡å»1</li></ol><h4 id="åŠ¨å›¾æ¼”ç¤º">åŠ¨å›¾æ¼”ç¤º</h4><p><img src="/img/algorithm/countSort.gif" alt="countSort"></p><h4 id="ç®—æ³•å®ç°-2">ç®—æ³•å®ç°</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">countSort</span><span class="params">(<span class="keyword">int</span> arr[],<span class="keyword">int</span> len, <span class="keyword">int</span> maxVal, <span class="keyword">int</span> minVal)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> cntLen = maxVal- minVal + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span>* cntVec = <span class="keyword">new</span> <span class="keyword">int</span>[cntLen];</span><br><span class="line">    <span class="comment">//åˆå§‹åŒ–ä¸º0</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = minVal; i &lt;= maxVal;i++)</span><br><span class="line">        cntVec[i] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç»Ÿè®¡æ¯ä¸ªå€¼å‡ºç°çš„æ¬¡æ•°</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++ )&#123;</span><br><span class="line">        cntVec[arr[i]-minVal]++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æŒ‰ç…§è®¡æ•°é¡ºåºå°†å…¶ä¾æ¬¡å¡«å……åˆ°åŸæ•°ç»„ä¸­</span></span><br><span class="line">    <span class="keyword">int</span> p = <span class="number">0</span>;  <span class="comment">//æŒ‡å‘è®¡æ•°æ•°ç»„</span></span><br><span class="line">    <span class="keyword">int</span> curIndex = <span class="number">0</span>; <span class="comment">//æŒ‡å‘éœ€è¦è¢«å¡«å……çš„æ•°ç»„</span></span><br><span class="line">    <span class="keyword">while</span>(p &lt; cntLen)&#123;</span><br><span class="line">        <span class="keyword">while</span>(cntVec[p] &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            arr[curIndex++] = p + minVal;</span><br><span class="line">            cntVec[p]--;</span><br><span class="line">        &#125;</span><br><span class="line">        p++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">delete</span> []cntVec;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ç®—æ³•ç‰¹ç‚¹-2">ç®—æ³•ç‰¹ç‚¹</h4><ol><li>æ’åºç›®æ ‡è¦èƒ½å¤Ÿæ˜ å°„åˆ°æ•´æ•°åŸŸï¼Œå…¶æœ€å¤§å€¼æœ€å°å€¼åº”å½“å®¹æ˜“è¾¨åˆ«</li><li>è®¡æ•°æ’åºéœ€è¦å ç”¨å¤§é‡ç©ºé—´ï¼Œå®ƒæ¯”è¾ƒé€‚ç”¨äºæ•°æ®æ¯”è¾ƒé›†ä¸­çš„æƒ…å†µ</li></ol><h3 id="æ¡¶æ’åº">æ¡¶æ’åº</h3><p>æ¡¶æ’åºåˆå«ç®±æ’åºï¼Œæ˜¯è®¡æ•°æ’åºçš„å‡çº§ç‰ˆï¼Œå®ƒçš„å·¥ä½œåŸç†æ˜¯å°†æ•°ç»„åˆ†åˆ°æœ‰é™æ•°é‡çš„æ¡¶å­é‡Œï¼Œç„¶åå¯¹æ¯ä¸ªæ¡¶å­å†åˆ†åˆ«æ’åºï¼ˆæœ‰å¯èƒ½å†ä½¿ç”¨åˆ«çš„æ’åºç®—æ³•æˆ–æ˜¯ä»¥é€’å½’æ–¹å¼ç»§ç»­ä½¿ç”¨æ¡¶æ’åºè¿›è¡Œæ’åºï¼‰ï¼Œæœ€åå°†å„ä¸ªæ¡¶ä¸­çš„æ•°æ®æœ‰åºçš„åˆå¹¶èµ·æ¥ã€‚</p><blockquote><p>è®¡æ•°æ’åºæ˜¯æ¡¶æ’åºçš„ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œå¯ä»¥æŠŠè®¡æ•°æ’åºå½“æˆæ¯ä¸ªæ¡¶é‡Œåªæœ‰ä¸€ä¸ªå…ƒç´ çš„æƒ…å†µ<br>æ¡¶æ’åºæ˜¯è®¡æ•°æ’åºçš„å‡çº§ç‰ˆã€‚å®ƒåˆ©ç”¨äº†å‡½æ•°çš„æ˜ å°„å…³ç³»ï¼Œé«˜æ•ˆä¸å¦çš„å…³é”®å°±åœ¨äºè¿™ä¸ªæ˜ å°„å‡½æ•°çš„ç¡®å®šã€‚ä¸ºäº†ä½¿æ¡¶æ’åºæ›´åŠ é«˜æ•ˆï¼Œæˆ‘ä»¬éœ€è¦åšåˆ°è¿™ä¸¤ç‚¹ï¼š</p></blockquote><ol><li>åœ¨é¢å¤–ç©ºé—´å……è¶³çš„æƒ…å†µä¸‹ï¼Œå°½é‡å¢å¤§æ¡¶çš„æ•°é‡</li><li>ä½¿ç”¨çš„æ˜ å°„å‡½æ•°èƒ½å¤Ÿå°†è¾“å…¥çš„ N ä¸ªæ•°æ®å‡åŒ€çš„åˆ†é…åˆ° K ä¸ªæ¡¶ä¸­</li></ol><h4 id="ç®—æ³•æè¿°-3">ç®—æ³•æè¿°</h4><ol><li>æ‰¾å‡ºå¾…æ’åºæ•°ç»„ä¸­çš„æœ€å¤§å€¼maxã€æœ€å°å€¼min</li><li>ä½¿ç”¨æ•°ç»„ä½œä¸ºæ¡¶ï¼Œæ¡¶é‡Œæ”¾çš„å…ƒç´ ç”¨å­˜å‚¨ã€‚æ¡¶çš„æ•°é‡ä¸º(max-min)/arr.length+1</li><li>éå†æ•°ç»„ arrï¼Œè®¡ç®—æ¯ä¸ªå…ƒç´  arr[i] æ”¾çš„æ¡¶</li><li>æ¯ä¸ªæ¡¶å„è‡ªæ’åº</li><li>éå†æ¡¶æ•°ç»„ï¼ŒæŠŠæ’åºå¥½çš„å…ƒç´ æ”¾è¿›è¾“å‡ºæ•°ç»„</li></ol><h4 id="å›¾ç‰‡è§£é‡Š">å›¾ç‰‡è§£é‡Š</h4><p><img src="/img/algorithm/bucketSort.png" alt="bucketSort"></p><h4 id="ç®—æ³•ç‰¹ç‚¹-3">ç®—æ³•ç‰¹ç‚¹</h4><ol><li>å½“è¾“å…¥æ•°æ®å¯ä»¥å‡åŒ€çš„åˆ†é…åˆ°æ¡¶æœ€å¿«</li><li>ç©ºé—´å¤æ‚åº¦ï¼šO(n+k)ï¼Œæ—¶é—´å¤æ‚åº¦O(n+k)</li></ol><h3 id="åŸºæ•°æ’åº">åŸºæ•°æ’åº</h3><p>åŸºæ•°æ’åº(Radix Sort)æ˜¯æ¡¶æ’åºçš„æ‰©å±•ï¼Œå®ƒçš„åŸºæœ¬æ€æƒ³æ˜¯ï¼šå°†æ•´æ•°æŒ‰ä½æ•°åˆ‡å‰²æˆä¸åŒçš„æ•°å­—ï¼Œç„¶åæŒ‰æ¯ä¸ªä½æ•°åˆ†åˆ«æ¯”è¾ƒã€‚<br>æ’åºè¿‡ç¨‹ï¼šå°†æ‰€æœ‰å¾…æ¯”è¾ƒæ•°å€¼ï¼ˆæ­£æ•´æ•°ï¼‰ç»Ÿä¸€ä¸ºåŒæ ·çš„æ•°ä½é•¿åº¦ï¼Œæ•°ä½è¾ƒçŸ­çš„æ•°å‰é¢è¡¥é›¶ã€‚ç„¶åï¼Œä»æœ€ä½ä½å¼€å§‹ï¼Œä¾æ¬¡è¿›è¡Œä¸€æ¬¡æ’åºã€‚è¿™æ ·ä»æœ€ä½ä½æ’åºä¸€ç›´åˆ°æœ€é«˜ä½æ’åºå®Œæˆä»¥å, æ•°åˆ—å°±å˜æˆä¸€ä¸ªæœ‰åºåºåˆ—ã€‚</p><p>å®é™…ä¸Šï¼ŒåŸºæ•°æ’åºç®—æ³•å¯¹æ’åºå…ƒç´ çš„ç±»å‹ä¸è¦æ±‚ä¸€å®šæ˜¯éè´Ÿæ•´æ•°æ‰å¯ä»¥è¿›è¡Œï¼Œå…¶å¯¹äºå­—ç¬¦ä¸²ã€æµ®ç‚¹æ•°ç­‰ç±»å‹å‡å¯é€‚ç”¨ã€‚å…¶å…³é”®åœ¨äºè¦æ±‚æ’åºå…ƒç´ çš„æ•°ä½é•¿åº¦ç»Ÿä¸€ã€‚ä¾‹å¦‚å¯¹æ•´æ•°æ’åºæ—¶ï¼Œå¦‚æœæ’åºå…ƒç´ ä¸­å«æœ‰è´Ÿæ•°ï¼Œåˆ™å¯ä»¥å¯¹æ’åºå…ƒç´ å‡åŠ ä¸Šä¸€ä¸ªæ•°ä½¿å…¶å…¨éƒ¨ä¸ºéè´Ÿæ•´æ•°ï¼›å¦‚æœå…ƒç´ ç±»å‹æ˜¯å­—ç¬¦ä¸²çš„è¯ï¼Œåœ¨è®¡æ•°æ’åºè¿‡ç¨‹ä¸­ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨è¯¥ä½å­—ç¬¦å¯¹åº”ASCIIç å€¼è¿›è¡Œè®¡æ•°ï¼Œå¯¹äºé•¿åº¦ä¸è¶³çš„å­—ç¬¦ä¸²ï¼Œå¯ç›´æ¥åœ¨å…¶åé¢è¡¥0å®ç°é•¿åº¦å¯¹é½ã€‚å³åœ¨è®¡æ•°æ’åºè¿‡ç¨‹ä¸­ï¼Œå¦‚æœå‘ç°æŸä½å­—ç¬¦æ˜¯ä¸ºå¯¹é½æ‰€å¡«å……çš„0çš„è¯ï¼Œåˆ™å¯è®¤ä¸ºå…¶å¯¹åº”çš„ASCIIç å€¼ä¸º0è¿›è¡Œè®¡æ•°ï¼Œå› ä¸ºå­—ç¬¦â€™Aâ€™æ‰€å¯¹åº”çš„ASCIIç å€¼æ˜¯65ï¼Œå­—ç¬¦â€™0â€™æ‰€å¯¹åº”çš„ASCIIç å€¼æ˜¯48ï¼Œå‡æ¯”0å¤§ã€‚è¿™æ ·å³å¯ä¿è¯åŸºæ•°æ’åºçš„ç»“æœæ˜¯ç¬¦åˆå­—å…¸åºçš„å®ç°</p><h4 id="åŠ¨å›¾æ¼”ç¤º-2">åŠ¨å›¾æ¼”ç¤º</h4><p><img src="/img/algorithm/radixSort.gif" alt="radixSort"></p><h4 id="ç®—æ³•ç‰¹ç‚¹-4">ç®—æ³•ç‰¹ç‚¹</h4><ol><li><p>é€šè¿‡ä¸Šé¢çš„æ’åºè¿‡ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ¯ä¸€è½®æ˜ å°„å’Œæ”¶é›†æ“ä½œï¼Œéƒ½ä¿æŒä»å·¦åˆ°å³çš„é¡ºåºè¿›è¡Œï¼Œå¦‚æœå‡ºç°ç›¸åŒçš„å…ƒç´ ï¼Œåˆ™ä¿æŒä»–ä»¬åœ¨åŸå§‹æ•°ç»„ä¸­çš„é¡ºåºã€‚å¯è§ï¼ŒåŸºæ•°æ’åºæ˜¯ä¸€ç§ç¨³å®šçš„æ’åºã€‚</p></li><li><p>åŸºæ•°æ’åºè¦æ±‚è¾ƒé«˜ï¼Œå…ƒç´ å¿…é¡»æ˜¯æ•´æ•°ï¼Œæ•´æ•°æ—¶é•¿åº¦10Wä»¥ä¸Šï¼Œæœ€å¤§å€¼100Wä»¥ä¸‹æ•ˆç‡è¾ƒå¥½ï¼Œä½†æ˜¯åŸºæ•°æ’åºæ¯”å…¶ä»–æ’åºå¥½åœ¨å¯ä»¥é€‚ç”¨å­—ç¬¦ä¸²ï¼Œæˆ–è€…å…¶ä»–éœ€è¦æ ¹æ®å¤šä¸ªæ¡ä»¶è¿›è¡Œæ’åºçš„åœºæ™¯ï¼Œä¾‹å¦‚æ—¥æœŸï¼Œå…ˆæ’åºæ—¥ï¼Œå†æ’åºæœˆï¼Œæœ€åæ’åºå¹´ ï¼Œå…¶å®ƒæ’åºç®—æ³•å¯æ˜¯åšä¸äº†çš„</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ’åº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ’åºç®—æ³•(äºŒ)â€”â€”å¸Œå°”ã€å¿«é€Ÿã€å½’å¹¶</title>
      <link href="/2021/12/07/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%9502/"/>
      <url>/2021/12/07/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%9502/</url>
      
        <content type="html"><![CDATA[<h3 id="å¸Œå°”æ’åº-æ’å…¥æ’åºçš„æ”¹è‰¯ç‰ˆ">å¸Œå°”æ’åº(æ’å…¥æ’åºçš„æ”¹è‰¯ç‰ˆ)</h3><p>åœ¨å¸Œå°”æ’åºå‡ºç°ä¹‹å‰ï¼Œè®¡ç®—æœºç•Œæ™®éå­˜åœ¨â€œæ’åºç®—æ³•ä¸å¯èƒ½çªç ´O(n2)â€çš„è§‚ç‚¹ã€‚å¸Œå°”æ’åºæ˜¯ç¬¬ä¸€ä¸ªçªç ´O(n2)çš„æ’åºç®—æ³•ï¼Œå®ƒæ˜¯ç®€å•æ’å…¥æ’åºçš„æ”¹è¿›ç‰ˆã€‚å¸Œå°”æ’åºçš„æå‡ºï¼Œä¸»è¦åŸºäºä»¥ä¸‹ä¸¤ç‚¹ï¼š</p><ol><li>æ’å…¥æ’åºç®—æ³•åœ¨æ•°ç»„åŸºæœ¬æœ‰åºçš„æƒ…å†µä¸‹ï¼Œå¯ä»¥è¿‘ä¼¼è¾¾åˆ°O(n)å¤æ‚åº¦ï¼Œæ•ˆç‡æé«˜ã€‚</li><li>ä½†æ’å…¥æ’åºæ¯æ¬¡åªèƒ½å°†æ•°æ®ç§»åŠ¨ä¸€ä½ï¼Œåœ¨æ•°ç»„è¾ƒå¤§ä¸”åŸºæœ¬æ— åºçš„æƒ…å†µä¸‹æ€§èƒ½ä¼šè¿…é€Ÿæ¶åŒ–ã€‚</li></ol><h4 id="ç®—æ³•æè¿°">ç®—æ³•æè¿°</h4><p>å¸Œå°”æ’åºçš„åŸºæœ¬æ€æƒ³æ˜¯ï¼šå…ˆå°†æ•´ä¸ªå¾…æ’åºçš„è®°å½•åºåˆ—åˆ†å‰²æˆä¸ºè‹¥å¹²å­åºåˆ—åˆ†åˆ«è¿›è¡Œç›´æ¥æ’å…¥æ’åºï¼Œå¾…æ•´ä¸ªåºåˆ—ä¸­çš„è®°å½•&quot;åŸºæœ¬æœ‰åº&quot;æ—¶ï¼Œå†å¯¹å…¨ä½“è®°å½•è¿›è¡Œä¾æ¬¡ç›´æ¥æ’å…¥æ’åº</p><ol><li>é€‰æ‹©ä¸€ä¸ªå¢é‡åºåˆ—t1ï¼Œt2ï¼Œâ€¦ï¼Œtkï¼Œå…¶ä¸­ti&gt;tjï¼Œtk=1ï¼›</li><li>æŒ‰å¢é‡åºåˆ—ä¸ªæ•°kï¼Œå¯¹åºåˆ—è¿›è¡Œ k è¶Ÿæ’åº</li><li>æ¯è¶Ÿæ’åºï¼Œæ ¹æ®å¯¹åº”çš„å¢é‡tiï¼Œå°†å¾…æ’åºåˆ—åˆ†å‰²æˆè‹¥å¹²é•¿åº¦ä¸ºm çš„å­åºåˆ—ï¼Œåˆ†åˆ«å¯¹å„å­è¡¨è¿›è¡Œç›´æ¥æ’å…¥æ’åºã€‚ä»…å¢é‡å› å­ä¸º1 æ—¶ï¼Œæ•´ä¸ªåºåˆ—ä½œä¸ºä¸€ä¸ªè¡¨æ¥å¤„ç†ï¼Œè¡¨é•¿åº¦å³ä¸ºæ•´ä¸ªåºåˆ—çš„é•¿åº¦<br><img src="/img/algorithm/shellSortDes.png" alt="å¸Œå°”æ’åº"></li></ol><h4 id="åŠ¨å›¾æ¼”ç¤º">åŠ¨å›¾æ¼”ç¤º</h4><p><img src="/img/algorithm/shellSort.gif" alt="å¸Œå°”æ’åº"></p><h4 id="ç®—æ³•å®ç°">ç®—æ³•å®ç°</h4><p>åœ¨å¸Œå°”æ’åºçš„ç†è§£æ—¶ï¼Œæˆ‘ä»¬å€¾å‘äºå¯¹äºæ¯ä¸€ä¸ªåˆ†ç»„ï¼Œé€ç»„è¿›è¡Œå¤„ç†ï¼Œä½†åœ¨ä»£ç å®ç°ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ç”¨è¿™ä¹ˆæŒ‰éƒ¨å°±ç­åœ°å¤„ç†å®Œä¸€ç»„å†è°ƒè½¬å›æ¥å¤„ç†ä¸‹ä¸€ç»„,å®ç°æ—¶ä¸ç”¨å¾ªç¯æŒ‰ç»„å¤„ç†ï¼Œæˆ‘ä»¬å¯ä»¥ä»ç¬¬gapä¸ªå…ƒç´ å¼€å§‹ï¼Œé€ä¸ªè·¨ç»„å¤„ç†ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Donald Shellå¢é‡ æ¯æ¬¡åˆ†ç»„å‡åŠ</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">shellSort</span><span class="params">(<span class="keyword">int</span> arr[], <span class="keyword">int</span> len)</span></span>&#123;</span><br><span class="line">    <span class="comment">//å¢é‡deltaï¼Œå¹¶é€æ­¥ç¼©å°å¢é‡</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> delta = len / <span class="number">2</span>; delta &gt;<span class="number">0</span>; delta /= <span class="number">2</span>)&#123;</span><br><span class="line">        <span class="comment">//ä»ç¬¬deltaä¸ªå…ƒç´ å¼€å§‹ï¼Œé€ä¸ªå¯¹å…¶æ‰€åœ¨ç»„è¿›è¡Œç›´æ¥æ’å…¥æ’åºæ“ä½œ</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = delta; i&lt;len;i++)&#123;</span><br><span class="line">            <span class="comment">//å¯»æ‰¾å¯ä»¥æ’å…¥çš„ä½ç½®</span></span><br><span class="line">            <span class="keyword">int</span> pos = i;</span><br><span class="line">            <span class="keyword">int</span> curVal = arr[i];</span><br><span class="line">            <span class="keyword">while</span>(pos &gt;= delta &amp;&amp; arr[pos-delta] &gt; curVal)&#123;</span><br><span class="line">                arr[pos] = arr[pos-delta];</span><br><span class="line">                pos-=delta;</span><br><span class="line">            &#125;</span><br><span class="line">            arr[pos] = curVal;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ç®—æ³•ç‰¹ç‚¹">ç®—æ³•ç‰¹ç‚¹</h4><ol><li>å¸Œå°”æ’åºçš„å¢é‡æ•°åˆ—å¯ä»¥ä»»å–ï¼Œéœ€è¦çš„å”¯ä¸€æ¡ä»¶æ˜¯æœ€åä¸€ä¸ªä¸€å®šä¸º1ï¼ˆå› ä¸ºè¦ä¿è¯æŒ‰1æœ‰åºï¼‰</li><li>Donald Shellæå‡ºçš„å¢é‡ï¼Œå³æŠ˜åŠé™ä½ç›´åˆ°1,å…¶æ—¶é—´å¤æ‚åº¦è¿˜æ˜¯O(n2)ã€‚Hibbardç»è¿‡å¤æ‚è¯æ˜å¯ä½¿å¾—æœ€åæ—¶é—´å¤æ‚åº¦ä¸ºO(n3/2)</li><li>Shellæ’åºä¸æ˜¯ä¸€ä¸ªç¨³å®šçš„ç®—æ³•</li></ol><h3 id="å¿«é€Ÿæ’åº">å¿«é€Ÿæ’åº</h3><p>å¿«é€Ÿæ’åºç®—æ³•çŸ¥ååº¦è¾ƒé«˜ï¼Œå¯¹äºå¤§æ•°æ®å…·æœ‰ä¼˜ç§€çš„æ’åºæ€§èƒ½å’Œç›¸å¯¹ç®€å•çš„ç®—æ³•å®ç°ã€‚å¿«é€Ÿæ’åºä½¿ç”¨åˆ†æ²»æ³•ï¼ˆDivide and conquerï¼‰ç­–ç•¥æ¥æŠŠä¸€ä¸ªä¸²è¡Œï¼ˆlistï¼‰åˆ†ä¸ºä¸¤ä¸ªå­ä¸²è¡Œï¼ˆsub-listsï¼‰ã€‚</p><h4 id="ç®—æ³•æè¿°-2">ç®—æ³•æè¿°</h4><ol><li>ä»åºåˆ—ä¸­æŒ‘å‡ºä¸€ä¸ªå…ƒç´ ä½œä¸ºåŸºå‡†(pivot)</li><li>é‡æ–°æ’åºæ•°åˆ—ï¼Œæ‰€æœ‰æ¯”åŸºå‡†å€¼å°çš„å…ƒç´ æ‘†æ”¾åœ¨åŸºå‡†å‰é¢ï¼Œæ‰€æœ‰æ¯”åŸºå‡†å€¼å¤§çš„å…ƒç´ æ‘†åœ¨åŸºå‡†åé¢ï¼ˆç›¸åŒçš„æ•°å¯ä»¥åˆ°ä»»ä½•ä¸€è¾¹ï¼‰ã€‚åœ¨è¿™ä¸ªåˆ†åŒºç»“æŸä¹‹åï¼Œè¯¥åŸºå‡†å°±å¤„äºæ•°åˆ—çš„ä¸­é—´ä½ç½®ã€‚è¿™ä¸ªç§°ä¸ºåˆ†åŒº(partition)æ“ä½œã€‚</li><li>é€’å½’çš„æŠŠå·¦å³ä¸¤è¾¹çš„å­—åºåˆ—è¿›è¡Œæ’åº</li><li>ç›´åˆ°å­æ•°ç»„é•¿åº¦ä¸º1</li></ol><h4 id="åŠ¨å›¾æ¼”ç¤º-2">åŠ¨å›¾æ¼”ç¤º</h4><p><img src="/img/algorithm/quickSort.gif" alt="å¿«é€Ÿæ’åº"></p><h4 id="ç®—æ³•å®ç°-2">ç®—æ³•å®ç°</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">quickSort</span><span class="params">(<span class="keyword">int</span> arr[],<span class="keyword">int</span> left,<span class="keyword">int</span> right)</span></span>&#123;</span><br><span class="line">    <span class="comment">//left æ•°ç»„èµ·å§‹ä¸‹æ ‡</span></span><br><span class="line">    <span class="comment">//right æ•°ç»„ç»“æŸä¸‹æ ‡</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//é€’å½’ç»ˆæ­¢æ¡ä»¶ æ•°ç»„é•¿åº¦ä¸º1</span></span><br><span class="line">    <span class="keyword">if</span>(left &gt;= right)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="comment">//æ‰§è¡Œpartitionæ“ä½œï¼Œå°†æ•°ç»„åˆ†ä¸ºä¸¤ä¸ªå­æ•°ç»„</span></span><br><span class="line">    <span class="keyword">int</span> pivotIndex = <span class="built_in">partition</span>(arr,left,right);</span><br><span class="line">    <span class="comment">//é€’å½’è°ƒç”¨</span></span><br><span class="line">    <span class="built_in">quickSort</span>(arr,left,pivotIndex<span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">quickSort</span>(arr,pivotIndex,right);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">partition</span><span class="params">(<span class="keyword">int</span> arr[],<span class="keyword">int</span> left,<span class="keyword">int</span> right)</span></span>&#123;</span><br><span class="line">    <span class="comment">//é€‰å®šç¬¬ä¸€ä¸ªå…ƒç´ ä½œä¸ºåŸºå‡†(å¯éšæ„)</span></span><br><span class="line">    <span class="keyword">int</span> pivot = arr[left];</span><br><span class="line">    <span class="comment">//æ‰€æœ‰æ¯”åŸºå‡†å€¼å°çš„å…ƒç´ æ‘†æ”¾åœ¨åŸºå‡†å‰é¢ï¼Œæ‰€æœ‰æ¯”åŸºå‡†å€¼å¤§çš„å…ƒç´ æ‘†åœ¨åŸºå‡†åé¢</span></span><br><span class="line">    <span class="keyword">while</span>(left &lt;right)&#123;</span><br><span class="line">        <span class="comment">//é‡‡å–åŒæŒ‡é’ˆçš„æ–¹å¼,ç§»åŠ¨leftå’Œright</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>(left &lt;right &amp;&amp; arr[right] &gt;=pivot)</span><br><span class="line">            --right;</span><br><span class="line">        arr[left] = arr[right]; <span class="comment">//äº¤æ¢æ¯”åŸºå‡†å€¼å°çš„è‡³å·¦è¾¹</span></span><br><span class="line">        <span class="keyword">while</span>(left &lt;right &amp;&amp; arr[left] &lt;=pivot)</span><br><span class="line">            ++left;</span><br><span class="line">        arr[right] = arr[left]; <span class="comment">//äº¤æ¢æ¯”åŸºå‡†å€¼å¤§çš„è‡³å³è¾¹</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ‰«æå®Œæˆï¼ŒåŸºå‡†åˆ°ä½</span></span><br><span class="line">        arr[left] = pivot;</span><br><span class="line">        <span class="keyword">return</span> left;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ’åˆ†ç¬¬äºŒæ–¹æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">partition</span><span class="params">(<span class="keyword">int</span> arr[],<span class="keyword">int</span> left,<span class="keyword">int</span> right)</span></span>&#123;</span><br><span class="line">    <span class="comment">//éšæœºé€‰ä¸­ä¸€ä¸ªå…ƒç´ ä½œä¸ºåŸºå‡†arr[p],å¹¶æ”¾ç½®æœ«å°¾</span></span><br><span class="line">    <span class="comment">//swap(arr[p],arr[right]);</span></span><br><span class="line">    <span class="comment">//è¿™é‡Œç›´æ¥é€‰æ‹©arr[right]ä½œä¸ºåŸºå‡†</span></span><br><span class="line">    <span class="keyword">int</span> pivot = arr[right];</span><br><span class="line">    <span class="comment">//åŒæŒ‡é’ˆ</span></span><br><span class="line">    <span class="comment">//[left,iï¼‰å‡å°äºç­‰äºpivot</span></span><br><span class="line">    <span class="comment">//[i,j)å‡å¤§äºç­‰äºpivot</span></span><br><span class="line">    <span class="comment">//[j,rightï¼‰è¡¨ç¤ºæœªæ‰«æåŒºé—´</span></span><br><span class="line">    <span class="keyword">int</span> i = left; </span><br><span class="line">    <span class="comment">//æ‰«æé™¤åŸºå‡†å¤–çš„å…ƒç´ </span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = left;j &lt; right;j++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(arr[j] &lt;= pivot)&#123;</span><br><span class="line">            <span class="built_in">swap</span>(arr[i],arr[j]);</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å°†åŸºå‡†æ”¾ç½®æ­£ç¡®ä½ç½®</span></span><br><span class="line">    <span class="built_in">swap</span>(arr[i],arr[right]);</span><br><span class="line">    <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/img/algorithm/partition.png" alt="partition"></p><h4 id="ç®—æ³•ç‰¹ç‚¹-2">ç®—æ³•ç‰¹ç‚¹</h4><ol><li>å¿«é€Ÿæ’åºå¹¶ä¸æ˜¯ç¨³å®šçš„ã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬æ— æ³•ä¿è¯ç›¸ç­‰çš„æ•°æ®æŒ‰é¡ºåºè¢«æ‰«æåˆ°å’ŒæŒ‰é¡ºåºå­˜æ”¾</li><li>åœ¨æœ€åçŠ¶å†µä¸‹æ—¶é—´å¤æ‚åº¦(é¡ºåºæ•°åˆ—)åˆ™éœ€è¦ ÎŸ(n2),å¹³å‡ÎŸ(nlogn)</li></ol><h3 id="å½’å¹¶æ’åº">å½’å¹¶æ’åº</h3><h4 id="ç®—æ³•æè¿°-3">ç®—æ³•æè¿°</h4><p><img src="/img/algorithm/mergeSort.png" alt="mergeSort"></p><ol><li>ç”³è¯·ç©ºé—´ï¼Œä½¿å…¶å¤§å°ä¸ºä¸¤ä¸ªå·²ç»æ’åºåºåˆ—ä¹‹å’Œï¼Œè¯¥ç©ºé—´ç”¨æ¥å­˜æ”¾åˆå¹¶åçš„åºåˆ—</li><li>è®¾å®šä¸¤ä¸ªæŒ‡é’ˆï¼Œæœ€åˆä½ç½®åˆ†åˆ«ä¸ºä¸¤ä¸ªå·²ç»æ’åºåºåˆ—çš„èµ·å§‹ä½ç½®</li><li>æ¯”è¾ƒä¸¤ä¸ªæŒ‡é’ˆæ‰€æŒ‡å‘çš„å…ƒç´ ï¼Œé€‰æ‹©ç›¸å¯¹å°çš„å…ƒç´ æ”¾å…¥åˆ°åˆå¹¶ç©ºé—´ï¼Œå¹¶ç§»åŠ¨æŒ‡é’ˆåˆ°ä¸‹ä¸€ä½ç½®</li><li>é‡å¤æ­¥éª¤3ç›´åˆ°æŸä¸€æŒ‡é’ˆåˆ°è¾¾åºåˆ—å°¾</li><li>å°†å¦ä¸€åºåˆ—å‰©ä¸‹çš„æ‰€æœ‰å…ƒç´ ç›´æ¥å¤åˆ¶åˆ°åˆå¹¶åºåˆ—å°¾</li></ol><h4 id="åŠ¨å›¾æ¼”ç¤º-3">åŠ¨å›¾æ¼”ç¤º</h4><p><img src="/img/algorithm/mergeSort.gif" alt="mergeSort"></p><h4 id="ç®—æ³•å®ç°-3">ç®—æ³•å®ç°</h4><h5 id="æ•°ç»„æ’åº">æ•°ç»„æ’åº</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mergeSort</span><span class="params">(<span class="keyword">int</span> arr[],<span class="keyword">int</span> left,<span class="keyword">int</span> right)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(left &gt;= right)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> mid = left + (right-left) /<span class="number">2</span>;</span><br><span class="line">    <span class="comment">//å·¦æ•°ç»„ [left,mid] å³å­æ•°ç»„[mid+1,right]</span></span><br><span class="line">    <span class="built_in">mergeSort</span>(arr,left,mid);</span><br><span class="line">    <span class="built_in">mergeSort</span>(arr,mid+<span class="number">1</span>,right);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆå¹¶</span></span><br><span class="line">    <span class="built_in">merge</span>(arr,left,mid,right);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//åˆå¹¶ä¸¤ä¸ªæœ‰åºæ•°ç»„</span></span><br><span class="line"><span class="comment">//å·¦æ•°ç»„ [left,mid] å³å­æ•°ç»„[mid+1,right]</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> arr[],<span class="keyword">int</span> left,<span class="keyword">int</span> mid,<span class="keyword">int</span> right)</span></span>&#123;</span><br><span class="line">    <span class="comment">//ç”³è¯·ç©ºé—´</span></span><br><span class="line">    <span class="keyword">int</span> *p = <span class="keyword">new</span> <span class="keyword">int</span>[right-left+<span class="number">1</span>];</span><br><span class="line">    <span class="comment">//åˆå¹¶ä¸¤ä¸ªå­æ•°ç»„</span></span><br><span class="line">    <span class="keyword">int</span> i = left,j = mid+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(i&lt;=mid &amp;&amp; j&lt;=right)&#123;</span><br><span class="line">        p[k++] = arr[i] &lt;= arr[j] ? arr[i++] : arr[j++];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (i &lt;=mid)&#123;</span><br><span class="line">        p[k++] = arr[i++];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( j&lt;=right)&#123;</span><br><span class="line">        p[k++] = arr[j++];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æŠŠæ•°æ®å¤åˆ¶å›åŸæ•°ç»„</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = left;i&lt;=right;i++)&#123;</span><br><span class="line">        arr[i] = p[i-left];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">delete</span> []p;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="é“¾è¡¨å½’å¹¶æ’åº">é“¾è¡¨å½’å¹¶æ’åº</h5><p><img src="/img/algorithm/ListMergeSort.png" alt="ListMergeSort"></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//é“¾è¡¨çš„å½’å¹¶æ’åº</span></span><br><span class="line"><span class="function">ListNode* <span class="title">sortList</span><span class="params">(ListNode* head)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">mergeSort</span>(head,<span class="literal">nullptr</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ä»å¤´åˆ°å°¾è¿›è¡Œæ’åºï¼Œè¿”å›æ’åºå¥½çš„å¤´æŒ‡é’ˆ</span></span><br><span class="line"><span class="function">ListNode* <span class="title">mergeSort</span><span class="params">(ListNode* head,ListNode* tail)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!head)</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åªå‰©æœ€åä¸€ä¸ªèŠ‚ç‚¹,tailä¸è¿›è¡Œæ’åº</span></span><br><span class="line">    <span class="keyword">if</span>(head-&gt;next == tail)&#123;</span><br><span class="line">        head-&gt;next = <span class="literal">nullptr</span>;</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å¿«æ…¢æŒ‡é’ˆå¯»æ‰¾ä¸­é—´</span></span><br><span class="line">    ListNode* slow = head,*fast =head,*mid = head;</span><br><span class="line">    <span class="keyword">while</span>(fast != tail)&#123;</span><br><span class="line">        slow = slow-&gt;next;</span><br><span class="line">        fast = fast-&gt;next;</span><br><span class="line">        <span class="keyword">if</span>(fast != tail)</span><br><span class="line">            fast = fast-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    mid = slow;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">merge</span>(<span class="built_in">mergeSort</span>(head,mid),<span class="built_in">mergeSort</span>(mid,tail));</span><br><span class="line">        </span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ListNode* <span class="title">merge</span><span class="params">(ListNode* list1,ListNode* list2)</span></span>&#123;</span><br><span class="line">    ListNode* dummyHead = <span class="keyword">new</span> <span class="built_in">ListNode</span>(<span class="number">0</span>);</span><br><span class="line">    ListNode* pre = dummyHead;</span><br><span class="line">    <span class="keyword">while</span>(list1 &amp;&amp; list2)&#123;</span><br><span class="line">        <span class="keyword">if</span>(list1-&gt;val &lt; list2-&gt;val)&#123;</span><br><span class="line">            pre-&gt;next = list1;</span><br><span class="line">            list1 = list1-&gt;next;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            pre-&gt;next = list2;</span><br><span class="line">            list2 = list2-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        pre = pre-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(list1)&#123;</span><br><span class="line">        pre-&gt;next = list1;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        pre-&gt;next = list2;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dummyHead-&gt;next;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ç®—æ³•ç‰¹ç‚¹-3">ç®—æ³•ç‰¹ç‚¹</h4><ol><li>æ—¶é—´å¤æ‚åº¦å¹³å‡ÎŸ(nlogn),å¯¹äºæ•°ç»„éœ€è¦O(n)çš„ç©ºé—´å¤æ‚åº¦ï¼Œå¯¹äºé“¾è¡¨åªéœ€è¦O(1)</li><li>å¸¸ç”¨äºç»™é“¾è¡¨æ’åº</li><li>å› ä¸ºæˆ‘ä»¬åœ¨é‡åˆ°ç›¸ç­‰çš„æ•°æ®çš„æ—¶å€™å¿…ç„¶æ˜¯æŒ‰é¡ºåºâ€œæŠ„å†™â€åˆ°è¾…åŠ©æ•°ç»„ä¸Šçš„ï¼Œæ‰€ä»¥ï¼Œå½’å¹¶æ’åºåŒæ ·æ˜¯ç¨³å®šç®—æ³•ã€‚</li></ol>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ’åº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ’åºç®—æ³•(ä¸€)â€”â€”å†’æ³¡ã€é€‰æ‹©ã€æ’å…¥</title>
      <link href="/2021/12/07/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%9501/"/>
      <url>/2021/12/07/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%9501/</url>
      
        <content type="html"><![CDATA[<p>æ’åºç®—æ³•æ˜¯æœ€åŸºæœ¬çš„ç®—æ³•ã€‚æ’åºç®—æ³•åˆ†ä¸º<strong>å†…éƒ¨æ’åº</strong>å’Œ<strong>å¤–éƒ¨æ’åº</strong>ã€‚</p><p>å†…éƒ¨æ’åºï¼šæ•°æ®è®°å½•åœ¨å†…å­˜ä¸­è¿›è¡Œæ’åºï¼Œä¸éœ€è¦è®¿é—®å¤–å­˜</p><p>å¤–éƒ¨æ’åºï¼šå› æ’åºçš„æ•°æ®å¾ˆå¤§ï¼Œä¸€æ¬¡ä¸èƒ½å®¹çº³å…¨éƒ¨çš„æ’åºè®°å½•ï¼Œåœ¨æ’åºè¿‡ç¨‹ä¸­éœ€è¦è®¿é—®å¤–å­˜ã€‚</p><p>å¸¸è§çš„å†…éƒ¨æ’åºç®—æ³•æœ‰ï¼šæ’å…¥æ’åºã€å¸Œå°”æ’åºã€é€‰æ‹©æ’åºã€å†’æ³¡æ’åºã€å½’å¹¶æ’åºã€å¿«é€Ÿæ’åºã€å †æ’åºã€åŸºæ•°æ’åºç­‰ã€‚ç”¨ä¸€å¼ å›¾æ¦‚æ‹¬ï¼š</p><p><img src="/img/algorithm/sort.png" alt="æ’åº"></p><p>åè¯è§£é‡Š:</p><ul><li>n æ•°æ®è§„æ¨¡</li><li>k æ¡¶çš„ä¸ªæ•°</li><li>In-place å ç”¨å¸¸æ•°å†…å­˜ï¼Œä¸å ç”¨é¢å¤–å†…å­˜</li><li>Out-place å ç”¨é¢å¤–å†…å­˜</li><li>ç¨³å®šæ€§ æ’åºå 2 ä¸ªç›¸ç­‰é”®å€¼çš„é¡ºåºå’Œæ’åºä¹‹å‰å®ƒä»¬çš„é¡ºåºç›¸åŒ</li></ul><h3 id="å†’æ³¡æ’åº">å†’æ³¡æ’åº</h3><p>å†’æ³¡æ’åºï¼ˆBubble Sortï¼‰æ˜¯ä¸€ç§ç®€å•ç›´è§‚çš„æ’åºç®—æ³•ã€‚å®ƒé‡å¤åœ°èµ°è®¿è¿‡è¦æ’åºçš„æ•°åˆ—ï¼Œä¸€æ¬¡æ¯”è¾ƒä¸¤ä¸ªå…ƒç´ ï¼Œå¦‚æœä»–ä»¬çš„é¡ºåºé”™è¯¯å°±æŠŠä»–ä»¬äº¤æ¢è¿‡æ¥ã€‚èµ°è®¿æ•°åˆ—çš„å·¥ä½œæ˜¯é‡å¤åœ°è¿›è¡Œç›´åˆ°æ²¡æœ‰å†éœ€è¦äº¤æ¢ï¼Œä¹Ÿå°±æ˜¯è¯´è¯¥æ•°åˆ—å·²ç»æ’åºå®Œæˆã€‚è¿™ä¸ªç®—æ³•çš„åå­—ç”±æ¥æ˜¯å› ä¸ºè¶Šå°çš„å…ƒç´ ä¼šç»ç”±äº¤æ¢æ…¢æ…¢&quot;æµ®&quot;åˆ°æ•°åˆ—çš„é¡¶ç«¯ã€‚</p><h4 id="ç®—æ³•æè¿°">ç®—æ³•æè¿°</h4><ol><li>æ¯”è¾ƒç›¸é‚»å…ƒç´ ï¼Œå¦‚æœç¬¬ä¸€ä¸ªæ¯”ç¬¬äºŒä¸ªå¤§ï¼Œåˆ™äº¤æ¢ä»–ä»¬çš„ä½ç½®</li><li>å¯¹æ¯ä¸€å¯¹ç›¸é‚»å…ƒç´ å¯¹åŒæ ·çš„å·¥ä½œï¼Œä»å¼€å§‹ç¬¬ä¸€å¯¹åˆ°ç»“å°¾çš„æœ€åä¸€å¯¹ï¼Œ</li><li>é’ˆå¯¹æ‰€æœ‰å…ƒç´ é‡å¤ä»¥ä¸Šçš„æ­¥éª¤ï¼Œé™¤äº†æœ€åä¸€ä¸ª</li><li>é‡å¤æ­¥éª¤1ï½3,çŸ¥é“æ‰€æœ‰æ’åºå®Œæˆ</li></ol><h4 id="åŠ¨å›¾æ¼”ç¤º">åŠ¨å›¾æ¼”ç¤º</h4><p><img src="/img/algorithm/bubbleSort.gif" alt="å†’æ³¡æ’åº"></p><h4 id="ç®—æ³•å®ç°">ç®—æ³•å®ç°</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bubbleSort</span><span class="params">(<span class="keyword">int</span> arr[],<span class="keyword">int</span> len)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = len<span class="number">-1</span>;i&gt;<span class="number">0</span>;i--)&#123;<span class="comment">// éœ€è¦æ’åºçš„é•¿åº¦ï¼Œå…±len-1æ¬¡å¾ªç¯</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j&lt;i;j++)&#123;<span class="comment">//ä»ç¬¬1ä¸ªå…ƒç´ åˆ°ç¬¬iä¸ªå…ƒç´ </span></span><br><span class="line">          <span class="keyword">if</span>(arr[j]&gt;arr[j+<span class="number">1</span>])</span><br><span class="line">              <span class="built_in">swap</span>(arr[j],arr[j+<span class="number">1</span>]);</span><br><span class="line">        &#125;<span class="comment">//end loop j</span></span><br><span class="line">    &#125;<span class="comment">//end loop i</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ç®—æ³•ç‰¹ç‚¹">ç®—æ³•ç‰¹ç‚¹</h4><ol><li>åœ¨ç›¸é‚»å…ƒç´ ç›¸ç­‰æ—¶ï¼Œå®ƒä»¬å¹¶ä¸ä¼šäº¤æ¢ä½ç½®ï¼Œæ‰€ä»¥ï¼Œå†’æ³¡æ’åºæ˜¯ç¨³å®šæ’åº</li><li>æ¯å®Œæˆä¸€æ¬¡ç¬¬ä¸€å±‚å¾ªç¯ï¼Œä¼šä½¿å¾—å½“å‰éœ€è¦æ’åºçš„æ•°ç»„<code> arr[0]-arr[i]</code>ä¸­æœ€å¤§çš„æ•°è¢«æ”¾ç½®æœ«å°¾ä¸‹æ ‡ä¸º<code>i</code>çš„ä½ç½®</li><li>ç®—æ³•å¤æ‚åº¦æ€»æ˜¯O(n^2)ï¼Œé™¤éæœ‰åºçŠ¶æ€ä¸‹æå‰ç»“æŸï¼Œä¹Ÿéœ€è¦O(n)</li><li>å†’æ³¡æ’åºæ€è·¯ç®€å•ï¼Œä»£ç ä¹Ÿç®€å•ï¼Œç‰¹åˆ«é€‚åˆå°æ•°æ®çš„æ’åºã€‚ä½†æ˜¯ï¼Œç”±äºç®—æ³•å¤æ‚åº¦è¾ƒé«˜ï¼Œåœ¨æ•°æ®é‡å¤§çš„æ—¶å€™ä¸é€‚åˆä½¿ç”¨ã€‚</li></ol><h4 id="ä»£ç ä¼˜åŒ–">ä»£ç ä¼˜åŒ–</h4><p>è¦ä½¿ç®—æ³•åœ¨æœ€ä½³æƒ…å†µä¸‹æœ‰O(n)å¤æ‚åº¦ï¼Œéœ€è¦åšä¸€äº›æ”¹è¿›ï¼Œå¢åŠ ä¸€ä¸ª<code>swap</code>çš„æ ‡å¿—ï¼Œå½“å‰ä¸€è½®æ²¡æœ‰è¿›è¡Œäº¤æ¢æ—¶ï¼Œè¯´æ˜æ•°ç»„å·²ç»æœ‰åºï¼Œæ²¡æœ‰å¿…è¦å†è¿›è¡Œä¸‹ä¸€è½®çš„å¾ªç¯äº†ï¼Œç›´æ¥é€€å‡ºã€‚(æ„ä¹‰ä¸å¤§)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bubbleSort</span><span class="params">(<span class="keyword">int</span> arr[],<span class="keyword">int</span> len)</span></span>&#123;</span><br><span class="line">    <span class="keyword">bool</span> isSwap = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = len<span class="number">-1</span>;i&gt;<span class="number">0</span>;i--)&#123;<span class="comment">// éœ€è¦æ’åºçš„é•¿åº¦ï¼Œå…±len-1æ¬¡å¾ªç¯</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j&lt;i;j++)&#123;<span class="comment">//ä»ç¬¬1ä¸ªå…ƒç´ åˆ°ç¬¬iä¸ªå…ƒç´ </span></span><br><span class="line">            <span class="keyword">if</span>(arr[j]&gt;arr[j+<span class="number">1</span>])&#123;</span><br><span class="line">              <span class="built_in">swap</span>(arr[j],arr[j+<span class="number">1</span>]);</span><br><span class="line">              isSwap = <span class="literal">true</span>;</span><br><span class="line">            &#125;        </span><br><span class="line">        &#125;<span class="comment">//end loop j</span></span><br><span class="line">      <span class="comment">//æ²¡æœ‰äº¤æ¢ï¼Œæå‰ç»“æŸ</span></span><br><span class="line">      <span class="keyword">if</span>(!isSwap)&#123;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;<span class="comment">//end loop i</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é€‰æ‹©æ’åº">é€‰æ‹©æ’åº</h3><p>é€‰æ‹©æ’åºæ˜¯ä¸€ç§ç®€å•ç›´è§‚çš„æ’åºç®—æ³•ï¼Œå®ƒä¹Ÿæ˜¯ä¸€ç§äº¤æ¢æ’åºç®—æ³•ï¼Œå’Œå†’æ³¡æ’åºæœ‰ä¸€å®šçš„ç›¸ä¼¼åº¦ï¼Œå¯ä»¥è®¤ä¸ºé€‰æ‹©æ’åºæ˜¯å†’æ³¡æ’åºçš„ä¸€ç§æ”¹è¿›ã€‚</p><h4 id="ç®—æ³•æè¿°-2">ç®—æ³•æè¿°</h4><ol><li>åœ¨<strong>æœªæ’åº</strong>åºåˆ—ä¸­æ‰¾åˆ°æœ€å°ï¼ˆå¤§ï¼‰å…ƒç´ ï¼Œå­˜æ”¾åˆ°æ’åºåºåˆ—çš„èµ·å§‹ä½ç½®</li><li>ä»å‰©ä½™æœªæ’åºå…ƒç´ ä¸­ç»§ç»­å¯»æ‰¾æœ€å°ï¼ˆå¤§ï¼‰å…ƒç´ ï¼Œç„¶åæ”¾åˆ°<strong>å·²æ’åº</strong>åºåˆ—çš„æœ«å°¾</li><li>é‡å¤ç¬¬äºŒæ­¥ï¼Œç›´åˆ°æ‰€æœ‰å…ƒç´ å‡æ’åºå®Œæ¯•</li></ol><h4 id="åŠ¨å›¾æ¼”ç¤º-2">åŠ¨å›¾æ¼”ç¤º</h4><p><img src="/img/algorithm/selectionSort.gif" alt="é€‰æ‹©æ’åº"></p><h4 id="ç®—æ³•å®ç°-2">ç®—æ³•å®ç°</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">selectionSort</span><span class="params">(<span class="keyword">int</span> arr[],<span class="keyword">int</span> len)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> minIndex;</span><br><span class="line">    <span class="comment">//æœ‰åºåºåˆ— [0,i)</span></span><br><span class="line">    <span class="comment">//æ— åºåºåˆ— [i,len)</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i&lt;len<span class="number">-1</span>;i++)&#123;</span><br><span class="line">        minIndex = i;</span><br><span class="line">        <span class="comment">//å¯»æ‰¾æ— åºåºåˆ—ä¸­ä¸­æœ€å°çš„å…ƒç´ </span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j =i;j&lt;len;j++)</span><br><span class="line">            <span class="keyword">if</span>(arr[j] &lt; arr[min])&#123;</span><br><span class="line">              minIndex = j;</span><br><span class="line">            &#125;      </span><br><span class="line">      <span class="comment">//å°†æœ€å°å€¼ä¸æ— åºåºåˆ—ç¬¬ä¸€ä¸ªå€¼äº¤æ¢</span></span><br><span class="line">      <span class="built_in">swap</span>(arr[minIndex],arr[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ç®—æ³•ç‰¹ç‚¹-2">ç®—æ³•ç‰¹ç‚¹</h4><ol><li>é€‰æ‹©æ’åºå®ç°ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œå¹¶ä¸”ç”±äºåœ¨å„ç§æƒ…å†µä¸‹å¤æ‚åº¦æ³¢åŠ¨å°ï¼Œå› æ­¤ä¸€èˆ¬æ˜¯ä¼˜äºå†’æ³¡æ’åºçš„</li><li>æ•°ç»„å®ç°çš„é€‰æ‹©æ’åºæ˜¯ä¸ç¨³å®šçš„ï¼Œç”¨é“¾è¡¨å®ç°çš„é€‰æ‹©æ’åºæ˜¯ç¨³å®šçš„</li><li>ç®—æ³•å¤æ‚åº¦æ€»æ˜¯O(n^2)</li></ol><h3 id="æ’å…¥æ’åº">æ’å…¥æ’åº</h3><p>æ’å…¥æ’åºæ˜¯ä¸€ç§ç®€å•ç›´è§‚çš„æ’åºç®—æ³•ã€‚å®ƒçš„å·¥ä½œåŸç†æ˜¯é€šè¿‡æ„å»ºæœ‰åºåºåˆ—ï¼Œå¯¹äºæœªæ’åºæ•°æ®ï¼Œåœ¨å·²æ’åºåºåˆ—ä¸­ä»åå‘å‰æ‰«æï¼Œæ‰¾åˆ°ç›¸åº”ä½ç½®å¹¶æ’å…¥</p><h4 id="ç®—æ³•æè¿°-3">ç®—æ³•æè¿°</h4><ol><li>æŠŠå¾…æ’åºçš„æ•°ç»„åˆ†æˆå·²æ’åºå’Œæœªæ’åºä¸¤éƒ¨åˆ†ï¼Œåˆå§‹çš„æ—¶å€™æŠŠç¬¬ä¸€ä¸ªå…ƒç´ è®¤ä¸ºæ˜¯å·²æ’å¥½åºçš„</li><li>ä»ç¬¬äºŒä¸ªå…ƒç´ å¼€å§‹ï¼Œåœ¨å·²æ’å¥½åºçš„å­æ•°ç»„ä¸­å¯»æ‰¾åˆ°è¯¥å…ƒç´ åˆé€‚çš„ä½ç½®å¹¶æ’å…¥è¯¥ä½ç½®</li><li>é‡å¤ä¸Šè¿°è¿‡ç¨‹ç›´åˆ°æœ€åä¸€ä¸ªå…ƒç´ è¢«æ’å…¥æœ‰åºå­æ•°ç»„ä¸­</li></ol><h4 id="åŠ¨å›¾æ¼”ç¤º-3">åŠ¨å›¾æ¼”ç¤º</h4><p><img src="/img/algorithm/insertionSort.gif" alt="æ’å…¥æ’åº"></p><h4 id="ç®—æ³•å®ç°-3">ç®—æ³•å®ç°</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insertionSort</span><span class="params">(<span class="keyword">int</span> arr[],<span class="keyword">int</span> len)</span></span>&#123;</span><br><span class="line">    <span class="comment">//æœ‰åºåºåˆ— [0,iï¼‰</span></span><br><span class="line">    <span class="comment">//æ— åºåºåˆ— [i,len)</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; i++)&#123;</span><br><span class="line">        <span class="comment">//éœ€è¦æ’å…¥çš„å€¼</span></span><br><span class="line">        <span class="keyword">int</span> curVal = arr[i];</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¯»æ‰¾å¯ä»¥æ’å…¥çš„ä½ç½®</span></span><br><span class="line">        <span class="keyword">int</span> pos = i;</span><br><span class="line">        <span class="comment">//é€ä¸ªæ¯”è¾ƒï¼Œè‹¥arr[pos-1]å¤§äºæ’å…¥çš„å€¼åˆ™å‘åç§»åŠ¨</span></span><br><span class="line">        <span class="keyword">while</span>(pos &gt;=<span class="number">1</span> &amp;&amp; arr[pos<span class="number">-1</span>]&gt;curVal)&#123;</span><br><span class="line">            arr[pos] = arr[pos<span class="number">-1</span>];</span><br><span class="line">            pos--;</span><br><span class="line">        &#125;</span><br><span class="line">        arr[pos] = curVal;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ç®—æ³•ç‰¹ç‚¹-3">ç®—æ³•ç‰¹ç‚¹</h4><ol><li>ç”±äºåªéœ€è¦æ‰¾åˆ°ä¸å¤§äºå½“å‰æ•°çš„ä½ç½®è€Œå¹¶ä¸éœ€è¦äº¤æ¢ï¼Œå› æ­¤ï¼Œç›´æ¥æ’å…¥æ’åºæ˜¯ç¨³å®šçš„æ’åºæ–¹æ³•</li><li>ç®—æ³•å¤æ‚åº¦æ€»æ˜¯O(n^2),åœ¨æ•°æ®æ¯”è¾ƒå°‘çš„æ—¶å€™ï¼Œæ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œä¸€èˆ¬åšä¸ºå¿«é€Ÿæ’åºçš„æ‰©å……</li></ol>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ’åº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>dockerå®¹å™¨cronä»»åŠ¡è¯»å–ç¯å¢ƒå˜é‡</title>
      <link href="/2021/11/28/docker%E5%AE%B9%E5%99%A8cron%E4%BB%BB%E5%8A%A1%E8%AF%BB%E5%8F%96%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/"/>
      <url>/2021/11/28/docker%E5%AE%B9%E5%99%A8cron%E4%BB%BB%E5%8A%A1%E8%AF%BB%E5%8F%96%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è¿°">æ¦‚è¿°</h2><p>â€‹å› ä¸º<em>cron</em>ä»éäº¤äº’å¼ã€éç™»å½• shell è¿è¡Œä½œä¸šã€‚æ‰€ä»¥å½“<a href="https://www.baeldung.com/cron-expressions"><em>cron</em></a>æ‰§è¡Œä½œä¸šæ—¶ï¼Œå®ƒä¸ä¼šä»<a href="https://www.baeldung.com/linux/bashrc-vs-bash-profile-vs-profile"><em>~/.bashrc</em></a><a href="https://www.baeldung.com/linux/bashrc-vs-bash-profile-vs-profile">ã€</a><a href="https://www.baeldung.com/linux/bashrc-vs-bash-profile-vs-profile"><em>~/.bash_profile</em></a><a href="https://www.baeldung.com/linux/bashrc-vs-bash-profile-vs-profile">ã€</a><a href="https://www.baeldung.com/linux/bashrc-vs-bash-profile-vs-profile"><em>/etc/profile ç­‰</em></a>æ–‡ä»¶åŠ è½½<a href="https://www.baeldung.com/linux/environment-variables">ç¯å¢ƒå˜é‡</a>ã€‚å½“æˆ‘ä»¬éœ€è¦ä½¿ç”¨å®¹å™¨å†…çš„ç¯å¢ƒå˜é‡ä½œä¸ºå‚æ•°å®šæ—¶è¿è¡Œshellè„šæœ¬æ—¶ï¼Œç”±äºæ— æ³•è¯»å–ç¯å¢ƒå˜é‡å¯¼è‡´è¿è¡Œå¤±è´¥ã€‚</p><p>ä»¥ä¸‹ä¸ºdockerå®¹å™¨çš„è§£å†³æ–¹æ¡ˆ</p><h2 id="è§£å†³æ–¹æ¡ˆ">è§£å†³æ–¹æ¡ˆ</h2><ol><li><p>ä¿å­˜å®¹å™¨ç¯å¢ƒå˜é‡(å¯ä»¥å†™åœ¨entrypointä¸­)</p><p>é€šè¿‡declareå‘½ä»¤å’Œgrepå‘½ä»¤æ•è·ä½ æ‰€éœ€è¦çš„ç¯å¢ƒå˜é‡è‡³/container.envæ–‡ä»¶ä¸­(å½“ç„¶ï¼Œè¿™ä¸ªæ–‡ä»¶ä½ å¯ä»¥éšæ„å®šä¹‰)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">declare -p | gerp -E &#x27;VAR1|VAR2|VAR2&#x27; &gt; /container.env</span><br></pre></td></tr></table></figure></li><li><p>è¿è¡Œæ—¶è½½å…¥ç¯å¢ƒå˜é‡é…ç½®æ–‡ä»¶</p><p>æœ‰ä¸¤ç§æ–¹å¼è½½å…¥ã€‚</p><ol><li><p>é€šè¿‡éœ€è¦æ‰§è¡Œçš„shellè„šæœ¬è½½å…¥ï¼Œåªéœ€åœ¨shellè„šæœ¬å‰åŠ å…¥å³å¯</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> è¯»å–å®¹å™¨è®¾å®šçš„ç¯å¢ƒå˜é‡</span></span><br><span class="line">source /container.env</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>ç›´æ¥åœ¨crontabä¸­è½½å…¥</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SHELL=/bin/bash</span><br><span class="line">BASH_ENV=/container.env</span><br><span class="line">* * * * * root /test-cron.sh</span><br></pre></td></tr></table></figure></li></ol></li></ol><h2 id="cronæ³¨æ„äº‹é¡¹">cronæ³¨æ„äº‹é¡¹</h2><p>ä¸è¦å‡å®šcronçŸ¥é“æ‰€éœ€è¦çš„ç‰¹æ®Šç¯å¢ƒï¼Œå®ƒå…¶å®å¹¶ä¸çŸ¥é“ã€‚æ‰€ä»¥ä½ è¦ä¿è¯åœ¨shelllè„šæœ¬ä¸­æä¾›æ‰€æœ‰å¿…è¦çš„è·¯å¾„å’Œç¯å¢ƒå˜é‡ï¼Œé™¤äº†ä¸€äº›è‡ªåŠ¨è®¾ç½®çš„å…¨å±€å˜é‡</p><ol><li>è„šæœ¬ä¸­æ¶‰åŠæ–‡ä»¶è·¯å¾„æ—¶å†™å…¨å±€è·¯å¾„(å¦‚python é€šè¿‡which python å®šä½å…¶å…¨å±€è·¯å¾„å†å¡«å…¥)</li><li>è„šæœ¬æ‰§è¡Œå…¶ä»–ç¯å¢ƒå˜é‡æ—¶ï¼Œé€šè¿‡sourceå‘½ä»¤å¼•å…¥ç¯å¢ƒå˜é‡</li><li>å½“æ‰‹åŠ¨æ‰§è¡Œè„šæœ¬OKï¼Œä½†æ˜¯crontabæ‰§è¡Œå¤±è´¥æ—¶ã€‚å¾ˆæœ‰å¯èƒ½ç¯å¢ƒå˜é‡å‡ºé—®é¢˜</li></ol>]]></content>
      
      
      <categories>
          
          <category> Docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
            <tag> cron </tag>
            
            <tag> ç¯å¢ƒå˜é‡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼(åäº”)-â€œæ•°æ®ç»“æ„â€æ¨¡å¼</title>
      <link href="/2021/11/22/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F16/"/>
      <url>/2021/11/22/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F16/</url>
      
        <content type="html"><![CDATA[<h1>â€œæ•°æ®ç»“æ„â€æ¨¡å¼</h1><p>å¸¸å¸¸æœ‰ä¸€äº›ç»„ä»¶åœ¨å†…éƒ¨å…·æœ‰ç‰¹å®šçš„æ•°æ®ç»“æ„ï¼Œå¦‚æœè®©å®¢æˆ·ç¨‹åºä¾èµ–è¿™äº›ç‰¹å®šçš„æ•°æ®ç»“æ„ï¼Œå°†æå¤§åœ°ç ´åç»„ä»¶çš„å¤ç”¨ã€‚è¿™æ—¶å€™ï¼Œå°†è¿™äº›ç‰¹å®šæ•°æ®ç»“æ„å°è£…åœ¨å†…éƒ¨ï¼Œåœ¨å¤–éƒ¨æä¾›ç»Ÿä¸€çš„æ¥å£ï¼Œæ¥å®ç°ä¸ç‰¹å®šæ•°æ®ç»“æ„æ— å…³çš„è®¿é—®ï¼Œæ˜¯ä¸€ç§è¡Œä¹‹æœ‰æ•ˆçš„è§£å†³æ–¹æ¡ˆã€‚ä¸»è¦æœ‰ä»¥ä¸‹ä¸‰ç§</p><ol><li>Composite</li><li>Iterator</li><li>Chain of Resposibility</li></ol><h1>Composite</h1><h2 id="è®¾è®¡åŠ¨æœº">è®¾è®¡åŠ¨æœº</h2><ol><li>åœ¨è½¯ä»¶åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå®¢æˆ·ä»£ç è¿‡å¤šåœ°ä¾èµ–äºå¯¹è±¡å®¹å™¨å¤æ‚çš„å†…éƒ¨å®ç°ç»“æ„ï¼Œå¯¹è±¡å®¹å™¨å†…éƒ¨å®ç°ç»“æ„(è€ŒéæŠ½è±¡æ¥å£)çš„å˜åŒ–å°†å¼•èµ·å®¢æˆ·ä»£ç çš„é¢‘ç¹å˜åŒ–ï¼Œå¸¦æ¥äº†ä»£ç çš„ç»´æŠ¤æ€§ã€æ‰©å±•æ€§ç­‰å¼Šç«¯ã€‚</li><li>å¦‚ä½•å°†â€œå®¢æˆ·ä»£ç ä¸å¤æ‚çš„å¯¹è±¡å®¹å™¨ç»“æ„&quot;è§£è€¦?è®©å¯¹è±¡å®¹å™¨è‡ªå·±æ¥å®ç°è‡ªèº«çš„å¤æ‚ç»“æ„ï¼Œä»è€Œä½¿å¾—å®¢æˆ·ä»£ç å°±åƒå¤„ç†ç®€å•å¯¹è±¡ä¸€æ ·æ¥å¤„ç†å¤æ‚çš„å¯¹è±¡å®¹å™¨?</li></ol><h2 id="å®šä¹‰">å®šä¹‰</h2><blockquote><p>å°†å¯¹è±¡ç»„åˆæˆ<strong>æ ‘å½¢ç»“æ„</strong>ä»¥è¡¨ç¤ºâ€œéƒ¨åˆ†-æ•´ä½“â€çš„å±‚æ¬¡ç»“æ„ã€‚Compositeä½¿å¾—ç”¨æˆ·å¯¹å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡çš„ä½¿ç”¨å…·æœ‰ä¸€è‡´æ€§(ç¨³å®š)</p></blockquote><h2 id="ç»“æ„">ç»“æ„</h2><p><img src="/img/PatternDesign/16_01.png" alt="ç»“æ„"></p><h2 id="ä¾‹å­">ä¾‹å­</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Component</span>&#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">process</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">Component</span>()&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//æ ‘èŠ‚ç‚¹</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Composite</span>:</span><span class="keyword">public</span> Component&#123;</span><br><span class="line">    string name;</span><br><span class="line">    list&lt;Component*&gt; elements; <span class="comment">//é€šå¸¸ä¿å­˜å¶å­ç»“ç‚¹</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Composite</span>(<span class="keyword">const</span> string&amp; s):<span class="built_in">name</span>(s)&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(Component* element)</span></span>&#123;</span><br><span class="line">        elements.<span class="built_in">push_back</span>(element);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">remove</span><span class="params">(Component* element)</span></span>&#123;</span><br><span class="line">        elements.<span class="built_in">remove</span>(element);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">process</span><span class="params">()</span> <span class="keyword">override</span></span>&#123;</span><br><span class="line">        <span class="comment">//1. å¤„ç†å½“å‰ç»“ç‚¹</span></span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.å¤„ç†å¶å­ç»“ç‚¹</span></span><br><span class="line">        <span class="comment">//å¤šæ€è°ƒç”¨</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span>&amp; e : elements)&#123;</span><br><span class="line">            e-&gt;<span class="built_in">process</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¶å­ç»“ç‚¹</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Leaf</span>:</span><span class="keyword">public</span> Component&#123;</span><br><span class="line">    string name;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Leaf</span>(<span class="keyword">const</span> string&amp; s):<span class="built_in">name</span>(s)&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">process</span><span class="params">()</span> <span class="keyword">override</span></span>&#123;</span><br><span class="line">        <span class="comment">//å¤„ç†å½“å‰ç»“ç‚¹</span></span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä½¿ç”¨</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Invoke</span><span class="params">(Component&amp; c)</span></span>&#123;</span><br><span class="line">    <span class="comment">//å°†ä¸€å¯¹å¤šè½¬åŒ–ä¸ºä¸€å¯¹ä¸€çš„å…³ç³»</span></span><br><span class="line">    c.<span class="built_in">process</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="function">Composite <span class="title">root</span><span class="params">(<span class="string">&quot;root&quot;</span>)</span></span>;</span><br><span class="line">    <span class="function">Composite <span class="title">treeNode1</span><span class="params">(<span class="string">&quot;treeNode1&quot;</span>)</span></span>;</span><br><span class="line">    <span class="function">Composite <span class="title">treeNode2</span><span class="params">(<span class="string">&quot;treeNode2&quot;</span>)</span></span>;</span><br><span class="line">    <span class="function">Composite <span class="title">treeNode3</span><span class="params">(<span class="string">&quot;treeNode3&quot;</span>)</span></span>;</span><br><span class="line">    <span class="function">Leaf <span class="title">leaf1</span><span class="params">(<span class="string">&quot;leaf1&quot;</span>)</span></span></span><br><span class="line"><span class="function">    Leaf <span class="title">leaf2</span><span class="params">(<span class="string">&quot;leaf2&quot;</span>)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    root.<span class="title">add</span><span class="params">(&amp;treeNode1)</span></span>;</span><br><span class="line">    treeNode1.<span class="built_in">add</span>(&amp;treeNode2);</span><br><span class="line">    treeNode1.<span class="built_in">add</span>(&amp;treeNode3);</span><br><span class="line">    treeNode2.<span class="built_in">add</span>(&amp;leaf1);</span><br><span class="line">    treeNode3.<span class="built_in">add</span>(&amp;leaf2);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Invokeå¤„ç†ä¸€è‡´æ€§</span></span><br><span class="line">    <span class="built_in">Invoke</span>(root);</span><br><span class="line">    <span class="built_in">Invoke</span>(treeNode1);</span><br><span class="line">    <span class="built_in">Invoke</span>(leaf1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“">æ€»ç»“</h2><ol><li>Compositeæ¨¡å¼é‡‡ç”¨æ ‘å½¢ç»“æ„æ¥å®ç°æ™®éå­˜åœ¨çš„å¯¹è±¡å®¹å™¨ï¼Œä»è€Œå°†â€˜ä¸€å¯¹å¤šâ€çš„å…³ç³»è½¬åŒ–ä¸ºâ€œä¸€å¯¹ä¸€â€çš„å…³ç³»ï¼Œä½¿å¾—å®¢æˆ·ä»£ç å¯ä»¥ä¸€è‡´åœ°(å¤ç”¨)å¤„ç†å¯¹è±¡å’Œå¯¹è±¡å®¹å™¨ï¼Œæ— éœ€å…³å¿ƒå¤„ç†çš„æ˜¯å•ä¸ªçš„å¯¹è±¡ï¼Œè¿˜æ˜¯ç»„åˆçš„å¯¹è±¡å®¹å™¨ã€‚</li><li>å°†â€œå®¢æˆ·ä»£ç ä¸å¤æ‚çš„å¯¹è±¡å®¹å™¨ç»“æ„â€è§£è€¦æ˜¯Compositeçš„æ ¸å¿ƒæ€æƒ³ï¼Œè§£è€¦ä¹‹åï¼Œå®¢æˆ·ä»£ç å°†ä¸çº¯ç²¹çš„æŠ½è±¡æ¥å£ä¸€è€Œéå¯¹è±¡å®¹å™¨çš„å†…éƒ¨å®ç°ç»“æ„ä¸€å‘ç”Ÿä¾èµ–ï¼Œä»è€Œæ›´èƒ½â€œåº”å¯¹å˜åŒ–â€ã€‚</li><li>Compositeæ¨¡å¼åœ¨å…·ä½“å®ç°ä¸­ï¼Œå¯ä»¥è®©çˆ¶å¯¹è±¡ä¸­çš„å­å¯¹è±¡åå‘è¿½æº¯;å¦‚æœçˆ¶å¯¹è±¡æœ‰é¢‘ç¹çš„éå†éœ€æ±‚ï¼Œå¯ä½¿ç”¨ç¼“å­˜æŠ€å·§æ¥æ”¹å–„æ•ˆç‡ã€‚</li></ol><h1>Iterator</h1><h2 id="è®¾è®¡åŠ¨æœº-2">è®¾è®¡åŠ¨æœº</h2><ol><li>åœ¨è½¯ä»¶æ„å»ºè¿‡ç¨‹ä¸­ï¼Œé›†åˆå¯¹è±¡å†…éƒ¨ç»“æ„å¸¸å¸¸å˜åŒ–å„å¼‚ã€‚ä½†å¯¹äºè¿™äº›é›†åˆå¯¹è±¡ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨ä¸æš´éœ²å…¶å†…éƒ¨ç»“æ„çš„åŒæ—¶ï¼Œå¯ä»¥è®©å¤–éƒ¨å®¢æˆ·ä»£ç é€æ˜åœ°è®¿é—®å…¶ä¸­åŒ…å«çš„å…ƒç´ ;åŒæ—¶è¿™ç§â€œé€æ˜éå†â€ä¹Ÿä¸ºâ€œåŒä¸€ç§ç®—æ³•åœ¨å¤šç§é›†åˆå¯¹è±¡ä¸Šè¿›è¡Œæ“ä½œâ€™â€™æä¾›äº†å¯èƒ½ã€‚</li><li>ä½¿ç”¨é¢å‘å¯¹è±¡æŠ€æœ¯å°†è¿™ç§éå†æœºåˆ¶æŠ½è±¡ä¸ºâ€œè¿­ä»£å™¨å¯¹è±¡â€ä¸ºâ€œåº”å¯¹å˜åŒ–ä¸­çš„é›†åˆå¯¹è±¡â€æä¾›äº†ä¸€ç§ä¼˜é›…çš„æ–¹å¼ã€‚</li></ol><h2 id="å®šä¹‰-2">å®šä¹‰</h2><blockquote><p>æä¾›ä¸€ç§æ–¹æ³•é¡ºåºè®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡ä¸­çš„å„ä¸ªå…ƒç´ ï¼Œè€Œåˆä¸æš´éœ²(ç¨³å®š)è¯¥å¯¹è±¡çš„å†…éƒ¨è¡¨ç¤ºã€‚</p></blockquote><h2 id="ç»“æ„-2">ç»“æ„</h2><p><img src="/img/PatternDesign/16_02.png" alt="ç»“æ„"></p><h2 id="æ€»ç»“-2">æ€»ç»“</h2><ol><li>åœ¨å¦‚ä»Šæ‹¥æœ‰STLå’Œæ³›å‹ç¼–ç¨‹çš„c++è¯­è¨€è¿™ç§æ¨¡å¼å·²è¢«å¼ƒç”¨(é¢å¯¹å¯¹è±¡çš„è¿­ä»£å™¨æ€§èƒ½æŸè€—é«˜),java,c#ä¼šç”¨åˆ°</li><li>è¿­ä»£æŠ½è±¡:è®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡çš„å†…å®¹è€Œæ— éœ€æš´éœ²å®ƒçš„å†…éƒ¨è¡¨ç¤ºã€‚</li><li>è¿­ä»£å¤šæ€:ä¸ºéå†ä¸åŒçš„é›†åˆç»“æ„æä¾›ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£ï¼Œä»è€Œæ”¯æŒåŒæ ·çš„ç®—æ³•åœ¨ä¸åŒçš„é›†åˆç»“æ„.ä¸Šè¿›è¡Œæ“ä½œã€‚</li><li>è¿­ä»£å™¨çš„å¥å£®æ€§è€ƒè™‘:éå†çš„åŒæ—¶æ›´æ”¹è¿­ä»£å™¨æ‰€åœ¨çš„é›†åˆç»“æ„ï¼Œä¼šå¯¼è‡´é—®é¢˜ã€‚</li></ol><h1>Chain of responsibility</h1><h2 id="è®¾è®¡åŠ¨æœº-3">è®¾è®¡åŠ¨æœº</h2><ol><li>åœ¨è½¯ä»¶æ„å»ºè¿‡ç¨‹ä¸­ï¼Œä¸€ä¸ªè¯·æ±‚å¯èƒ½è¢«å¤šä¸ªå¯¹è±¡å¤„ç†ï¼Œä½†æ˜¯æ¯ä¸ªè¯·æ±‚åœ¨è¿è¡Œæ—¶åªèƒ½æœ‰ä¸€ä¸ªæ¥å—è€…ï¼Œå¦‚æœæ˜¾å¼æŒ‡å®šï¼Œå°†å¿…ä¸å¯å°‘åœ°å¸¦æ¥è¯·æ±‚å‘é€è€…ä¸æ¥å—è€…çš„ç´§è€¦åˆã€‚<br>2.å¦‚ä½•ä½¿è¯·æ±‚çš„å‘é€è€…ä¸éœ€è¦æŒ‡å®šå…·ä½“çš„æ¥å—è€…?è®©è¯·æ±‚çš„æ¥å—è€…è‡ªå·±åœ¨è¿è¡Œæ—¶å†³å®šæ¥å¤„ç†è¯·æ±‚ï¼Œä»è€Œä½¿ä¸¤è€…è§£è€¦ã€‚</li></ol><h2 id="å®šä¹‰-3">å®šä¹‰</h2><blockquote><p>ä½¿å¤šä¸ªå¯¹è±¡éƒ½æœ‰æœºä¼šå¤„ç†è¯·æ±‚ï¼Œä»è€Œé¿å…è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…ä¹‹é—´çš„è€¦åˆå…³ç³»ã€‚å°†è¿™äº›å¯¹è±¡è¿æˆä¸€æ¡é“¾ï¼Œå¹¶æ²¿ç€è¿™æ¡é“¾ä¼ é€’è¯·æ±‚ï¼Œç›´åˆ°æœ‰ä¸€ä¸ªå¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚</p></blockquote><h2 id="ç»“æ„-3">ç»“æ„</h2><p><img src="/img/PatternDesign/16_03.png" alt="ç»“æ„"></p><h2 id="ä¾‹å­-2">ä¾‹å­</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="keyword">class</span> <span class="title">RequestType</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    REQ_HANDLER1,</span><br><span class="line">    REQ_HANDLER2,</span><br><span class="line">    REQ_HANDLER3</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Reqest</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    string description;</span><br><span class="line">    RequestType reqType;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Reqest</span>(<span class="keyword">const</span> string &amp; desc, RequestType type) : <span class="built_in">description</span>(desc), <span class="built_in">reqType</span>(type) &#123;&#125;</span><br><span class="line">    <span class="function">RequestType <span class="title">getReqType</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> reqType; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">const</span> string&amp; <span class="title">getDescription</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> description; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ChainHandler</span>&#123;</span></span><br><span class="line">    </span><br><span class="line">    ChainHandler *nextChain;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">sendReqestToNextHandler</span><span class="params">(<span class="keyword">const</span> Reqest &amp; req)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (nextChain != <span class="literal">nullptr</span>)</span><br><span class="line">            nextChain-&gt;<span class="built_in">handle</span>(req);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">bool</span> <span class="title">canHandleRequest</span><span class="params">(<span class="keyword">const</span> Reqest &amp; req)</span> </span>= <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">processRequest</span><span class="params">(<span class="keyword">const</span> Reqest &amp; req)</span> </span>= <span class="number">0</span>;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">ChainHandler</span>() &#123; nextChain = <span class="literal">nullptr</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setNextChain</span><span class="params">(ChainHandler *next)</span> </span>&#123; nextChain = next; &#125;</span><br><span class="line">    </span><br><span class="line">   </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">handle</span><span class="params">(<span class="keyword">const</span> Reqest &amp; req)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">canHandleRequest</span>(req))</span><br><span class="line">            <span class="built_in">processRequest</span>(req);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">sendReqestToNextHandler</span>(req);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Handler1</span> :</span> <span class="keyword">public</span> ChainHandler&#123;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">canHandleRequest</span><span class="params">(<span class="keyword">const</span> Reqest &amp; req)</span> <span class="keyword">override</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> req.<span class="built_in">getReqType</span>() == RequestType::REQ_HANDLER1;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">processRequest</span><span class="params">(<span class="keyword">const</span> Reqest &amp; req)</span> <span class="keyword">override</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Handler1 is handle reqest: &quot;</span> &lt;&lt; req.<span class="built_in">getDescription</span>() &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">        </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Handler2</span> :</span> <span class="keyword">public</span> ChainHandler&#123;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">canHandleRequest</span><span class="params">(<span class="keyword">const</span> Reqest &amp; req)</span> <span class="keyword">override</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> req.<span class="built_in">getReqType</span>() == RequestType::REQ_HANDLER2;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">processRequest</span><span class="params">(<span class="keyword">const</span> Reqest &amp; req)</span> <span class="keyword">override</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Handler2 is handle reqest: &quot;</span> &lt;&lt; req.<span class="built_in">getDescription</span>() &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Handler3</span> :</span> <span class="keyword">public</span> ChainHandler&#123;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">canHandleRequest</span><span class="params">(<span class="keyword">const</span> Reqest &amp; req)</span> <span class="keyword">override</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> req.<span class="built_in">getReqType</span>() == RequestType::REQ_HANDLER3;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">processRequest</span><span class="params">(<span class="keyword">const</span> Reqest &amp; req)</span> <span class="keyword">override</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Handler3 is handle reqest: &quot;</span> &lt;&lt; req.<span class="built_in">getDescription</span>() &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    Handler1 h1;</span><br><span class="line">    Handler2 h2;</span><br><span class="line">    Handler3 h3;</span><br><span class="line">    h1.<span class="built_in">setNextChain</span>(&amp;h2);</span><br><span class="line">    h2.<span class="built_in">setNextChain</span>(&amp;h3);</span><br><span class="line">    </span><br><span class="line">    <span class="function">Reqest <span class="title">req</span><span class="params">(<span class="string">&quot;process task ... &quot;</span>, RequestType::REQ_HANDLER3)</span></span>;</span><br><span class="line">    h1.<span class="built_in">handle</span>(req);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“-3">æ€»ç»“</h2><ol><li>Chain of Responsibilityæ¨¡å¼çš„åº”ç”¨åœºåˆåœ¨äºâ€œä¸€ä¸ªè¯·æ±‚å¯èƒ½æœ‰å¤šä¸ªæ¥å—è€…ï¼Œä½†æ˜¯æœ€åçœŸæ­£çš„æ¥å—è€…åªæœ‰ä¸€ä¸ªâ€ï¼Œè¿™æ—¶å€™è¯·æ±‚å‘é€è€…ä¸æ¥å—è€…çš„è€¦åˆæœ‰å¯èƒ½å‡ºç°â€œå˜åŒ–è„†å¼±â€çš„ç—‡çŠ¶ï¼ŒèŒè´£é“¾çš„ç›®çš„å°±æ˜¯å°†äºŒè€…è§£è€¦ï¼Œä»è€Œæ›´å¥½åœ°åº”å¯¹å˜åŒ–ã€‚</li><li>åº”ç”¨äº†Chain of Responsibilityæ¨¡å¼åï¼Œå¯¹è±¡çš„èŒè´£åˆ†æ´¾å°†æ›´å…·çµæ´»æ€§ã€‚æˆ‘ä»¬å¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€æ·»åŠ /ä¿®æ”¹è¯·æ±‚çš„å¤„ç†èŒè´£ã€‚</li><li>å¦‚æœè¯·æ±‚ä¼ é€’åˆ°èŒè´£é“¾çš„æœ«å°¾ä»å¾—ä¸åˆ°å¤„ç†ï¼Œåº”è¯¥æœ‰ä¸€ä¸ªåˆç†çš„ç¼ºçœæœºåˆ¶ã€‚è¿™ä¹Ÿæ˜¯æ¯ä¸€ä¸ªæ¥å—å¯¹è±¡çš„è´£ä»»ï¼Œè€Œä¸æ˜¯å‘å‡ºè¯·æ±‚çš„å¯¹è±¡çš„è´£ä»»ã€‚</li></ol>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼(åå››)-Memento</title>
      <link href="/2021/11/17/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F15/"/>
      <url>/2021/11/17/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F15/</url>
      
        <content type="html"><![CDATA[<h2 id="è®¾è®¡åŠ¨æœº">è®¾è®¡åŠ¨æœº</h2><ol><li>åœ¨è½¯ä»¶æ„å»ºè¿‡ç¨‹ä¸­ï¼ŒæŸäº›å¯¹è±¡çš„çŠ¶æ€åœ¨è½¬æ¢è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ç”±äºæŸç§éœ€è¦ï¼Œè¦æ±‚ç¨‹åºèƒ½å¤Ÿå›æº¯åˆ°å¯¹è±¡ä¹‹å‰å¤„äºæŸä¸ªç‚¹æ—¶çš„çŠ¶æ€ã€‚å¦‚æœä½¿ç”¨ä¸€äº›å…¬æœ‰æ¥å£æ¥è®©å…¶ä»–å¯¹è±¡å¾—åˆ°å¯¹è±¡çš„çŠ¶æ€ï¼Œä¾¿ä¼šæš´éœ²å¯¹è±¡çš„ç»†èŠ‚å®ç°ã€‚</li><li>å¦‚ä½•å®ç°å¯¹è±¡çŠ¶æ€çš„è‰¯å¥½ä¿å­˜ä¸æ¢å¤?ä½†åŒæ—¶åˆä¸ä¼šå› æ­¤è€Œç ´åå¯¹è±¡æœ¬èº«çš„å°è£…æ€§ã€‚</li></ol><h2 id="å®šä¹‰">å®šä¹‰</h2><blockquote><p>åœ¨ä¸ç ´åå°è£…æ€§çš„å‰æä¸‹ï¼Œæ•è·ä¸€ä¸ªå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œå¹¶åœ¨è¯¥å¯¹è±¡ä¹‹å¤–ä¿å­˜è¿™ä¸ªçŠ¶æ€ã€‚è¿™æ ·ä»¥åå°±å¯ä»¥å°†è¯¥å¯¹è±¡æ¢å¤åˆ°åŸå…ˆä¿å­˜çš„çŠ¶æ€ã€‚</p></blockquote><h2 id="ç»“æ„">ç»“æ„</h2><p><img src="/img/PatternDesign/15_01.png" alt="ç»“æ„"></p><h2 id="ä¾‹å­">ä¾‹å­</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  çŠ¶æ€å¿«ç…§</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Memento</span>&#123;</span></span><br><span class="line">    string state;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Memento</span>(<span class="keyword">const</span> string&amp; s):<span class="built_in">state</span>(s)&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">string <span class="title">getState</span><span class="params">()</span><span class="keyword">const</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> state;</span><br><span class="line">    &#125;    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setState</span><span class="params">(<span class="keyword">const</span> string&amp; s)</span></span>&#123;</span><br><span class="line">        state = s;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Originator</span>&#123;</span></span><br><span class="line">    string state;</span><br><span class="line">    <span class="comment">//</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Originator</span>()&#123;&#125;</span><br><span class="line">    Memento createMemento&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Memento</span>(state);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setMemento</span><span class="params">(Memento memento)</span></span>&#123;</span><br><span class="line">        state = memento.<span class="built_in">getState</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    Originator originator;</span><br><span class="line">    <span class="comment">//æ•è·å¯¹è±¡çŠ¶æ€ï¼Œå­˜å‚¨å¿«ç…§</span></span><br><span class="line">    Memento m = originator.<span class="built_in">createMemento</span>();</span><br><span class="line">    <span class="comment">//æ¢å¤å¿«ç…§</span></span><br><span class="line">    originator.<span class="built_in">setMemento</span>(m);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“">æ€»ç»“</h2><ol><li>å¤‡å¿˜å½•(Memento)å­˜å‚¨åŸå‘å™¨(Originator)å¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œåœ¨éœ€è¦æ—¶æ¢å¤åŸå‘å™¨çŠ¶æ€ã€‚</li><li>Mementoæ¨¡å¼çš„æ ¸å¿ƒæ˜¯ä¿¡æ¯éšè—ï¼Œå³Originatoréœ€è¦å‘å¤–æ¥éšè—ä¿¡æ¯ï¼Œä¿æŒå…¶å°è£…æ€§ã€‚ä½†åŒæ—¶åˆéœ€è¦å°†çŠ¶æ€ä¿æŒåˆ°å¤–ç•Œ(Memento) ã€‚</li><li>ç”±äºç°ä»£è¯­è¨€è¿è¡Œæ—¶ï¼ˆå¦‚C#ã€Javaç­‰ï¼‰éƒ½å…·æœ‰ç›¸å½“çš„å¯¹è±¡åºåˆ—åŒ–æ”¯æŒï¼Œå› æ­¤å¾€å¾€é‡‡ç”¨æ•ˆç‡è¾ƒé«˜ã€åˆè¾ƒå®¹æ˜“æ­£ç¡®å®ç°çš„åºåˆ—åŒ–æ–¹æ¡ˆæ¥ä¹°ç°Mementoæ¨¡å¼ã€‚</li></ol><h2 id="çŠ¶æ€å˜åŒ–-æ¨¡å¼">&quot;çŠ¶æ€å˜åŒ–&quot;æ¨¡å¼</h2><blockquote><p>åœ¨ç»„ä»¶æ„å»ºè¿‡ç¨‹ä¸­ï¼ŒæŸäº›å¯¹è±¡çš„çŠ¶æ€ç»å¸¸é¢ä¸´å˜åŒ–ï¼Œå¦‚ä½•å¯¹è¿™äº›å˜åŒ–è¿›è¡Œæœ‰æ•ˆçš„ç®¡ç†?åŒæ—¶åˆç»´æŒé«˜å±‚æ¨¡å—çš„ç¨³å®š?â€œçŠ¶æ€å˜åŒ–&quot;æ¨¡å¼ä¸ºè¿™ä¸€é—®é¢˜æä¾›äº†ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚</p></blockquote><h3 id="å…¸å‹æ¨¡å¼">å…¸å‹æ¨¡å¼</h3><ol><li><a href="/2021/11/16/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F14/">State</a></li><li><a href="/2021/11/17/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F15/">Memento</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼(åä¸‰)-State</title>
      <link href="/2021/11/16/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F14/"/>
      <url>/2021/11/16/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F14/</url>
      
        <content type="html"><![CDATA[<h2 id="è®¾è®¡åŠ¨æœº">è®¾è®¡åŠ¨æœº</h2><ol><li>åœ¨è½¯ä»¶æ„å»ºè¿‡ç¨‹ä¸­ï¼ŒæŸäº›å¯¹è±¡çš„çŠ¶æ€å¦‚æœæ”¹å˜ï¼Œå…¶è¡Œä¸ºä¹Ÿä¼šéšä¹‹ï¼Œè€Œå‘ç”Ÿå˜åŒ–ï¼Œæ¯”å¦‚æ–‡æ¡£å¤„äºåªè¯»çŠ¶æ€ï¼Œå…¶æ”¯æŒçš„è¡Œä¸ºå’Œè¯»å†™çŠ¶æ€æ”¯æŒçš„è¡Œä¸ºå°±å¯èƒ½å®Œå…¨ä¸åŒã€‚</li><li>å¦‚ä½•åœ¨è¿è¡Œæ—¶æ ¹æ®å¯¹è±¡çš„çŠ¶æ€æ¥é€æ˜åœ°æ›´æ”¹å¯¹è±¡çš„è¡Œä¸º?è€Œä¸ä¼šä¸ºå¯¹è±¡æ“ä½œå’ŒçŠ¶æ€è½¬åŒ–ä¹‹é—´å¼•å…¥ç´§è€¦åˆ?</li></ol><h2 id="å®šä¹‰">å®šä¹‰</h2><blockquote><p>å…è®¸ä¸€ä¸ªå¯¹è±¡åœ¨å…¶å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶æ”¹å˜å®ƒçš„è¡Œä¸ºã€‚ä»è€Œä½¿å¯¹è±¡çœ‹èµ·æ¥ä¼¼ä¹ä¿®æ”¹äº†å…¶è¡Œä¸ºã€‚</p></blockquote><h2 id="ç»“æ„">ç»“æ„</h2><p><img src="/img/PatternDesign/14_01.png" alt="ç»“æ„"></p><h2 id="ä¾‹å­">ä¾‹å­</h2><h3 id="ä¼ ç»Ÿ">ä¼ ç»Ÿ</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">NetworkState</span>&#123;</span></span><br><span class="line">    NetworkOpen,</span><br><span class="line">    NetworkClose,</span><br><span class="line">    NetworkConnect,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NetworkProcess</span>&#123;</span></span><br><span class="line">    NetworkState state;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">operator1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(state == NetworkOpen)&#123;</span><br><span class="line">            <span class="comment">//do something</span></span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">             *******</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">            <span class="comment">//state change</span></span><br><span class="line">            state  = NetworkClose;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(state == NetworkClose)&#123;</span><br><span class="line">            <span class="comment">//do something</span></span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">             *******</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">            <span class="comment">//state change</span></span><br><span class="line">            state  = NetworkConnect;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(state == NetworkConnect)&#123;</span><br><span class="line">            <span class="comment">//do something</span></span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">             *******</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">            <span class="comment">//state change</span></span><br><span class="line">            state  = NetworkOpen;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">operator2</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(state == NetworkOpen)&#123;</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">             *******</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(state == NetworkClose)&#123;</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">             *******</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">            state  = NetworkConnect;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(state == NetworkConnect)&#123;</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">             *******</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">            state  = NetworkOpen;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="çŠ¶æ€æ¨¡å¼">çŠ¶æ€æ¨¡å¼</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OpenState</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CloseState</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConnectState</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NetworkState</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    NetworkState* pNext; <span class="comment">//next state</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//æä¾›æ¥å£ï¼Œç­‰å¾…å­ç±»é‡å†™</span></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">operator1</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">operator2</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">NetworkState</span>()&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å¼€å¯çŠ¶æ€</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OpenState</span>:</span><span class="keyword">public</span> NetworkState&#123;</span><br><span class="line">    <span class="comment">//å•ä¾‹ï¼Œåªæœ‰ä¸€ä¸ªçŠ¶æ€å®ä¾‹</span></span><br><span class="line">    <span class="keyword">static</span> NetworkState* m_instance;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">static</span> NetworkState* <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(m_instance == <span class="literal">nullptr</span>)&#123;</span><br><span class="line">            m_instance = <span class="keyword">new</span> <span class="built_in">OpenState</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> m_instance;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">operator1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//do something</span></span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">             *******</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">        <span class="comment">//state change</span></span><br><span class="line">        pNext  = CloseState::<span class="built_in">getInstance</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å…³é—­çŠ¶æ€</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CloseState</span>:</span><span class="keyword">public</span> NetworkState&#123;</span><br><span class="line">    <span class="comment">//å•ä¾‹ï¼Œåªæœ‰ä¸€ä¸ªçŠ¶æ€å®ä¾‹</span></span><br><span class="line">    <span class="keyword">static</span> NetworkState* m_instance;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">static</span> NetworkState* <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(m_instance == <span class="literal">nullptr</span>)&#123;</span><br><span class="line">            m_instance = <span class="keyword">new</span> <span class="built_in">CloseState</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> m_instance;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">operator1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//do something</span></span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">             *******</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">        <span class="comment">//state change</span></span><br><span class="line">        pNext  = ConnectState::<span class="built_in">getInstance</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¿æ¥çŠ¶æ€</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConnectState</span>:</span><span class="keyword">public</span> NetworkState&#123;</span><br><span class="line">    <span class="comment">//å•ä¾‹ï¼Œåªæœ‰ä¸€ä¸ªçŠ¶æ€å®ä¾‹</span></span><br><span class="line">    <span class="keyword">static</span> NetworkState* m_instance;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">static</span> NetworkState* <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(m_instance == <span class="literal">nullptr</span>)&#123;</span><br><span class="line">            m_instance = <span class="keyword">new</span> <span class="built_in">ConnectState</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> m_instance;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">operator1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//do something</span></span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">             *******</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">        <span class="comment">//state change</span></span><br><span class="line">        pNext  = OpenState::<span class="built_in">getInstance</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">NetworkState* OpenState::m_instance = <span class="literal">nullptr</span>;</span><br><span class="line">NetworkState* CloseState::m_instance = <span class="literal">nullptr</span>;</span><br><span class="line">NetworkState* ConnectState::m_instance = <span class="literal">nullptr</span>;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä½¿ç”¨</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NetworkProcessor</span>&#123;</span></span><br><span class="line">    NetworkState* pState;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="built_in">NetworkProcessor</span>(NetworkState* state):<span class="built_in">pState</span>(state)&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">operator1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">        pState-&gt;<span class="built_in">operator1</span>();</span><br><span class="line">        pState = pState-&gt;pNext;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“">æ€»ç»“</h2><ol><li>Stateæ¨¡å¼å°†æ‰€æœ‰ä¸ä¸€ä¸ªç‰¹å®šçŠ¶æ€ç›¸å…³çš„è¡Œä¸ºéƒ½æ”¾å…¥ä¸€ä¸ªStateçš„å­ç±»å¯¹è±¡ä¸­ï¼Œåœ¨å¯¹è±¡çŠ¶æ€åˆ‡æ¢æ—¶ï¼Œåˆ‡æ¢ç›¸åº”çš„å¯¹è±¡;ä½†åŒæ—¶ç»´æŒStateçš„æ¥å£ï¼Œè¿™æ ·å®ç°äº†å…·ä½“æ“ä½œä¸çŠ¶æ€è½¬æ¢ä¹‹é—´çš„è§£è€¦ã€‚</li><li>ä¸ºä¸åŒçš„çŠ¶æ€å¼•å…¥ä¸åŒçš„å¯¹è±¡ä½¿å¾—çŠ¶æ€è½¬æ¢å˜å¾—æ›´åŠ æ˜ç¡®ï¼Œè€Œä¸”å¯ä»¥ä¿è¯ä¸ä¼šå‡ºç°çŠ¶æ€ä¸ä¸€è‡´çš„æƒ…å†µï¼Œå› ä¸ºè½¬æ¢æ˜¯åŸå­æ€§çš„â€”â€”å³è¦ä¹ˆå½»åº•è½¬æ¢è¿‡æ¥ï¼Œè¦ä¹ˆä¸è½¬æ¢ã€‚</li><li>å¦‚æœStateå¯¹è±¡æ²¡æœ‰å®ä¾‹å˜é‡ï¼Œé‚£ä¹ˆå„ä¸ªä¸Šä¸‹æ–‡å¯ä»¥å…±äº«åŒä¸€ä¸ªStateå¯¹è±¡ï¼Œä»è€ŒèŠ‚çœå¯¹è±¡å¼€é”€ã€‚</li></ol>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼(åäºŒ)-Mediator</title>
      <link href="/2021/11/15/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F13/"/>
      <url>/2021/11/15/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F13/</url>
      
        <content type="html"><![CDATA[<h2 id="è®¾è®¡åŠ¨æœº">è®¾è®¡åŠ¨æœº</h2><ol><li>åœ¨è½¯ä»¶æ„å»ºè¿‡ç¨‹ä¸­ï¼Œç»å¸¸ä¼šå‡ºç°å¤šä¸ªå¯¹è±¡äº’ç›¸å…³è”äº¤äº’çš„æƒ…å†µï¼Œå¯¹è±¡ä¹‹é—´å¸¸å¸¸ä¼šç»´æŒä¸€ç§å¤æ‚çš„å¼•ç”¨å…³ç³»ï¼Œå¦‚æœé‡åˆ°ä¸€äº›éœ€æ±‚çš„æ›´æ”¹ï¼Œè¿™ç§ç›´æ¥çš„å¼•ç”¨å…³ç³»å°†é¢ä¸´ä¸æ–­çš„å˜åŒ–ã€‚</li><li>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä½¿ç”¨ä¸€ä¸ªâ€œä¸­ä»‹å¯¹è±¡&quot;æ¥ç®¡ç†å¯¹è±¡é—´çš„å…³è”å…³ç³»ï¼Œé¿å…ç›¸äº’äº¤äº’çš„å¯¹è±¡ä¹‹é—´çš„ç´§è€¦åˆå¼•ç”¨å…³ç³»ï¼Œä»è€Œæ›´å¥½åœ°æŠµå¾¡å˜åŒ–ã€‚</li></ol><h2 id="å®šä¹‰">å®šä¹‰</h2><blockquote><p>ç”¨ä¸€ä¸ªä¸­ä»‹å¯¹è±¡æ¥å°è£…(å°è£…å˜åŒ–)ä¸€ç³»åˆ—çš„å¯¹è±¡äº¤äº’ã€‚ä¸­ä»‹è€…ä½¿å„å¯¹è±¡ä¸éœ€è¦æ˜¾å¼çš„ç›¸äº’å¼•ç”¨(ç¼–è¯‘æ—¶ä¾èµ–â†’è¿è¡Œæ—¶ä¾èµ–)ï¼Œä»è€Œä½¿å…¶è€¦åˆæ¾æ•£(ç®¡ç†å˜åŒ–)ï¼Œè€Œä¸”å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜å®ƒä»¬ä¹‹é—´çš„äº¤äº’ã€‚</p></blockquote><h2 id="ç»“æ„">ç»“æ„</h2><p><img src="/img/PatternDesign/13_01.png" alt="ç»“æ„"></p><h2 id="æ€»ç»“">æ€»ç»“</h2><ol><li>å°†å¤šä¸ªå¯¹è±¡é—´å¤æ‚çš„å…³è”å…³ç³»è§£è€¦ï¼ŒMediatoræ¨¡å¼å°†å¤šä¸ªå¯¹è±¡é—´çš„æ§åˆ¶é€»è¾‘è¿›è¡Œé›†ä¸­ç®¡ç†ï¼Œå˜â€œå¤šä¸ªå¯¹è±¡äº’ç›¸å…³è”&quot;ä¸ºâ€œå¤šä¸ªå¯¹è±¡å’Œä¸€ä¸ªä¸­ä»‹è€…å…³è”â€ï¼Œç®€åŒ–äº†ç³»ç»Ÿçš„ç»´æŠ¤ï¼ŒæŠµå¾¡äº†å¯èƒ½çš„å˜åŒ–ã€‚</li><li>éšç€æ§åˆ¶é€»è¾‘çš„å¤æ‚åŒ–ï¼ŒMediatorå…·ä½“å¯¹è±¡çš„å®ç°å¯èƒ½ç›¸å½“å¤æ‚ã€‚è¿™æ—¶å€™å¯ä»¥å¯¹Mediatorå¯¹è±¡è¿›è¡Œåˆ†è§£å¤„ç†ã€‚</li><li>FaÃ§adeæ¨¡å¼æ˜¯è§£è€¦ç³»ç»Ÿé—´(å•å‘)çš„å¯¹è±¡å…³è”å…³ç³»;ediatoræ¨¡å¼æ˜¯è§£è€¦ç³»ç»Ÿå†…å„ä¸ªå¯¹è±¡ä¹‹é—´(åŒå‘)çš„å…³è”å…³ç³»ã€‚</li></ol><h2 id="æ¥å£éš”ç¦»-æ¨¡å¼">&quot;æ¥å£éš”ç¦»&quot;æ¨¡å¼</h2><blockquote><p>åœ¨ç»„ä»¶æ„å»ºè¿‡ç¨‹ä¸­ï¼ŒæŸäº›æ¥å£ä¹‹é—´ç›´æ¥çš„ä¾èµ–å¸¸å¸¸ä¼šå¸¦æ¥å¾ˆå¤šé—®é¢˜ã€ç”šè‡³æ ¹æœ¬æ— æ³•å®ç°ã€‚é‡‡ç”¨æ·»åŠ ä¸€å±‚é—´æ¥ï¼ˆç¨³å®šï¼‰æ¥å£ï¼Œæ¥éš”ç¦»æœ¬æ¥äº’ç›¸ç´§å¯†å…³è”çš„æ¥å£æ˜¯ä¸€ç§å¸¸è§çš„è§£å†³æ–¹æ¡ˆã€‚</p></blockquote><h3 id="å…¸å‹æ¨¡å¼">å…¸å‹æ¨¡å¼</h3><ol><li><a href="/2021/11/10/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F10/">FaÃ§ade</a>    -è§£å†³ç³»ç»Ÿå†…å¤–çš„æ¥å£é—®é¢˜</li><li><a href="/2021/11/10/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F11/">Proxy</a>     -è§£å†³ä¸¤å¯¹è±¡ä¹‹é—´çš„æ¥å£é—®é¢˜</li><li><a href="/2021/11/15/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F12/">Adapter</a>   -è§£å†³æ–°è€æ¥å£ä¹‹é—´è½¬æ¢é—®é¢˜</li><li><a href="/2021/11/15/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F13/">Mediator</a>  -è§£å†³å¤šä¸ªå¯¹è±¡å¤æ‚å…³è”é—®é¢˜</li></ol>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼(åä¸€)-Adapter</title>
      <link href="/2021/11/15/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F12/"/>
      <url>/2021/11/15/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F12/</url>
      
        <content type="html"><![CDATA[<h2 id="è®¾è®¡åŠ¨æœº">è®¾è®¡åŠ¨æœº</h2><ol><li>åœ¨è½¯ä»¶ç³»ç»Ÿä¸­ï¼Œç”±äºåº”ç”¨ç¯å¢ƒçš„å˜åŒ–ï¼Œå¸¸å¸¸éœ€è¦å°†â€œä¸€äº›ç°å­˜çš„å¯¹è±¡â€æ”¾åœ¨æ–°çš„ç¯å¢ƒä¸­åº”ç”¨ï¼Œä½†æ˜¯æ–°ç¯å¢ƒè¦æ±‚çš„æ¥å£æ˜¯è¿™äº›ç°å­˜å¯¹è±¡æ‰€ä¸æ»¡è¶³çš„ã€‚</li><li>å¦‚ä½•åº”å¯¹è¿™ç§â€œè¿ç§»çš„å˜åŒ–&quot;?å¦‚ä½•æ—¢èƒ½åˆ©ç”¨ç°æœ‰å¯¹è±¡çš„è‰¯å¥½å®ç°ï¼ŒåŒæ—¶åˆèƒ½æ»¡è¶³æ–°çš„åº”ç”¨ç¯å¢ƒæ‰€è¦æ±‚çš„æ¥å£?</li></ol><h2 id="å®šä¹‰">å®šä¹‰</h2><blockquote><p>å°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·å¸Œæœ›çš„å¦ä¸€ä¸ªæ¥å£ã€‚Adapteræ¨¡å¼ä½¿å¾—åŸæœ¬ç”±äºæ¥å£ä¸å…¼å®¹è€Œä¸èƒ½ä¸€èµ·å·¥ä½œçš„é‚£äº›ç±»å¯ä»¥ä¸€èµ·å·¥ä½œã€‚</p></blockquote><h2 id="ç»“æ„">ç»“æ„</h2><p><img src="/img/PatternDesign/12_01.png" alt="ç»“æ„"></p><h2 id="ä¾‹å­">ä¾‹å­</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//é—ç•™æ¥å£(è€æ¥å£)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IAdaptee</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">foo</span><span class="params">(<span class="keyword">int</span> data)</span> </span>= <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">int</span> <span class="title">bar</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//é—ç•™ç±»å‹</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Oldclass</span> :</span> <span class="keyword">public</span> IAdaptee&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">foo</span><span class="params">(<span class="keyword">int</span> data)</span></span>&#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">int</span> <span class="title">bar</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç›®æ ‡æ¥å£(æ–°æ¥å£)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ITarget</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">porcess</span><span class="params">()</span></span>=<span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¯¹è±¡é€‚é…å™¨(ç»§æ‰¿ï¼‹ç»„åˆ)</span></span><br><span class="line"><span class="comment">//ç»§æ‰¿</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Adapter</span> :</span><span class="keyword">public</span> ITarget&#123; </span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="comment">//ç»„åˆ</span></span><br><span class="line">    IAdaptee* pAdaptee;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Adapter</span>(IAdaptee* adaptee):<span class="built_in">pAdaptee</span>(adaptee)&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">porcess</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//ä½¿ç”¨æ—§æ¥å£</span></span><br><span class="line">        <span class="built_in">foo</span>();</span><br><span class="line">        <span class="built_in">bar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç±»é€‚é…å™¨ å¤šç»§æ‰¿(ä¸æ¨èä½¿ç”¨)</span></span><br><span class="line"><span class="comment">//ç¼ºä¹çµæ´»æ€§ï¼Œä¸æ˜¯é’ˆå¯¹æ¥å£ï¼Œå®šæ­»åœ¨äº†Oldclass</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Adapter1</span> :</span><span class="keyword">public</span> ITarget,<span class="keyword">protected</span> Oldclass&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//ä½¿ç”¨</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    IAdaptee* pAdaptee = <span class="keyword">new</span> <span class="built_in">Oldclass</span>();</span><br><span class="line">    ITarget* pTarget = <span class="keyword">new</span> <span class="built_in">Adapter</span>(pAdaptee);</span><br><span class="line">    pTarget-&gt;<span class="built_in">process</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“">æ€»ç»“</h2><ol><li><p>Adapteræ¨¡å¼ä¸»è¦åº”ç”¨äºâ€œå¸Œæœ›å¤ç”¨ä¸€äº›ç°å­˜çš„ç±»ï¼Œä½†æ˜¯æ¥å£åˆä¸å¤ç”¨ç¯å¢ƒè¦æ±‚ä¸ä¸€è‡´çš„æƒ…å†µâ€ï¼Œåœ¨é—ç•™ä»£ç å¤ç”¨ã€ç±»åº“è¿ç§»ç­‰æ–¹é¢éå¸¸æœ‰ç”¨ã€‚</p></li><li><p>-GoF 23å®šä¹‰äº†ä¸¤ç§Adapteræ¨¡å¼çš„å®ç°ç»“æ„:å¯¹è±¡é€‚é…å™¨å’Œç±»é€‚é…å™¨ã€‚ä½†ç±»é€‚é…å™¨é‡‡ç”¨â€œå¤šç»§æ‰¿&quot;çš„å®ç°æ–¹å¼ï¼Œä¸€èˆ¬ä¸æ¨èä½¿ç”¨ã€‚å¯¹è±¡é€‚é…å™¨é‡‡ç”¨â€œå¯¹è±¡ç»„åˆâ€çš„æ–¹å¼ï¼Œæ›´ç¬¦åˆæ¾è€¦åˆç²¾ç¥ã€‚</p></li><li><p>Adapteræ¨¡å¼å¯ä»¥å®ç°çš„éå¸¸çµæ´»ï¼Œä¸å¿…æ‹˜æ³¥äºGof23ä¸­å®šä¹‰çš„ä¸¤ç§ç»“æ„ã€‚ä¾‹å¦‚ï¼Œå®Œå…¨å¯ä»¥å°†Adapteræ¨¡å¼ä¸­çš„â€œç°å­˜å¯¹è±¡&quot;ä½œä¸ºæ–°çš„æ¥å£æ–¹æ³•å‚æ•°ï¼Œæ¥è¾¾åˆ°é€‚é…çš„ç›®çš„ã€‚</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼(å)-Proxy</title>
      <link href="/2021/11/10/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F11/"/>
      <url>/2021/11/10/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F11/</url>
      
        <content type="html"><![CDATA[<h2 id="è®¾è®¡åŠ¨æœº">è®¾è®¡åŠ¨æœº</h2><ol><li>åœ¨é¢å‘å¯¹è±¡ç³»ç»Ÿä¸­ï¼Œæœ‰äº›å¯¹è±¡ç”±äºæŸç§åŸå› (æ¯”å¦‚å¯¹è±¡åˆ›å»ºçš„å¼€é”€å¾ˆå¤§ï¼Œæˆ–è€…æŸäº›æ“ä½œéœ€è¦å®‰å…¨æ§åˆ¶ï¼Œæˆ–è€…éœ€è¦è¿›ç¨‹å¤–çš„è®¿é—®ç­‰)ç›´æ¥è®¿é—®ä¼šç»™ä½¿ç”¨è€…ã€æˆ–è€…ç³»ç»Ÿç»“æ„å¸¦æ¥å¾ˆå¤šéº»çƒ¦ã€‚</li><li>å¦‚ä½•åœ¨ä¸å¤±å»é€æ˜æ“ä½œå¯¹è±¡çš„åŒæ—¶æ¥ç®¡ç†/æ§åˆ¶è¿™äº›å¯¹è±¡ç‰¹æœ‰çš„å¤<br>æ‚æ€§?å¢åŠ ä¸€å±‚é—´æ¥å±‚æ˜¯è½¯ä»¶å¼€å‘ä¸­å¸¸è§çš„è§£å†³æ–¹å¼ã€‚</li></ol><h2 id="å®šä¹‰">å®šä¹‰</h2><blockquote><p>ä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶(éš”ç¦»ï¼Œä½¿ç”¨æ¥å£)å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®</p></blockquote><h2 id="ç»“æ„">ç»“æ„</h2><p><img src="/img/PatternDesign/11_01.png" alt="ç»“æ„"></p><h2 id="ä¾‹å­">ä¾‹å­</h2><h3 id="ä¼ ç»Ÿ">ä¼ ç»Ÿ</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ISubject</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">process</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RealSubject</span>:</span> <span class="keyword">public</span> ISubject&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">process</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//....</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClientApp</span>&#123;</span></span><br><span class="line">    </span><br><span class="line">    ISubject* subject;</span><br><span class="line"><span class="keyword">public</span>: </span><br><span class="line">    <span class="built_in">ClientApp</span>()&#123;</span><br><span class="line">        subject=<span class="keyword">new</span> <span class="built_in">RealSubject</span>();</span><br><span class="line">    &#125;   </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">DoTask</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">        subject-&gt;<span class="built_in">process</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//....</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="ä»£ç†æ¨¡å¼">ä»£ç†æ¨¡å¼</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ISubject</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">process</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Proxyçš„è®¾è®¡</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SubjectProxy</span>:</span> <span class="keyword">public</span> ISubject&#123;  </span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">process</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//å¯¹RealSubjectçš„ä¸€ç§é—´æ¥è®¿é—®</span></span><br><span class="line">        <span class="comment">//....</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClientApp</span>&#123;</span></span><br><span class="line">    </span><br><span class="line">    ISubject* subject;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">public</span>:  </span><br><span class="line">    <span class="built_in">ClientApp</span>()&#123;</span><br><span class="line">        subject=<span class="keyword">new</span> <span class="built_in">SubjectProxy</span>();</span><br><span class="line">    &#125;   </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">DoTask</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">        subject-&gt;<span class="built_in">process</span>();      </span><br><span class="line">        <span class="comment">//....</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“">æ€»ç»“</h2><ol><li>â€œå¢åŠ ä¸€å±‚é—´æ¥å±‚â€™æ˜¯è½¯ä»¶ç³»ç»Ÿä¸­å¯¹è®¸å¤šå¤æ‚é—®é¢˜çš„ä¸€ç§å¸¸è§è§£å†³æ–¹æ³•ã€‚åœ¨é¢å‘å¯¹è±¡ç³»ç»Ÿä¸­ï¼Œç›´æ¥ä½¿ç”¨æŸäº›å¯¹è±¡ä¼šå¸¦æ¥å¾ˆå¤šé—®é¢˜ï¼Œä½œä¸ºé—´æ¥å±‚çš„proxyå¯¹è±¡ä¾¿æ˜¯è§£å†³è¿™ä¸€é—®é¢˜çš„å¸¸ç”¨æ‰‹æ®µã€‚</li><li>å…·ä½“proxyè®¾è®¡æ¨¡å¼çš„å®ç°æ–¹æ³•ã€å®ç°ç²’åº¦éƒ½ç›¸å·®å¾ˆå¤§ï¼Œæœ‰äº›å¯èƒ½å¯¹å•ä¸ªå¯¹è±¡åšç»†ç²’åº¦çš„æ§åˆ¶ï¼Œå¦‚copy-on-writeæŠ€æœ¯ï¼Œ æœ‰äº›å¯èƒ½å¯¹ç»„ä»¶æ¨¡å—æä¾›æŠ½è±¡ä»£ç†å±‚,åœ¨æ¶æ„å±‚æ¬¡å¯¹å¯¹è±¡åšproxyã€‚</li><li>Proxyå¹¶ä¸ä¸€å®šè¦æ±‚ä¿æŒæ¥å£å®Œæ•´çš„ä¸€è‡´æ€§ï¼Œåªè¦èƒ½å¤Ÿå®ç°é—´æ¥æ§<br>åˆ¶ï¼Œæœ‰æ—¶å€™æŸåŠä¸€äº›é€æ˜æ€§æ˜¯å¯ä»¥æ¥å—çš„ã€‚</li></ol>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼(ä¹)-FaÃ§ade</title>
      <link href="/2021/11/10/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F10/"/>
      <url>/2021/11/10/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F10/</url>
      
        <content type="html"><![CDATA[<h2 id="è®¾è®¡åŠ¨æœº">è®¾è®¡åŠ¨æœº</h2><p><img src="/img/PatternDesign/10_01.png" alt="åŠ¨æœº"></p><ol><li>ä¸Šè¿°Aæ–¹æ¡ˆçš„é—®é¢˜åœ¨äºç»„ä»¶çš„å®¢æˆ·å’Œç»„ä»¶ä¸­å„ç§å¤æ‚çš„å­ç³»ç»Ÿæœ‰äº†è¿‡å¤šçš„è€¦åˆï¼Œéšç€å¤–éƒ¨å®¢æˆ·ç¨‹åºå’Œå„å­ç³»ç»Ÿçš„æ¼”åŒ–ï¼Œè¿™ç§è¿‡å¤šçš„è€¦åˆé¢ä¸´å¾ˆå¤šå˜åŒ–çš„æŒ‘æˆ˜ã€‚</li><li>å¦‚ä½•ç®€åŒ–å¤–éƒ¨å®¢æˆ·ç¨‹åºå’Œç³»ç»Ÿé—´çš„äº¤äº’æ¥å£?å¦‚ä½•å°†å¤–éƒ¨å®¢æˆ·ç¨‹<br>åºçš„æ¼”åŒ–å’Œå†…éƒ¨å­ç³»ç»Ÿçš„å˜åŒ–ä¹‹é—´çš„ä¾èµ–ç›¸äº’è§£è€¦?</li></ol><h2 id="å®šä¹‰">å®šä¹‰</h2><blockquote><p>ä¸ºå­ç³»ç»Ÿä¸­çš„ä¸€-ç»„æ¥å£æä¾›ä¸€ä¸ª**ä¸€è‡´(ç¨³å®š)**çš„ç•Œé¢,FaÃ§adeæ¨¡å¼å®šä¹‰äº†ä¸€ä¸ªé«˜å±‚æ¥å£ï¼Œè¿™ä¸ªæ¥å£ä½¿å¾—è¿™ä¸€å­ç³»ç»Ÿæ›´åŠ å®¹æ˜“ä½¿ç”¨(å¤ç”¨)</p></blockquote><h2 id="ç»“æ„">ç»“æ„</h2><p><img src="/img/PatternDesign/10_02.png" alt="ç»“æ„"></p><h2 id="æ€»ç»“">æ€»ç»“</h2><ol><li>ä»å®¢æˆ·ç¨‹åºçš„è§’åº¦æ¥çœ‹ï¼ŒFaÃ§adeæ¨¡å¼ç®€åŒ–äº†æ•´ä¸ªç»„ä»¶ç³»ç»Ÿçš„æ¥å£ï¼Œå¯¹äºç»„ä»¶å†…éƒ¨ä¸å¤–éƒ¨å®¢æˆ·ç¨‹åºæ¥è¯´ï¼Œè¾¾åˆ°äº†ä¸€ç§â€œè§£è€¦â€çš„æ•ˆæœï¼Œå†…éƒ¨å­ç³»ç»Ÿçš„ä»»ä½•å˜åŒ–ä¸ä¼šå½±å“åˆ°FaÃ§adeæ¥å£çš„å˜åŒ–ã€‚</li><li>FaÃ§adeè®¾è®¡æ¨¡å¼æ›´æ³¨é‡ä»æ¶æ„çš„å±‚æ¬¡å»çœ‹æ•´ä¸ªç³»ç»Ÿï¼Œè€Œä¸æ˜¯å•ä¸ªç±»çš„å±‚æ¬¡ã€‚FaÃ§adeå¾ˆå¤šæ—¶å€™æ›´æ˜¯ä¸€ç§æ¶æ„è®¾è®¡æ¨¡å¼ã€‚</li><li>FaÃ§adeè®¾è®¡æ¨¡å¼å¹¶éä¸€ä¸ªé›†è£…ç®±ï¼Œå¯ä»¥ä»»æ„åœ°æ”¾è¿›ä»»ä½•å¤šä¸ªå¯¹è±¡ã€‚FaÃ§adeæ¨¡å¼ä¸­ç»„ä»¶çš„å†…éƒ¨åº”è¯¥æ˜¯â€œç›¸äº’è€¦åˆå…³ç³»æ¯”è¾ƒå¤§çš„ä¸€ç³»åˆ—ç»„ä»¶â€ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªç®€å•çš„åŠŸèƒ½é›†åˆã€‚</li></ol>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼(å…«)-Flyweight</title>
      <link href="/2021/11/08/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F09/"/>
      <url>/2021/11/08/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F09/</url>
      
        <content type="html"><![CDATA[<h2 id="è®¾è®¡åŠ¨æœº">è®¾è®¡åŠ¨æœº</h2><ol><li>åœ¨è½¯ä»¶ç³»ç»Ÿé‡‡ç”¨çº¯ç²¹å¯¹è±¡æ–¹æ¡ˆçš„é—®é¢˜åœ¨äºå¤§é‡ç»†ç²’åº¦çš„å¯¹è±¡ä¼šå¾ˆå¿«å……æ–¥åœ¨ç³»ç»Ÿä¸­ï¼Œä»è€Œå¸¦æ¥å¾ˆé«˜çš„è¿è¡Œæ—¶ä»£ä»·â€”â€”ä¸»è¦æŒ‡å†…å­˜éœ€æ±‚æ–¹é¢çš„ä»£ä»·ã€‚</li><li>åœ¨é¿å…å¤§é‡ç»†ç²’åº¦å¯¹è±¡é—®é¢˜çš„åŒæ—¶ï¼Œè®©å¤–éƒ¨å®¢æˆ·ç¨‹åºä»ç„¶èƒ½å¤Ÿé€æ˜åœ°ä½¿ç”¨é¢å‘å¯¹è±¡çš„æ–¹å¼æ¥è¿›è¡Œæ“ä½œ</li></ol><h2 id="å®šä¹‰">å®šä¹‰</h2><blockquote><p>è¿ç”¨å…±äº«æŠ€æœ¯æœ‰æ•ˆåœ°æ”¯æŒå¤§é‡ç»†ç²’åº¦çš„å¯¹è±¡</p></blockquote><h2 id="ç»“æ„">ç»“æ„</h2><p><img src="/img/PatternDesign/09_01.png" alt="ç»“æ„"></p><h2 id="ä¾‹å­">ä¾‹å­</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Font</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="comment">//unique object key</span></span><br><span class="line">    string key;  </span><br><span class="line">    <span class="comment">//object state</span></span><br><span class="line">    <span class="comment">//....   </span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Font</span>(<span class="keyword">const</span> string&amp; key)&#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FontFactory</span>&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    map&lt;string,Font* &gt; fontPool;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">Font* <span class="title">GetFont</span><span class="params">(<span class="keyword">const</span> string&amp; key)</span></span>&#123;</span><br><span class="line">        map&lt;string,Font*&gt;::iterator item=fontPool.<span class="built_in">find</span>(key);       </span><br><span class="line">        <span class="keyword">if</span>(item!=footPool.<span class="built_in">end</span>())&#123;</span><br><span class="line">            <span class="keyword">return</span> fontPool[key];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            Font* font = <span class="keyword">new</span> <span class="built_in">Font</span>(key);</span><br><span class="line">            fontPool[key]= font;</span><br><span class="line">            <span class="keyword">return</span> font;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;   </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“">æ€»ç»“</h2><ol><li>é¢å‘å¯¹è±¡å¾ˆå¥½åœ°è§£å†³äº†æŠ½è±¡æ€§çš„é—®é¢˜ï¼Œä½†æ˜¯ä½œä¸ºä¸€ä¸ªè¿è¡Œåœ¨æœºå™¨ä¸­çš„ç¨‹åºå®ä½“ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘å¯¹è±¡çš„ä»£ä»·é—®é¢˜ã€‚Flyweightä¸»è¦è§£å†³é¢å‘å¯¹è±¡çš„ä»£ä»·é—®é¢˜ï¼Œä¸€èˆ¬ä¸è§¦åŠé¢å‘å¯¹è±¡çš„æŠ½è±¡æ€§é—®é¢˜ã€‚</li><li>Flyweighté‡‡ç”¨å¯¹è±¡å…±äº«çš„åšæ³•æ¥é™ä½ç³»ç»Ÿä¸­å¯¹è±¡çš„ä¸ªæ•°ï¼Œä»è€Œé™ä½ç»†ç²’åº¦å¯¹è±¡ç»™ç³»ç»Ÿå¸¦æ¥çš„å†…å­˜å‹åŠ›ã€‚åœ¨å…·ä½“å®ç°æ–¹é¢ï¼Œè¦æ³¨æ„å¯¹è±¡çŠ¶æ€çš„å¤„ç†ã€‚</li><li>å¯¹è±¡çš„æ•°é‡å¤ªå¤§ä»è€Œå¯¼è‡´å¯¹è±¡å†…å­˜å¼€é”€åŠ å¤§â€”â€”ä»€ä¹ˆæ ·çš„æ•°é‡æ‰ç®—å¤§?è¿™éœ€è¦æˆ‘ä»¬ä»”ç»†çš„æ ¹æ®å…·ä½“åº”ç”¨æƒ…å†µè¿›è¡Œè¯„ä¼°ï¼Œè€Œä¸èƒ½å‡­ç©ºè‡†æ–­ã€‚</li></ol><p><img src="/img/PatternDesign/PatternDesign09.png" alt="PatternDesign09"></p>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼(ä¸ƒ)- Singleton</title>
      <link href="/2021/11/07/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F08/"/>
      <url>/2021/11/07/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F08/</url>
      
        <content type="html"><![CDATA[<h2 id="è®¾è®¡åŠ¨æœº">è®¾è®¡åŠ¨æœº</h2><ol><li>åœ¨è½¯ä»¶ç³»ç»Ÿä¸­ï¼Œç»å¸¸æœ‰è¿™æ ·ä¸€äº›ç‰¹æ®Šçš„ç±»ï¼Œå¿…é¡»ä¿è¯å®ƒä»¬åœ¨ç³»ç»Ÿä¸­åªå­˜åœ¨ä¸€ä¸ªå®ä¾‹ï¼Œæ‰èƒ½ç¡®ä¿å®ƒä»¬çš„é€»è¾‘æ­£ç¡®æ€§ã€ä»¥åŠè‰¯å¥½çš„æ•ˆç‡ã€‚</li><li>ç»•è¿‡å¸¸è§„çš„æ„é€ å™¨ï¼Œæä¾›ä¸€ç§æœºåˆ¶æ¥ä¿è¯ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹</li><li>è¿™æ˜¯ç±»è®¾è®¡è€…çš„è´£ä»»ï¼Œè€Œä¸æ˜¯ä½¿ç”¨è€…çš„è´£ä»»ã€‚</li></ol><h2 id="å®šä¹‰">å®šä¹‰</h2><blockquote><p>ä¿è¯ä¸€ä¸ªç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªè¯¥å®ä¾‹çš„å…¨å±€è®¿é—®ç‚¹ã€‚</p></blockquote><h2 id="ç»“æ„">ç»“æ„</h2><p><img src="/img/PatternDesign/08_01.png" alt="ç»“æ„"></p><h2 id="ä¾‹å­">ä¾‹å­</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span>&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="comment">//å•ä¾‹æ¨¡å¼åªèƒ½æœ‰ä¸€ä¸ªç¤ºä¾‹ å› æ­¤éœ€è¦é˜»æ­¢æ‹·è´</span></span><br><span class="line">    <span class="comment">//æ‹·è´æ„é€ å‡½æ•°ã€æ‹·è´èµ‹å€¼è¿ç®—ç¬¦ä¸éœ€è¦</span></span><br><span class="line">    <span class="comment">//æ–°æ ‡å‡†åŠ ä¸Šdeleteå¯ä»¥å®šä¹‰ä¸ºåˆ é™¤æˆ–å®šä¹‰ä¸ºç§æœ‰</span></span><br><span class="line">    <span class="built_in">Singleton</span>()&#123;&#125;</span><br><span class="line">    <span class="built_in">Singleton</span>(<span class="keyword">const</span> Singleton&amp;) = <span class="keyword">delete</span>;</span><br><span class="line">    Singleton&amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> Singleton&amp;) = <span class="keyword">delete</span>;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">static</span> Singleton* <span class="title">getInstance</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="keyword">static</span> Singleton* m_instance;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//é™æ€å˜é‡åˆå§‹åŒ–</span></span><br><span class="line">Singleton* Singleton::m_instance = <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//çº¿ç¨‹éå®‰å…¨ç‰ˆæœ¬</span></span><br><span class="line"><span class="function">Singleton* <span class="title">Singleton::getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(m_instance == <span class="literal">nullptr</span>)&#123;</span><br><span class="line">        m_instance = <span class="keyword">new</span> <span class="built_in">Singleton</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> m_instance;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//çº¿ç¨‹å®‰å…¨ç‰ˆ,ä½†é”çš„ä»£ä»·è¿‡é«˜</span></span><br><span class="line"><span class="function">Singleton* <span class="title">Singleton::getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">    Lock lock;</span><br><span class="line">    <span class="keyword">if</span>(m_instance == <span class="literal">nullptr</span>)&#123;</span><br><span class="line">        m_instance = <span class="keyword">new</span> <span class="built_in">Singleton</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> m_instance;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åŒæ£€æŸ¥é” ï¼Œä½†ç”±äºå†…å­˜è¯»å†™reorderä¸å®‰å…¨</span></span><br><span class="line"><span class="comment">//åªæœ‰ä¸ºç©ºæ‰åŠ é”ï¼Œé”å‰ä¸æ£€æŸ¥ä»£ä»·è¿‡é«˜ï¼Œé”åä¸æ£€æŸ¥çº¿ç¨‹ä¸å®‰å…¨</span></span><br><span class="line"><span class="comment">//ä¸è¦å†ç”¨äº†</span></span><br><span class="line"><span class="function">Singleton* <span class="title">Singleton::getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(m_instance == <span class="literal">nullptr</span>)&#123;</span><br><span class="line">        Lock lock;</span><br><span class="line">        <span class="keyword">if</span>(m_instance == <span class="literal">nullptr</span>)&#123;</span><br><span class="line">            m_instance = <span class="keyword">new</span> <span class="built_in">Singleton</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> m_instance;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//c++11 ç‰ˆæœ¬ä¹‹åçš„è·¨å¹³å°å®ç°</span></span><br><span class="line">std::atomic&lt;Singleton*&gt; Singleton::m_instance;</span><br><span class="line">std::mutex Singleton::m_mutex;</span><br><span class="line"></span><br><span class="line"><span class="function">Singleton* <span class="title">Singleton::getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Singleton* tmp = m_instance.<span class="built_in">load</span>(std::memory_order_relaxed);</span><br><span class="line">    std::<span class="built_in">atomic_thread_fence</span>(std::memory_order_acquire);<span class="comment">//è·å–å†…å­˜fence</span></span><br><span class="line">    <span class="keyword">if</span> (tmp == <span class="literal">nullptr</span>) &#123;</span><br><span class="line">        <span class="function">std::lock_guard&lt;std::mutex&gt; <span class="title">lock</span><span class="params">(m_mutex)</span></span>;</span><br><span class="line">        tmp = m_instance.<span class="built_in">load</span>(std::memory_order_relaxed);</span><br><span class="line">        <span class="keyword">if</span> (tmp == <span class="literal">nullptr</span>) &#123;</span><br><span class="line">            tmp = <span class="keyword">new</span> <span class="built_in">Singleton</span>();</span><br><span class="line">            std::<span class="built_in">atomic_thread_fence</span>(std::memory_order_release);<span class="comment">//é‡Šæ”¾å†…å­˜fence</span></span><br><span class="line">            m_instance.<span class="built_in">store</span>(tmp, std::memory_order_relaxed);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> tmp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åˆ©ç”¨å±€éƒ¨é™æ€å˜é‡å®ç°ç®€æ´çš„singletonå†™æ³•</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span>&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="comment">//å•ä¾‹æ¨¡å¼åªèƒ½æœ‰ä¸€ä¸ªç¤ºä¾‹ å› æ­¤éœ€è¦é˜»æ­¢æ‹·è´</span></span><br><span class="line">    <span class="comment">//æ‹·è´æ„é€ å‡½æ•°ã€æ‹·è´èµ‹å€¼è¿ç®—ç¬¦ä¸éœ€è¦</span></span><br><span class="line">    <span class="comment">//æ–°æ ‡å‡†åŠ ä¸Šdeleteå¯ä»¥å®šä¹‰ä¸ºåˆ é™¤æˆ–å®šä¹‰ä¸ºç§æœ‰</span></span><br><span class="line">    <span class="built_in">Singleton</span>()&#123;&#125;</span><br><span class="line">    <span class="built_in">Singleton</span>(<span class="keyword">const</span> Singleton&amp;) = <span class="keyword">delete</span>;</span><br><span class="line">    <span class="function">Singleton&amp; <span class="title">operator</span><span class="params">(<span class="keyword">const</span> Singleton&amp;)</span> </span>= <span class="keyword">delete</span>;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">static</span> Singleton* <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">static</span> Singleton m_instance;</span><br><span class="line">        <span class="keyword">return</span> &amp;m_instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å•çº¿ç¨‹ä¸‹ï¼Œæ­£ç¡®ã€‚</li><li>C++11åŠä»¥åçš„ç‰ˆæœ¬ï¼ˆå¦‚C++14ï¼‰çš„å¤šçº¿ç¨‹ä¸‹ï¼Œæ­£ç¡®ã€‚</li><li>C++11ä¹‹å‰çš„å¤šçº¿ç¨‹ä¸‹ï¼Œä¸ä¸€å®šæ­£ç¡®ã€‚åŸå› åœ¨äºåœ¨C++11ä¹‹å‰çš„æ ‡å‡†ä¸­å¹¶æ²¡æœ‰è§„å®šlocal staticå˜é‡çš„å†…å­˜æ¨¡å‹ã€‚äºæ˜¯ä¹å®ƒå°±æ˜¯ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„äº†ã€‚ä½†æ˜¯åœ¨C++11å´æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè¿™æ˜¯å› ä¸ºæ–°çš„C++æ ‡å‡†è§„å®šäº†å½“ä¸€ä¸ªçº¿ç¨‹æ­£åœ¨åˆå§‹åŒ–ä¸€ä¸ªå˜é‡çš„æ—¶å€™ï¼Œå…¶ä»–çº¿ç¨‹å¿…é¡»å¾—ç­‰åˆ°è¯¥åˆå§‹åŒ–å®Œæˆä»¥åæ‰èƒ½è®¿é—®å®ƒã€‚</li></ul><p>ä¸Šè¿°ä½¿ç”¨çš„å†…å­˜åºï¼š</p><p>memory_order_relaxedï¼šæ¾æ•£å†…å­˜åºï¼Œåªç”¨æ¥ä¿è¯å¯¹åŸå­å¯¹è±¡çš„æ“ä½œæ˜¯åŸå­çš„<br>memory_order_acquireï¼šè·å¾—æ“ä½œï¼Œåœ¨è¯»å–æŸåŸå­å¯¹è±¡æ—¶ï¼Œå½“å‰çº¿ç¨‹çš„ä»»ä½•åé¢çš„è¯»å†™æ“ä½œéƒ½ä¸å…è®¸é‡æ’åˆ°è¿™ä¸ªæ“ä½œçš„å‰é¢å»ï¼Œå¹¶ä¸”å…¶ä»–çº¿ç¨‹åœ¨å¯¹åŒä¸€ä¸ªåŸå­å¯¹è±¡é‡Šæ”¾ä¹‹å‰çš„æ‰€æœ‰å†…å­˜å†™å…¥éƒ½åœ¨å½“å‰çº¿ç¨‹å¯è§<br>memory_order_releaseï¼šé‡Šæ”¾æ“ä½œï¼Œåœ¨å†™å…¥æŸåŸå­å¯¹è±¡æ—¶ï¼Œå½“å‰çº¿ç¨‹çš„ä»»ä½•å‰é¢çš„è¯»å†™æ“ä½œéƒ½ä¸å…è®¸é‡æ’åˆ°è¿™ä¸ªæ“ä½œçš„åé¢å»ï¼Œå¹¶ä¸”å½“å‰çº¿ç¨‹çš„æ‰€æœ‰å†…å­˜å†™å…¥éƒ½åœ¨å¯¹åŒä¸€ä¸ªåŸå­å¯¹è±¡è¿›è¡Œè·å–çš„å…¶ä»–çº¿ç¨‹å¯è§</p><h2 id="æ€»ç»“">æ€»ç»“</h2><ol><li>Singletonæ¨¡å¼ä¸­çš„å®ä¾‹æ„é€ å™¨å¯ä»¥è®¾ç½®ä¸ºprotectedä»¥å…è®¸å­ç±»æ´¾ç”Ÿã€‚</li><li>Singletonæ¨¡å¼ä¸€èˆ¬ä¸è¦æ”¯æŒæ‹·è´æ„é€ å‡½æ•°å’ŒCloneæ¥å£ï¼Œå› ä¸ºè¿™æœ‰å¯èƒ½å¯¼è‡´å¤šä¸ªå¯¹è±¡å®ä¾‹ï¼Œä¸Singletonæ¨¡å¼çš„åˆè¡·è¿èƒŒã€‚</li><li>å¦‚ä½•å®ç°å¤šçº¿ç¨‹ç¯å¢ƒä¸‹å®‰å…¨çš„Singleton?æ³¨æ„å¯¹åŒæ£€æŸ¥é”çš„æ­£ç¡®å®ç°ã€‚</li></ol><p><img src="/img/PatternDesign/PatternDesign08.png" alt="PatternDesign08"></p>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼(å…­)- Factory</title>
      <link href="/2021/11/07/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F07/"/>
      <url>/2021/11/07/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F07/</url>
      
        <content type="html"><![CDATA[<h2 id="è®¾è®¡åŠ¨æœº">è®¾è®¡åŠ¨æœº</h2><ol><li>åœ¨è½¯ä»¶ç³»ç»Ÿä¸­,ç»å¸¸é¢ä¸´ç€åˆ›å»ºå¯¹è±¡çš„å·¥ä½œ;ç”±äºéœ€æ±‚çš„å˜åŒ–,éœ€è¦åˆ›å»ºçš„å¯¹è±¡çš„å…·ä½“ç±»å‹ç»å¸¸å˜åŒ–</li><li>å¦‚ä½•åº”å¯¹è¿™ç§å˜åŒ–?å¦‚ä½•ç»•è¿‡å¸¸è§„çš„å¯¹è±¡åˆ›å»ºæ–¹æ³•(new)ï¼Œæä¾›ä¸€ç§â€œå°è£…æœºåˆ¶&quot;æ¥é¿å…å®¢æˆ·ç¨‹åºå’Œè¿™ç§â€œå…·ä½“å¯¹è±¡åˆ›å»ºå·¥ä½œ&quot;çš„ç´§è€¦åˆ?</li></ol><h2 id="å®šä¹‰">å®šä¹‰</h2><blockquote><p>å®šä¹‰ä¸€ä¸ªç”¨äºåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè®©å­ç±»å†³å®šå®ä¾‹åŒ–å“ªä¸€ä¸ªç±»ã€‚Factory Methodä½¿å¾—ä¸€ä¸ªç±»çš„å®ä¾‹åŒ–<strong>å»¶è¿Ÿ</strong>(ç›®çš„:è§£è€¦ï¼Œæ‰‹æ®µï¸°è™šå‡½æ•°)åˆ°å­ç±»ã€‚</p></blockquote><h2 id="ç»“æ„">ç»“æ„</h2><p><img src="/img/PatternDesign/07_01.png" alt="ç»“æ„"></p><h2 id="ä¾‹å­">ä¾‹å­</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//productæŠ½è±¡ç±» </span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ISplitter</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">split</span><span class="params">()</span></span>=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">ISplitter</span>()&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Creatorå·¥å‚åŸºç±» </span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SplitterFactory</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> ISplitter* <span class="title">CreateSplitter</span><span class="params">()</span></span>=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">SplitterFactory</span>()&#123;&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainForm</span> :</span> <span class="keyword">public</span> Form</span><br><span class="line">&#123;</span><br><span class="line">    SplitterFactory*  factory;<span class="comment">//å·¥å‚</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">MainForm</span>(SplitterFactory*  factory)&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;factory=factory;</span><br><span class="line">    &#125;   </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Button1_Click</span><span class="params">()</span></span>&#123;   </span><br><span class="line">ISplitter * splitter=</span><br><span class="line">            factory-&gt;<span class="built_in">CreateSplitter</span>(); <span class="comment">//å¤šæ€new    </span></span><br><span class="line">        splitter-&gt;<span class="built_in">split</span>();</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>åœ¨å®Œæˆäº§å“ç±»å’Œå¯¹åº”çš„å·¥å‚ç±»åï¼Œä¾¿å¯åœ¨<code>MainForm</code>ä¸­åº”ç”¨ã€‚å¯ä»¥ä¿è¯ç¼–è¯‘æ—¶åªä¾èµ–ä¸äº§å“åŸºç±»å’Œå·¥å‚å•ç±»ã€‚å­ç±»å¯ä»¥ä¾æ®éœ€æ±‚éšæ—¶å®ç°</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å­ç±»çš„å®ç°</span></span><br><span class="line"><span class="comment">//å…·ä½“product</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BinarySplitter</span> :</span> <span class="keyword">public</span> ISplitter&#123;</span><br><span class="line">    </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TxtSplitter</span>:</span> <span class="keyword">public</span> ISplitter&#123;</span><br><span class="line">    </span><br><span class="line">&#125;;</span><br><span class="line">    </span><br><span class="line"><span class="comment">//å…·ä½“å·¥å‚</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BinarySplitterFactory</span>:</span> <span class="keyword">public</span> SplitterFactory&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> ISplitter* <span class="title">CreateSplitter</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">BinarySplitter</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TxtSplitterFactory</span>:</span> <span class="keyword">public</span> SplitterFactory&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> ISplitter* <span class="title">CreateSplitter</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">TxtSplitter</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“">æ€»ç»“</h2><ol><li>Factory Methodæ¨¡å¼ç”¨äºéš”ç¦»ç±»å¯¹è±¡çš„ä½¿ç”¨è€…å’Œå…·ä½“ç±»å‹ä¹‹é—´çš„è€¦åˆå…³ç³»ã€‚é¢å¯¹ä¸€ä¸ªç»å¸¸å˜åŒ–çš„å…·ä½“ç±»å‹ï¼Œç´§è€¦åˆå…³ç³»(new)ä¼šå¯¼è‡´è½¯ä»¶çš„è„†å¼±ã€‚</li><li>Factory Methodæ¨¡å¼é€šè¿‡é¢å‘å¯¹è±¡çš„æ‰‹æ³•ï¼Œå°†æ‰€è¦åˆ›å»ºçš„å…·ä½“å¯¹è±¡å·¥ä½œå»¶è¿Ÿåˆ°å­ç±»ï¼Œä»è€Œå®ç°ä¸€ç§æ‰©å±•ï¼ˆè€Œéæ›´æ”¹)çš„ç­–ç•¥ï¼Œè¾ƒå¥½åœ°è§£å†³äº†è¿™ç§ç´§è€¦åˆå…³ç³»ã€‚</li><li>Factory Methodæ¨¡å¼è§£å†³â€œå•ä¸ªå¯¹è±¡&quot;çš„éœ€æ±‚å˜åŒ–ã€‚ç¼ºç‚¹åœ¨äºè¦æ±‚åˆ›å»ºæ–¹æ³•/å‚æ•°ç›¸åŒã€‚</li></ol><p><img src="/img/PatternDesign/PatternDesign07.png" alt="PatternDesign07"></p>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼(äº”)- Birdge</title>
      <link href="/2021/11/04/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F06/"/>
      <url>/2021/11/04/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F06/</url>
      
        <content type="html"><![CDATA[<h2 id="è®¾è®¡åŠ¨æœº">è®¾è®¡åŠ¨æœº</h2><ol><li>ç”±äºæŸäº›ç±»å‹çš„å›ºæœ‰çš„å®ç°é€»è¾‘ï¼Œä½¿å¾—å®ƒä»¬å…·æœ‰ä¸¤ä¸ªå˜åŒ–çš„ç»´åº¦ï¼Œä¹ƒè‡³å¤šä¸ªçº¬åº¦çš„å˜åŒ–</li><li>å¦‚ä½•åº”å¯¹è¿™ç§â€œå¤šç»´åº¦çš„å˜åŒ–â€?å¦‚ä½•åˆ©ç”¨é¢å‘å¯¹è±¡æŠ€æœ¯æ¥ä½¿å¾—ç±»å‹å¯ä»¥è½»æ¾åœ°æ²¿ç€ä¸¤ä¸ªä¹ƒè‡³å¤šä¸ªæ–¹å‘å˜åŒ–ï¼Œè€Œä¸å¼•å…¥é¢å¤–çš„å¤æ‚åº¦?</li></ol><h2 id="å®šä¹‰">å®šä¹‰</h2><blockquote><p>å°†æŠ½è±¡éƒ¨åˆ†ä¸šåŠ¡åŠŸèƒ½)ä¸å®ç°éƒ¨åˆ†(å¹³å°å®ç°)åˆ†ç¦»ï¼Œä½¿å®ƒä»¬éƒ½å¯ä»¥ç‹¬ç«‹åœ°å˜åŒ–ã€‚</p></blockquote><h2 id="ç»“æ„">ç»“æ„</h2><p><img src="/img/PatternDesign/06_01.png" alt="ç»“æ„"></p><h2 id="ä¾‹å­">ä¾‹å­</h2><h3 id="ä¼ ç»Ÿç»§æ‰¿">ä¼ ç»Ÿç»§æ‰¿</h3> <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Messager</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Login</span><span class="params">(string username, string password)</span></span>=<span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">SendMessage</span><span class="params">(string message)</span></span>=<span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">SendPicture</span><span class="params">(Image image)</span></span>=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">PlaySound</span><span class="params">()</span></span>=<span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">DrawShape</span><span class="params">()</span></span>=<span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">WriteText</span><span class="params">()</span></span>=<span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Connect</span><span class="params">()</span></span>=<span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">Messager</span>()&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¹³å°å®ç°</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PCMessagerBase</span> :</span> <span class="keyword">public</span> Messager&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">PlaySound</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//**********</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">DrawShape</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//**********</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">WriteText</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//**********</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Connect</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//**********</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MobileMessagerBase</span> :</span> <span class="keyword">public</span> Messager&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">PlaySound</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//==========</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">DrawShape</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//==========</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">WriteText</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//==========</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Connect</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//==========</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸šåŠ¡æŠ½è±¡</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PCMessagerLite</span> :</span> <span class="keyword">public</span> PCMessagerBase &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Login</span><span class="params">(string username, string password)</span></span>&#123;</span><br><span class="line">        </span><br><span class="line">        PCMessagerBase::<span class="built_in">Connect</span>();</span><br><span class="line">        <span class="comment">//........</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">SendMessage</span><span class="params">(string message)</span></span>&#123;</span><br><span class="line">        </span><br><span class="line">        PCMessagerBase::<span class="built_in">WriteText</span>();</span><br><span class="line">        <span class="comment">//........</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">SendPicture</span><span class="params">(Image image)</span></span>&#123;</span><br><span class="line">        </span><br><span class="line">        PCMessagerBase::<span class="built_in">DrawShape</span>();</span><br><span class="line">        <span class="comment">//........</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PCMessagerPerfect</span> :</span> <span class="keyword">public</span> PCMessagerBase &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Login</span><span class="params">(string username, string password)</span></span>&#123;</span><br><span class="line">        </span><br><span class="line">        PCMessagerBase::<span class="built_in">PlaySound</span>();</span><br><span class="line">        <span class="comment">//********</span></span><br><span class="line">        PCMessagerBase::<span class="built_in">Connect</span>();</span><br><span class="line">        <span class="comment">//........</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">SendMessage</span><span class="params">(string message)</span></span>&#123;</span><br><span class="line">        </span><br><span class="line">        PCMessagerBase::<span class="built_in">PlaySound</span>();</span><br><span class="line">        <span class="comment">//********</span></span><br><span class="line">        PCMessagerBase::<span class="built_in">WriteText</span>();</span><br><span class="line">        <span class="comment">//........</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">SendPicture</span><span class="params">(Image image)</span></span>&#123;</span><br><span class="line">        </span><br><span class="line">        PCMessagerBase::<span class="built_in">PlaySound</span>();</span><br><span class="line">        <span class="comment">//********</span></span><br><span class="line">        PCMessagerBase::<span class="built_in">DrawShape</span>();</span><br><span class="line">        <span class="comment">//........</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MobileMessagerLite</span> :</span> <span class="keyword">public</span> MobileMessagerBase &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Login</span><span class="params">(string username, string password)</span></span>&#123;</span><br><span class="line">        </span><br><span class="line">        MobileMessagerBase::<span class="built_in">Connect</span>();</span><br><span class="line">        <span class="comment">//........</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">SendMessage</span><span class="params">(string message)</span></span>&#123;</span><br><span class="line">        </span><br><span class="line">        MobileMessagerBase::<span class="built_in">WriteText</span>();</span><br><span class="line">        <span class="comment">//........</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">SendPicture</span><span class="params">(Image image)</span></span>&#123;</span><br><span class="line">        </span><br><span class="line">        MobileMessagerBase::<span class="built_in">DrawShape</span>();</span><br><span class="line">        <span class="comment">//........</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MobileMessagerPerfect</span> :</span> <span class="keyword">public</span> MobileMessagerBase &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Login</span><span class="params">(string username, string password)</span></span>&#123;</span><br><span class="line">        </span><br><span class="line">        MobileMessagerBase::<span class="built_in">PlaySound</span>();</span><br><span class="line">        <span class="comment">//********</span></span><br><span class="line">        MobileMessagerBase::<span class="built_in">Connect</span>();</span><br><span class="line">        <span class="comment">//........</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">SendMessage</span><span class="params">(string message)</span></span>&#123;</span><br><span class="line">        </span><br><span class="line">        MobileMessagerBase::<span class="built_in">PlaySound</span>();</span><br><span class="line">        <span class="comment">//********</span></span><br><span class="line">        MobileMessagerBase::<span class="built_in">WriteText</span>();</span><br><span class="line">        <span class="comment">//........</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">SendPicture</span><span class="params">(Image image)</span></span>&#123;</span><br><span class="line">        </span><br><span class="line">        MobileMessagerBase::<span class="built_in">PlaySound</span>();</span><br><span class="line">        <span class="comment">//********</span></span><br><span class="line">        MobileMessagerBase::<span class="built_in">DrawShape</span>();</span><br><span class="line">        <span class="comment">//........</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Process</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//ç¼–è¯‘æ—¶è£…é…</span></span><br><span class="line">        Messager *m =</span><br><span class="line">            <span class="keyword">new</span> <span class="built_in">MobileMessagerPerfect</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ¡¥æ¨¡å¼">æ¡¥æ¨¡å¼</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Messager</span>&#123;</span></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">     MessagerImp* messagerImp;<span class="comment">//...</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Login</span><span class="params">(string username, string password)</span></span>=<span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">SendMessage</span><span class="params">(string message)</span></span>=<span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">SendPicture</span><span class="params">(Image image)</span></span>=<span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">Messager</span>()&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MessagerImp</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">PlaySound</span><span class="params">()</span></span>=<span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">DrawShape</span><span class="params">()</span></span>=<span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">WriteText</span><span class="params">()</span></span>=<span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Connect</span><span class="params">()</span></span>=<span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="title">MessagerImp</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//å¹³å°å®ç° n</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PCMessagerImp</span> :</span> <span class="keyword">public</span> MessagerImp&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">PlaySound</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//**********</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">DrawShape</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//**********</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">WriteText</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//**********</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Connect</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//**********</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MobileMessagerImp</span> :</span> <span class="keyword">public</span> MessagerImp&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">PlaySound</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//==========</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">DrawShape</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//==========</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">WriteText</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//==========</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Connect</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//==========</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//ä¸šåŠ¡æŠ½è±¡ m</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ç±»çš„æ•°ç›®ï¼š1+n+m</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MessagerLite</span> :</span><span class="keyword">public</span> Messager &#123;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Login</span><span class="params">(string username, string password)</span></span>&#123;</span><br><span class="line">        </span><br><span class="line">        messagerImp-&gt;<span class="built_in">Connect</span>();</span><br><span class="line">        <span class="comment">//........</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">SendMessage</span><span class="params">(string message)</span></span>&#123;</span><br><span class="line">        </span><br><span class="line">        messagerImp-&gt;<span class="built_in">WriteText</span>();</span><br><span class="line">        <span class="comment">//........</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">SendPicture</span><span class="params">(Image image)</span></span>&#123;</span><br><span class="line">        </span><br><span class="line">        messagerImp-&gt;<span class="built_in">DrawShape</span>();</span><br><span class="line">        <span class="comment">//........</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MessagerPerfect</span>  :</span><span class="keyword">public</span> Messager &#123;</span><br><span class="line">    </span><br><span class="line">   </span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Login</span><span class="params">(string username, string password)</span></span>&#123;</span><br><span class="line">        </span><br><span class="line">        messagerImp-&gt;<span class="built_in">PlaySound</span>();</span><br><span class="line">        <span class="comment">//********</span></span><br><span class="line">        messagerImp-&gt;<span class="built_in">Connect</span>();</span><br><span class="line">        <span class="comment">//........</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">SendMessage</span><span class="params">(string message)</span></span>&#123;</span><br><span class="line">        </span><br><span class="line">        messagerImp-&gt;<span class="built_in">PlaySound</span>();</span><br><span class="line">        <span class="comment">//********</span></span><br><span class="line">        messagerImp-&gt;<span class="built_in">WriteText</span>();</span><br><span class="line">        <span class="comment">//........</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">SendPicture</span><span class="params">(Image image)</span></span>&#123;</span><br><span class="line">        </span><br><span class="line">        messagerImp-&gt;<span class="built_in">PlaySound</span>();</span><br><span class="line">        <span class="comment">//********</span></span><br><span class="line">        messagerImp-&gt;<span class="built_in">DrawShape</span>();</span><br><span class="line">        <span class="comment">//........</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Process</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//è¿è¡Œæ—¶è£…é…</span></span><br><span class="line">    MessagerImp* mImp=<span class="keyword">new</span> <span class="built_in">PCMessagerImp</span>();</span><br><span class="line">    Messager *m =<span class="keyword">new</span> <span class="built_in">Messager</span>(mImp);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“">æ€»ç»“</h2><ol><li>Bridgeæ¨¡å¼ä½¿ç”¨â€œå¯¹è±¡é—´çš„ç»„åˆå…³ç³»â€è§£è€¦äº†æŠ½è±¡å’Œå®ç°ä¹‹é—´å›ºæœ‰çš„ç»‘å®šå…³ç³»ï¼Œä½¿å¾—æŠ½è±¡å’Œå®ç°å¯ä»¥æ²¿ç€å„è‡ªçš„ç»´åº¦æ¥å˜åŒ–ã€‚æ‰€è°“æŠ½è±¡å’Œå®ç°æ²¿ç€å„è‡ªçº¬åº¦çš„å˜åŒ–ï¼Œå³â€œå­ç±»åŒ–â€å®ƒä»¬ã€‚</li><li>Bridgeæ¨¡å¼æœ‰æ—¶å€™ç±»ä¼¼äºå¤šç»§æ‰¿æ–¹æ¡ˆï¼Œä½†æ˜¯å¤šç»§æ‰¿æ–¹æ¡ˆå¾€å¾€è¿èƒŒå•èŒè´£åŸåˆ™(å³ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå˜åŒ–çš„åŸå› )ï¼Œå¤ç”¨æ€§æ¯”è¾ƒå·®ã€‚Bridgeæ¨¡å¼æ˜¯æ¯”å¤šç»§æ‰¿æ–¹æ¡ˆæ›´å¥½çš„è§£å†³æ–¹æ³•ã€‚</li><li>Bridgeæ¨¡å¼çš„åº”ç”¨ä¸€èˆ¬åœ¨â€œä¸¤ä¸ªéå¸¸å¼ºçš„å˜åŒ–ç»´åº¦â€ï¼Œæœ‰æ—¶ä¸€ä¸ªç±»ä¹Ÿæœ‰å¤šäºä¸¤ä¸ªçš„å˜åŒ–ç»´åº¦ï¼Œè¿™æ—¶å¯ä»¥ä½¿ç”¨Bridgeçš„æ‰©å±•æ¨¡å¼ã€‚</li></ol><p><img src="/img/PatternDesign/PatternDesign06.png" alt="PatternDesign06"></p>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼(äº”)- Decorator</title>
      <link href="/2021/11/03/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F05/"/>
      <url>/2021/11/03/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F05/</url>
      
        <content type="html"><![CDATA[<h2 id="è®¾è®¡åŠ¨æœº">è®¾è®¡åŠ¨æœº</h2><ol><li>åœ¨æŸäº›æƒ…å†µä¸‹æˆ‘ä»¬å¯èƒ½ä¼šâ€œè¿‡åº¦åœ°ä½¿ç”¨ç»§æ‰¿æ¥æ‰©å±•å¯¹è±¡çš„åŠŸèƒ½â€ï¼Œç”±äºç»§æ‰¿ä¸ºç±»å‹å¼•å…¥çš„é™æ€ç‰¹è´¨ï¼Œä½¿å¾—è¿™ç§æ‰©å±•æ–¹å¼ç¼ºä¹çµæ´»æ€§;å¹¶ä¸”éšç€å­ç±»çš„å¢å¤š(æ‰©å±•åŠŸèƒ½çš„å¢å¤š)ï¼Œå„ç§å­ç±»çš„ç»„åˆ(æ‰©å±•åŠŸèƒ½çš„ç»„åˆ)ä¼šå¯¼è‡´æ›´å¤šå­ç±»çš„è†¨èƒ€ã€‚</li><li>å¦‚ä½•ä½¿â€˜å¯¹è±¡åŠŸèƒ½çš„æ‰©å±•â€èƒ½å¤Ÿæ ¹æ®éœ€è¦æ¥åŠ¨æ€åœ°å®ç°?åŒæ—¶é¿å…æ‰©å±•åŠŸèƒ½çš„å¢å¤šâ€å¸¦æ¥çš„å­ç±»è†¨èƒ€é—®é¢˜?ä»è€Œä½¿å¾—ä»»ä½•â€œåŠŸèƒ½æ‰©å±•å˜åŒ–â€æ‰€å¯¼è‡´çš„å½±å“å°†ä¸ºæœ€ä½?</li></ol><h2 id="å®šä¹‰">å®šä¹‰</h2><blockquote><p>åŠ¨æ€(ç»„åˆ)åœ°ç»™ä¸€ä¸ªå¯¹è±¡å¢åŠ ä¸€äº›é¢å¤–çš„èŒè´£ã€‚å°±å¢åŠ åŠŸèƒ½è€Œè¨€ï¼ŒDecoratoræ¨¡å¼æ¯”ç”Ÿæˆå­ç±»(ç»§æ‰¿)æ›´ä¸ºçµæ´»(æ¶ˆé™¤é‡å¤ä»£ç &amp;å‡å°‘å­ç±»ä¸ªæ•°)</p></blockquote><h2 id="ç»“æ„">ç»“æ„</h2><p><img src="/img/PatternDesign/05_01.png" alt="ç»“æ„"></p><h2 id="ä¾‹å­">ä¾‹å­</h2><h3 id="ä¼ ç»Ÿ">ä¼ ç»Ÿ</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä¸šåŠ¡æ“ä½œ</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stream</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>ï¼š</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">char</span> <span class="title">Read</span><span class="params">(<span class="keyword">int</span> number)</span></span>=<span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Seek</span><span class="params">(<span class="keyword">int</span> position)</span></span>=<span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Write</span><span class="params">(<span class="keyword">char</span> data)</span></span>=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">Stream</span>()&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸»ä½“ç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileStream</span>:</span> <span class="keyword">public</span> Stream&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">char</span> <span class="title">Read</span><span class="params">(<span class="keyword">int</span> number)</span></span>&#123;</span><br><span class="line">        <span class="comment">//è¯»æ–‡ä»¶æµ</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Seek</span><span class="params">(<span class="keyword">int</span> position)</span></span>&#123;</span><br><span class="line">        <span class="comment">//å®šä½æ–‡ä»¶æµ</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Write</span><span class="params">(<span class="keyword">char</span> data)</span></span>&#123;</span><br><span class="line">        <span class="comment">//å†™æ–‡ä»¶æµ</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NetworkStream</span> :</span><span class="keyword">public</span> Stream&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">char</span> <span class="title">Read</span><span class="params">(<span class="keyword">int</span> number)</span></span>&#123;</span><br><span class="line">        <span class="comment">//è¯»ç½‘ç»œæµ</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Seek</span><span class="params">(<span class="keyword">int</span> position)</span></span>&#123;</span><br><span class="line">        <span class="comment">//å®šä½ç½‘ç»œæµ</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Write</span><span class="params">(<span class="keyword">char</span> data)</span></span>&#123;</span><br><span class="line">        <span class="comment">//å†™ç½‘ç»œæµ</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MemoryStream</span> :</span><span class="keyword">public</span> Stream&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">char</span> <span class="title">Read</span><span class="params">(<span class="keyword">int</span> number)</span></span>&#123;</span><br><span class="line">        <span class="comment">//è¯»å†…å­˜æµ</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Seek</span><span class="params">(<span class="keyword">int</span> position)</span></span>&#123;</span><br><span class="line">        <span class="comment">//å®šä½å†…å­˜æµ</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Write</span><span class="params">(<span class="keyword">char</span> data)</span></span>&#123;</span><br><span class="line">        <span class="comment">//å†™å†…å­˜æµ</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ‰©å±•æ“ä½œ</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CryptoFileStream</span> :</span><span class="keyword">public</span> FileStream&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">char</span> <span class="title">Read</span><span class="params">(<span class="keyword">int</span> number)</span></span>&#123;       </span><br><span class="line">        <span class="comment">//é¢å¤–çš„åŠ å¯†æ“ä½œ...</span></span><br><span class="line">        FileStream::<span class="built_in">Read</span>(number);<span class="comment">//è¯»æ–‡ä»¶æµ        </span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Seek</span><span class="params">(<span class="keyword">int</span> position)</span></span>&#123;</span><br><span class="line">        <span class="comment">//é¢å¤–çš„åŠ å¯†æ“ä½œ...</span></span><br><span class="line">        FileStream::<span class="built_in">Seek</span>(position);<span class="comment">//å®šä½æ–‡ä»¶æµ</span></span><br><span class="line">        <span class="comment">//é¢å¤–çš„åŠ å¯†æ“ä½œ...</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Write</span><span class="params">(byte data)</span></span>&#123;</span><br><span class="line">        <span class="comment">//é¢å¤–çš„åŠ å¯†æ“ä½œ...</span></span><br><span class="line">        FileStream::<span class="built_in">Write</span>(data);<span class="comment">//å†™æ–‡ä»¶æµ</span></span><br><span class="line">        <span class="comment">//é¢å¤–çš„åŠ å¯†æ“ä½œ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CryptoNetworkStream</span> :</span> :<span class="keyword">public</span> NetworkStream&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">char</span> <span class="title">Read</span><span class="params">(<span class="keyword">int</span> number)</span></span>&#123;        </span><br><span class="line">        <span class="comment">//é¢å¤–çš„åŠ å¯†æ“ä½œ...</span></span><br><span class="line">        NetworkStream::<span class="built_in">Read</span>(number);<span class="comment">//è¯»ç½‘ç»œæµ</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Seek</span><span class="params">(<span class="keyword">int</span> position)</span></span>&#123;</span><br><span class="line">        <span class="comment">//é¢å¤–çš„åŠ å¯†æ“ä½œ...</span></span><br><span class="line">        NetworkStream::<span class="built_in">Seek</span>(position);<span class="comment">//å®šä½ç½‘ç»œæµ</span></span><br><span class="line">        <span class="comment">//é¢å¤–çš„åŠ å¯†æ“ä½œ...</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Write</span><span class="params">(byte data)</span></span>&#123;</span><br><span class="line">        <span class="comment">//é¢å¤–çš„åŠ å¯†æ“ä½œ...</span></span><br><span class="line">        NetworkStream::<span class="built_in">Write</span>(data);<span class="comment">//å†™ç½‘ç»œæµ</span></span><br><span class="line">        <span class="comment">//é¢å¤–çš„åŠ å¯†æ“ä½œ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CryptoMemoryStream</span> :</span> <span class="keyword">public</span> MemoryStream&#123;</span><br><span class="line"><span class="comment">//...</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BufferedFileStream</span> :</span> <span class="keyword">public</span> FileStream&#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BufferedNetworkStream</span> :</span> <span class="keyword">public</span> NetworkStream&#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BufferedMemoryStream</span> :</span> <span class="keyword">public</span> MemoryStream&#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CryptoBufferedFileStream</span> :</span><span class="keyword">public</span> FileStream&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">char</span> <span class="title">Read</span><span class="params">(<span class="keyword">int</span> number)</span></span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//é¢å¤–çš„åŠ å¯†æ“ä½œ...</span></span><br><span class="line">        <span class="comment">//é¢å¤–çš„ç¼“å†²æ“ä½œ...</span></span><br><span class="line">        FileStream::<span class="built_in">Read</span>(number);<span class="comment">//è¯»æ–‡ä»¶æµ</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Seek</span><span class="params">(<span class="keyword">int</span> position)</span></span>&#123;</span><br><span class="line">        <span class="comment">//é¢å¤–çš„åŠ å¯†æ“ä½œ...</span></span><br><span class="line">        <span class="comment">//é¢å¤–çš„ç¼“å†²æ“ä½œ...</span></span><br><span class="line">        FileStream::<span class="built_in">Seek</span>(position);<span class="comment">//å®šä½æ–‡ä»¶æµ</span></span><br><span class="line">        <span class="comment">//é¢å¤–çš„åŠ å¯†æ“ä½œ...</span></span><br><span class="line">        <span class="comment">//é¢å¤–çš„ç¼“å†²æ“ä½œ...</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Write</span><span class="params">(byte data)</span></span>&#123;</span><br><span class="line">        <span class="comment">//é¢å¤–çš„åŠ å¯†æ“ä½œ...</span></span><br><span class="line">        <span class="comment">//é¢å¤–çš„ç¼“å†²æ“ä½œ...</span></span><br><span class="line">        FileStream::<span class="built_in">Write</span>(data);<span class="comment">//å†™æ–‡ä»¶æµ</span></span><br><span class="line">        <span class="comment">//é¢å¤–çš„åŠ å¯†æ“ä½œ...</span></span><br><span class="line">        <span class="comment">//é¢å¤–çš„ç¼“å†²æ“ä½œ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Process</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//ç¼–è¯‘æ—¶è£…é…</span></span><br><span class="line">    CryptoFileStream *fs1 = <span class="keyword">new</span> <span class="built_in">CryptoFileStream</span>();</span><br><span class="line"></span><br><span class="line">    BufferedFileStream *fs2 = <span class="keyword">new</span> <span class="built_in">BufferedFileStream</span>();</span><br><span class="line"></span><br><span class="line">    CryptoBufferedFileStream *fs3 =<span class="keyword">new</span> <span class="built_in">CryptoBufferedFileStream</span>();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è£…é¥°æ¨¡å¼">è£…é¥°æ¨¡å¼</h3><p>æœ‰æ—¶å€™ç»„åˆæ–¹å¼ä¼šå¥½äºç»§æ‰¿</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä¸šåŠ¡æ“ä½œ</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stream</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>ï¼š</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">char</span> <span class="title">Read</span><span class="params">(<span class="keyword">int</span> number)</span></span>=<span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Seek</span><span class="params">(<span class="keyword">int</span> position)</span></span>=<span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Write</span><span class="params">(<span class="keyword">char</span> data)</span></span>=<span class="number">0</span>;    </span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">Stream</span>()&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸»ä½“ç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileStream</span>:</span> <span class="keyword">public</span> Stream&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">char</span> <span class="title">Read</span><span class="params">(<span class="keyword">int</span> number)</span></span>&#123;</span><br><span class="line">        <span class="comment">//è¯»æ–‡ä»¶æµ</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Seek</span><span class="params">(<span class="keyword">int</span> position)</span></span>&#123;</span><br><span class="line">        <span class="comment">//å®šä½æ–‡ä»¶æµ</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Write</span><span class="params">(<span class="keyword">char</span> data)</span></span>&#123;</span><br><span class="line">        <span class="comment">//å†™æ–‡ä»¶æµ</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NetworkStream</span> :</span><span class="keyword">public</span> Stream&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">char</span> <span class="title">Read</span><span class="params">(<span class="keyword">int</span> number)</span></span>&#123;</span><br><span class="line">        <span class="comment">//è¯»ç½‘ç»œæµ</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Seek</span><span class="params">(<span class="keyword">int</span> position)</span></span>&#123;</span><br><span class="line">        <span class="comment">//å®šä½ç½‘ç»œæµ</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Write</span><span class="params">(<span class="keyword">char</span> data)</span></span>&#123;</span><br><span class="line">        <span class="comment">//å†™ç½‘ç»œæµ</span></span><br><span class="line">    &#125; </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MemoryStream</span> :</span><span class="keyword">public</span> Stream&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">char</span> <span class="title">Read</span><span class="params">(<span class="keyword">int</span> number)</span></span>&#123;</span><br><span class="line">        <span class="comment">//è¯»å†…å­˜æµ</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Seek</span><span class="params">(<span class="keyword">int</span> position)</span></span>&#123;</span><br><span class="line">        <span class="comment">//å®šä½å†…å­˜æµ</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Write</span><span class="params">(<span class="keyword">char</span> data)</span></span>&#123;</span><br><span class="line">        <span class="comment">//å†™å†…å­˜æµ</span></span><br><span class="line">    &#125;  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ‰©å±•æ“ä½œ</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CryptoStream</span>:</span> <span class="keyword">public</span> Stream &#123;</span><br><span class="line">    </span><br><span class="line">    Stream* stream;<span class="comment">//...</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">CryptoStream</span>(Stream* stm):<span class="built_in">stream</span>(stm)&#123;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">char</span> <span class="title">Read</span><span class="params">(<span class="keyword">int</span> number)</span></span>&#123;</span><br><span class="line">       </span><br><span class="line">        <span class="comment">//é¢å¤–çš„åŠ å¯†æ“ä½œ...</span></span><br><span class="line">        stream-&gt;<span class="built_in">Read</span>(number);<span class="comment">//è¯»æ–‡ä»¶æµ</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Seek</span><span class="params">(<span class="keyword">int</span> position)</span></span>&#123;</span><br><span class="line">        <span class="comment">//é¢å¤–çš„åŠ å¯†æ“ä½œ...</span></span><br><span class="line">        stream::<span class="built_in">Seek</span>(position);<span class="comment">//å®šä½æ–‡ä»¶æµ</span></span><br><span class="line">        <span class="comment">//é¢å¤–çš„åŠ å¯†æ“ä½œ...</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Write</span><span class="params">(byte data)</span></span>&#123;</span><br><span class="line">        <span class="comment">//é¢å¤–çš„åŠ å¯†æ“ä½œ...</span></span><br><span class="line">        stream::<span class="built_in">Write</span>(data);<span class="comment">//å†™æ–‡ä»¶æµ</span></span><br><span class="line">        <span class="comment">//é¢å¤–çš„åŠ å¯†æ“ä½œ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BufferedStream</span> :</span> <span class="keyword">public</span> Stream&#123;</span><br><span class="line">    </span><br><span class="line">    Stream* stream;<span class="comment">//...</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">BufferedStream</span>(Stream* stm):<span class="built_in">stream</span>(stm)&#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Process</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//è¿è¡Œæ—¶è£…é…</span></span><br><span class="line">    FileStream* s1=<span class="keyword">new</span> <span class="built_in">FileStream</span>();</span><br><span class="line">    CryptoStream* s2=<span class="keyword">new</span> <span class="built_in">CryptoStream</span>(s1);   </span><br><span class="line">    BufferedStream* s3=<span class="keyword">new</span> <span class="built_in">BufferedStream</span>(s1);</span><br><span class="line">    BufferedStream* s4=<span class="keyword">new</span> <span class="built_in">BufferedStream</span>(s2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/img/PatternDesign/05_03.png" alt="ç»§æ‰¿æ–¹å¼"><br>å¯ä»¥çœ‹å‡ºCryptoStreamç±»å’ŒBufferedStreamç±»éƒ½å«æœ‰ç›¸åŒçš„StreamæŒ‡é’ˆæˆå‘˜ï¼Œå¯ä»¥ç»§ç»­å‘ä¸Šåˆå¹¶</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä¸šåŠ¡æ“ä½œ</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stream</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>ï¼š</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">char</span> <span class="title">Read</span><span class="params">(<span class="keyword">int</span> number)</span></span>=<span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Seek</span><span class="params">(<span class="keyword">int</span> position)</span></span>=<span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Write</span><span class="params">(<span class="keyword">char</span> data)</span></span>=<span class="number">0</span>; </span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">Stream</span>()&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸»ä½“ç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileStream</span>:</span> <span class="keyword">public</span> Stream&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">char</span> <span class="title">Read</span><span class="params">(<span class="keyword">int</span> number)</span></span>&#123;</span><br><span class="line">        <span class="comment">//è¯»æ–‡ä»¶æµ</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Seek</span><span class="params">(<span class="keyword">int</span> position)</span></span>&#123;</span><br><span class="line">        <span class="comment">//å®šä½æ–‡ä»¶æµ</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Write</span><span class="params">(<span class="keyword">char</span> data)</span></span>&#123;</span><br><span class="line">        <span class="comment">//å†™æ–‡ä»¶æµ</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NetworkStream</span> :</span><span class="keyword">public</span> Stream&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">char</span> <span class="title">Read</span><span class="params">(<span class="keyword">int</span> number)</span></span>&#123;</span><br><span class="line">        <span class="comment">//è¯»ç½‘ç»œæµ</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Seek</span><span class="params">(<span class="keyword">int</span> position)</span></span>&#123;</span><br><span class="line">        <span class="comment">//å®šä½ç½‘ç»œæµ</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Write</span><span class="params">(<span class="keyword">char</span> data)</span></span>&#123;</span><br><span class="line">        <span class="comment">//å†™ç½‘ç»œæµ</span></span><br><span class="line">    &#125;   </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MemoryStream</span> :</span><span class="keyword">public</span> Stream&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">char</span> <span class="title">Read</span><span class="params">(<span class="keyword">int</span> number)</span></span>&#123;</span><br><span class="line">        <span class="comment">//è¯»å†…å­˜æµ</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Seek</span><span class="params">(<span class="keyword">int</span> position)</span></span>&#123;</span><br><span class="line">        <span class="comment">//å®šä½å†…å­˜æµ</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Write</span><span class="params">(<span class="keyword">char</span> data)</span></span>&#123;</span><br><span class="line">        <span class="comment">//å†™å†…å­˜æµ</span></span><br><span class="line">    &#125;    </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ‰©å±•æ“ä½œ</span></span><br><span class="line"></span><br><span class="line">DecoratorStream: <span class="keyword">public</span> Stream&#123;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    Stream* stream;<span class="comment">//...</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">DecoratorStream</span>(Stream * stm):<span class="built_in">stream</span>(stm)&#123;</span><br><span class="line">    &#125;    </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CryptoStream</span>:</span> <span class="keyword">public</span> DecoratorStream &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">CryptoStream</span>(Stream* stm):<span class="built_in">DecoratorStream</span>(stm)&#123;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">char</span> <span class="title">Read</span><span class="params">(<span class="keyword">int</span> number)</span></span>&#123;     </span><br><span class="line">        <span class="comment">//é¢å¤–çš„åŠ å¯†æ“ä½œ...</span></span><br><span class="line">        stream-&gt;<span class="built_in">Read</span>(number);<span class="comment">//è¯»æ–‡ä»¶æµ</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Seek</span><span class="params">(<span class="keyword">int</span> position)</span></span>&#123;</span><br><span class="line">        <span class="comment">//é¢å¤–çš„åŠ å¯†æ“ä½œ...</span></span><br><span class="line">        stream::<span class="built_in">Seek</span>(position);<span class="comment">//å®šä½æ–‡ä»¶æµ</span></span><br><span class="line">        <span class="comment">//é¢å¤–çš„åŠ å¯†æ“ä½œ...</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Write</span><span class="params">(byte data)</span></span>&#123;</span><br><span class="line">        <span class="comment">//é¢å¤–çš„åŠ å¯†æ“ä½œ...</span></span><br><span class="line">        stream::<span class="built_in">Write</span>(data);<span class="comment">//å†™æ–‡ä»¶æµ</span></span><br><span class="line">        <span class="comment">//é¢å¤–çš„åŠ å¯†æ“ä½œ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BufferedStream</span> :</span> <span class="keyword">public</span> DecoratorStream&#123;    </span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">BufferedStream</span>(Stream* stm):<span class="built_in">DecoratorStream</span>(stm)&#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Process</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//è¿è¡Œæ—¶è£…é…</span></span><br><span class="line">    FileStream* s1=<span class="keyword">new</span> <span class="built_in">FileStream</span>();    </span><br><span class="line">    CryptoStream* s2=<span class="keyword">new</span> <span class="built_in">CryptoStream</span>(s1);    </span><br><span class="line">    BufferedStream* s3=<span class="keyword">new</span> <span class="built_in">BufferedStream</span>(s1);  </span><br><span class="line">    BufferedStream* s4=<span class="keyword">new</span> <span class="built_in">BufferedStream</span>(s2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“">æ€»ç»“</h2><ol><li><p>é€šè¿‡é‡‡ç”¨ç»„åˆè€Œéç»§æ‰¿çš„æ‰‹æ³•ï¼ŒDecoratoræ¨¡å¼å®ç°äº†åœ¨è¿è¡Œæ—¶åŠ¨æ€æ‰©å±•å¯¹è±¡åŠŸèƒ½çš„èƒ½åŠ›ï¼Œè€Œä¸”å¯ä»¥æ ¹æ®éœ€è¦æ‰©å±•å¤šä¸ªåŠŸèƒ½ã€‚é¿å…äº†ä½¿ç”¨ç»§æ‰¿å¸¦æ¥çš„â€œçµæ´»æ€§å·®â€™â€™å’Œâ€œå¤šå­ç±»è¡ç”Ÿé—®é¢˜â€ã€‚</p></li><li><p>Decoratorç±»åœ¨æ¥å£ä¸Šè¡¨ç°ä¸ºis-a Componentçš„ç»§æ‰¿å…³ç³»ï¼Œå³Decoratorç±»ç»§æ‰¿äº†Componentç±»æ‰€å…·æœ‰çš„æ¥å£ã€‚ä½†åœ¨å®ç°ä¸Šåˆè¡¨ç°ä¸ºhas-a Componentçš„ç»„åˆå…³ç³»ï¼Œå³Decoratorç±»åˆä½¿ç”¨äº†å¦å¤–ä¸€ä¸ªComponentç±»ã€‚</p></li><li><p>Decoratoræ¨¡å¼çš„ç›®çš„å¹¶éè§£å†³â€œå¤šå­ç±»è¡ç”Ÿçš„å¤šç»§æ‰¿â€é—®é¢˜ï¼ŒDecoratoræ¨¡å¼åº”ç”¨çš„è¦ç‚¹åœ¨äºè§£å†³â€œä¸»ä½“ç±»åœ¨å¤šä¸ªæ–¹å‘ä¸Šçš„æ‰©å±•åŠŸèƒ½â€ä¸€æ˜¯ä¸ºâ€œè£…é¥°â€çš„å«ä¹‰</p></li></ol><p><img src="/img/PatternDesign/PatternDesign05.png" alt="ç»“æ„"></p>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼(å››)- Observer/Event</title>
      <link href="/2021/11/03/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F04/"/>
      <url>/2021/11/03/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F04/</url>
      
        <content type="html"><![CDATA[<h2 id="è®¾è®¡åŠ¨æœº">è®¾è®¡åŠ¨æœº</h2><ol><li>åœ¨è½¯ä»¶æ„å»ºè¿‡ç¨‹ä¸­,æˆ‘ä»¬éœ€è¦ä¸ºæŸäº›å¯¹è±¡å»ºç«‹ä¸€ç§ &quot;é€šçŸ¥ä¾èµ–å…³ç³»â€ï¼šä¸€ä¸ªå¯¹è±¡(ç›®æ ‡å¯¹è±¡)çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜,æ‰€æœ‰çš„ä¾èµ–å¯¹è±¡(è§‚å¯Ÿè€…å¯¹è±¡)éƒ½å°†å¾—åˆ°é€šçŸ¥ã€‚å¦‚æœè¿™æ ·çš„ä¾èµ–å…³ç³»è¿‡äºç´§å¯†å°†ä½¿è½¯ä»¶ä¸èƒ½å¾ˆå¥½åœ°æŠµå¾¡å˜åŒ–</li><li>ä½¿ç”¨é¢å‘å¯¹è±¡æŠ€æœ¯,å¯ä»¥å°†è¿™ç§ä¾èµ–å…³ç³»å¼±åŒ–,å¹¶å½¢æˆä¸€ç§ç¨³å®šçš„ä¾èµ–å…³ç³»ã€‚ä»è€Œå®ç°è½¯ä»¶ä½“ç³»ç»“æ„çš„æ¾è€¦åˆ</li></ol><h2 id="å®šä¹‰">å®šä¹‰</h2><blockquote><p>å®šä¹‰å¯¹è±¡é—´çš„ä¸€ç§ä¸€å¯¹å¤š(å˜åŒ–)çš„ä¾èµ–å…³ç³»,ä»¥ä¾¿å½“ä¸€ä¸ªå¯¹è±¡(Subject)çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶,æ‰€æœ‰ä¾èµ–äºå®ƒçš„å¯¹è±¡éƒ½å¾—åˆ°é€šçŸ¥å¹¶è‡ªåŠ¨æ›´æ–°</p></blockquote><h2 id="ç»“æ„">ç»“æ„</h2><p><img src="/img/PatternDesign/04_01.png" alt="ç»“æ„"></p><h2 id="ä¾‹å­">ä¾‹å­</h2><h3 id="ä¼ ç»Ÿé€šçŸ¥æ¨¡å¼">ä¼ ç»Ÿé€šçŸ¥æ¨¡å¼</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//FileSplitter1.cpp</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileSplitter</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">string m_filePath;</span><br><span class="line"><span class="keyword">int</span> m_fileNumber;</span><br><span class="line">ProgressBar* m_progressBar;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">FileSplitter</span>(<span class="keyword">const</span> string&amp; filePath, <span class="keyword">int</span> fileNumber, ProgressBar* progressBar) :</span><br><span class="line"><span class="built_in">m_filePath</span>(filePath), </span><br><span class="line"><span class="built_in">m_fileNumber</span>(fileNumber),</span><br><span class="line"><span class="built_in">m_progressBar</span>(progressBar)&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">split</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//1.è¯»å–å¤§æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//2.åˆ†æ‰¹æ¬¡å‘å°æ–‡ä»¶ä¸­å†™å…¥</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m_fileNumber; i++)&#123;</span><br><span class="line"><span class="comment">//...</span></span><br><span class="line"><span class="keyword">float</span> progressValue = m_fileNumber;</span><br><span class="line">progressValue = (i + <span class="number">1</span>) / progressValue;</span><br><span class="line">m_progressBar-&gt;<span class="built_in">setValue</span>(progressValue);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MainForm1.cpp</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainForm</span> :</span> <span class="keyword">public</span> Form</span><br><span class="line">&#123;</span><br><span class="line">TextBox* txtFilePath;</span><br><span class="line">TextBox* txtFileNumber;</span><br><span class="line">ProgressBar* progressBar;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Button1_Click</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">string filePath = txtFilePath-&gt;<span class="built_in">getText</span>();</span><br><span class="line"><span class="keyword">int</span> number = <span class="built_in">atoi</span>(txtFileNumber-&gt;<span class="built_in">getText</span>().<span class="built_in">c_str</span>());</span><br><span class="line"></span><br><span class="line"><span class="function">FileSplitter <span class="title">splitter</span><span class="params">(filePath, number, progressBar)</span></span>;</span><br><span class="line"></span><br><span class="line">splitter.<span class="built_in">split</span>();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="è§‚å¯Ÿè€…æ¨¡å¼">è§‚å¯Ÿè€…æ¨¡å¼</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//FileSplitter2.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//è§‚å¯Ÿè€…åŸºç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IProgress</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">DoProgress</span><span class="params">(<span class="keyword">float</span> value)</span></span>=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">virtual</span> ~<span class="built_in">IProgress</span>()&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileSplitter</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">string m_filePath;</span><br><span class="line"><span class="keyword">int</span> m_fileNumber;</span><br><span class="line"></span><br><span class="line">List&lt;IProgress*&gt;  m_iprogressList; <span class="comment">// æŠ½è±¡é€šçŸ¥æœºåˆ¶ï¼Œæ”¯æŒå¤šä¸ªè§‚å¯Ÿè€…</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">FileSplitter</span>(<span class="keyword">const</span> string&amp; filePath, <span class="keyword">int</span> fileNumber) :</span><br><span class="line"><span class="built_in">m_filePath</span>(filePath), </span><br><span class="line"><span class="built_in">m_fileNumber</span>(fileNumber)&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">split</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//1.è¯»å–å¤§æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//2.åˆ†æ‰¹æ¬¡å‘å°æ–‡ä»¶ä¸­å†™å…¥</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m_fileNumber; i++)&#123;</span><br><span class="line"><span class="comment">//...</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">float</span> progressValue = m_fileNumber;</span><br><span class="line">progressValue = (i + <span class="number">1</span>) / progressValue;</span><br><span class="line"><span class="built_in">onProgress</span>(progressValue);<span class="comment">//å‘é€é€šçŸ¥</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addIProgress</span><span class="params">(IProgress* iprogress)</span></span>&#123;</span><br><span class="line">m_iprogressList.<span class="built_in">push_back</span>(iprogress);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">removeIProgress</span><span class="params">(IProgress* iprogress)</span></span>&#123;</span><br><span class="line">m_iprogressList.<span class="built_in">remove</span>(iprogress);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">onProgress</span><span class="params">(<span class="keyword">float</span> value)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">List&lt;IProgress*&gt;::iterator itor=m_iprogressList.<span class="built_in">begin</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (itor != m_iprogressList.<span class="built_in">end</span>() )</span><br><span class="line">(*itor)-&gt;<span class="built_in">DoProgress</span>(value); <span class="comment">//æ›´æ–°è¿›åº¦æ¡</span></span><br><span class="line">itor++;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MainForm2.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//å¤šç»§æ‰¿ï¼ŒFromä¸ºä¸»ç»§æ‰¿ï¼Œç»§æ‰¿é€šçŸ¥åŸºç±»åªä¸ºä½¿ç”¨å…¶æä¾›çš„æ¥å£</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainForm</span> :</span> <span class="keyword">public</span> Form, <span class="keyword">public</span> IProgress</span><br><span class="line">&#123;</span><br><span class="line">TextBox* txtFilePath;</span><br><span class="line">TextBox* txtFileNumber;</span><br><span class="line"></span><br><span class="line">ProgressBar* progressBar;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Button1_Click</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">string filePath = txtFilePath-&gt;<span class="built_in">getText</span>();</span><br><span class="line"><span class="keyword">int</span> number = <span class="built_in">atoi</span>(txtFileNumber-&gt;<span class="built_in">getText</span>().<span class="built_in">c_str</span>());</span><br><span class="line"></span><br><span class="line">ConsoleNotifier cn;</span><br><span class="line"></span><br><span class="line"><span class="function">FileSplitter <span class="title">splitter</span><span class="params">(filePath, number)</span></span>;</span><br><span class="line"></span><br><span class="line">splitter.<span class="built_in">addIProgress</span>(<span class="keyword">this</span>); </span><br><span class="line">splitter.<span class="built_in">addIProgress</span>(&amp;cn);</span><br><span class="line"></span><br><span class="line">splitter.<span class="built_in">split</span>();</span><br><span class="line"></span><br><span class="line">splitter.<span class="built_in">removeIProgress</span>(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">DoProgress</span><span class="params">(<span class="keyword">float</span> value)</span></span>&#123;</span><br><span class="line">progressBar-&gt;<span class="built_in">setValue</span>(value);</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConsoleNotifier</span> :</span> <span class="keyword">public</span> IProgress &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">DoProgress</span><span class="params">(<span class="keyword">float</span> value)</span></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;.&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“">æ€»ç»“</h2><ol><li>ä½¿ç”¨é¢å‘å¯¹è±¡çš„æŠ½è±¡, Observeræ¨¡å¼ä½¿å¾—æˆ‘ä»¬å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜ç›®æ ‡ä¸è§‚å¯Ÿè€…,ä»è€Œä½¿äºŒè€…ä¹‹é—´çš„ä¾èµ–å…³ç³»è¾¾è‡´æ¾è€¦åˆ</li><li>ç›®æ ‡å‘é€é€šçŸ¥æ—¶,æ— éœ€æŒ‡å®šè§‚å¯Ÿè€…,é€šçŸ¥(å¯ä»¥æºå¸¦é€šçŸ¥ä¿¡æ¯ä½œä¸ºå‚æ•°)ä¼šè‡ªåŠ¨ä¼ æ’­</li><li>è§‚å¯Ÿè€…è‡ªå·±å†³å®šæ˜¯å¦éœ€è¦è®¢é˜…é€šçŸ¥,ç›®æ ‡å¯¹è±¡å¯¹æ­¤ä¸€æ— æ‰€çŸ¥</li><li>Observeræ¨¡å¼æ˜¯åŸºäºäº‹ä»¶çš„UIæ¡†æ¶ä¸­éå¸¸å¸¸ç”¨çš„è®¾è®¡æ¨¡å¼ï¼Œä¹Ÿæ˜¯MVCæ¨¡å¼çš„ä¸€ä¸ªé‡è¦ç»„æˆéƒ¨åˆ†</li></ol><p><img src="/img/PatternDesign/PatternDesign04.png" alt="PatternDesign04"></p>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼(ä¸‰)- Strategy</title>
      <link href="/2021/11/03/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F03/"/>
      <url>/2021/11/03/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F03/</url>
      
        <content type="html"><![CDATA[<h2 id="è®¾è®¡åŠ¨æœº">è®¾è®¡åŠ¨æœº</h2><ol><li>å¯¹è±¡ä½¿ç”¨çš„ç®—æ³•å¤šå˜ï¼Œè‹¥éƒ½ç¼–ç åœ¨å¯¹è±¡ä¸­ï¼Œä½¿å¾—å¯¹è±¡å¤æ‚</li><li>è¿è¡Œæ—¶æ ¹æ®éœ€è¦é€æ˜çš„æ›´æ”¹å¯¹è±¡ç®—æ³•ï¼Œå°†ç®—æ³•ä¸å¯¹è±¡æœ¬èº«è§£è€¦</li></ol><h2 id="å®šä¹‰">å®šä¹‰</h2><blockquote><p>å®šä¹‰ä¸€ç³»åˆ—ç®—æ³•ï¼ŒæŠŠå®ƒä»¬ä¸€ä¸ªä¸ªå°è£…èµ·æ¥ï¼Œå¹¶ä¸”ä½¿å®ƒä»¬å¯äº’ç›¸æ›¿æ¢((å˜åŒ–)ã€‚è¯¥æ¨¡å¼ä½¿å¾—ç®—æ³•å¯ç‹¬ç«‹äºä½¿ç”¨å®ƒçš„å®¢æˆ·ç¨‹åºç¨³å®š)è€Œå˜åŒ–(æ‰©å±•ï¼Œå­ç±»åŒ–)ã€‚</p></blockquote><h2 id="ç»“æ„">ç»“æ„</h2><p><img src="/img/PatternDesign/03_01.png" alt="ç»“æ„"></p><h2 id="ä¾‹å­">ä¾‹å­</h2><h3 id="ä¼ ç»Ÿåˆ†è€Œæ²»ä¹‹">ä¼ ç»Ÿåˆ†è€Œæ²»ä¹‹</h3><p>é‡‡ç”¨å¤§é‡çš„if-elseè¯­å¥è¿›è¡Œæƒ…å†µçš„é€‰æ‹©ï¼Œåœ¨ç¼–è¯‘é˜¶æ®µä»£ç æ— æ³•å®ç°å¤ç”¨ã€‚æ¯æ¬¡éœ€è¦å¢æ·»ä¸€ç§è´§å¸çš„è®¡ç®—æ–¹å¼æ—¶ï¼Œéƒ½å¿…é¡»åœ¨æºä»£ç ä¸‹æ–¹å¢æ·»if-elseæ¥å®ç°ç›¸å…³ç­–ç•¥çš„é€‰æ‹©</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">TaxBase</span> &#123;</span></span><br><span class="line">CN_Tax,</span><br><span class="line">US_Tax,</span><br><span class="line">DE_Tax,</span><br><span class="line">FR_Tax       <span class="comment">//Â¸Ã¼Â¸Ã„</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SalesOrder</span>&#123;</span></span><br><span class="line">    TaxBase tax;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">CalculateTax</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (tax == CN_Tax)&#123;</span><br><span class="line">            <span class="comment">//CN***********</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (tax == US_Tax)&#123;</span><br><span class="line">            <span class="comment">//US***********</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (tax == DE_Tax)&#123;</span><br><span class="line">            <span class="comment">//DE***********</span></span><br><span class="line">        &#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (tax == FR_Tax)&#123;  <span class="comment">//Â¸Ã¼Â¸Ã„</span></span><br><span class="line"><span class="comment">//...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//....</span></span><br><span class="line">     &#125;</span><br><span class="line">    </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="é‡‡ç”¨ç­–ç•¥æ¨¡å¼">é‡‡ç”¨ç­–ç•¥æ¨¡å¼</h3><p>æ„å»ºç­–ç•¥åŸºç±»ï¼Œæ‰€æœ‰çœŸå®æƒ…å†µçš„è´§å¸ç±»éƒ½æ˜¯è¯¥ç­–ç•¥åŸºç±»çš„æ´¾ç”Ÿç±»ï¼Œåˆ©ç”¨å¤šæ€æœºåˆ¶å®ç°ç­–ç•¥çš„é€‰æ‹©</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç­–ç•¥åŸºç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TaxStrategy</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//è™šå‡½æ•° æä¾›ç­–ç•¥æ¥å£</span></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">double</span> <span class="title">Calculate</span><span class="params">(<span class="keyword">const</span> Context&amp; context)</span></span>=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">TaxStrategy</span>()&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CNTax</span> :</span> <span class="keyword">public</span> TaxStrategy&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//é’ˆå¯¹è‡ªèº«æä¾›ä¸ä¹‹ç›¸å¯¹çš„ç­–ç•¥</span></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">double</span> <span class="title">Calculate</span><span class="params">(<span class="keyword">const</span> Context&amp; context)</span></span>&#123;</span><br><span class="line">        <span class="comment">//***********</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">USTax</span> :</span> <span class="keyword">public</span> TaxStrategy&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">double</span> <span class="title">Calculate</span><span class="params">(<span class="keyword">const</span> Context&amp; context)</span></span>&#123;</span><br><span class="line">        <span class="comment">//***********</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DETax</span> :</span> <span class="keyword">public</span> TaxStrategy&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">double</span> <span class="title">Calculate</span><span class="params">(<span class="keyword">const</span> Context&amp; context)</span></span>&#123;</span><br><span class="line">        <span class="comment">//***********</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//é’ˆå¯¹æ–°å¢çš„FRTax,åªéœ€è¦é‡æ–°æ´¾ç”Ÿè¯¥ç±»å¹¶å®šä¹‰ç›¸å…³ç®—æ³•å³å¯</span></span><br><span class="line"><span class="comment">//*********************************</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FRTax</span> :</span> <span class="keyword">public</span> TaxStrategy&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="keyword">double</span> <span class="title">Calculate</span><span class="params">(<span class="keyword">const</span> Context&amp; context)</span></span>&#123;</span><br><span class="line"><span class="comment">//.........</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å®ç°ç­–ç•¥æ¥å£çš„è°ƒç”¨</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SalesOrder</span>&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    TaxStrategy* strategy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">SalesOrder</span>(StrategyFactory* strategyFactory)&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;strategy = strategyFactory-&gt;<span class="built_in">NewStrategy</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    ~<span class="built_in">SalesOrder</span>()&#123;</span><br><span class="line">        <span class="keyword">delete</span> <span class="keyword">this</span>-&gt;strategy;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">CalculateTax</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">        <span class="function">Context <span class="title">context</span><span class="params">()</span></span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">double</span> val = </span><br><span class="line">            strategy-&gt;<span class="built_in">Calculate</span>(context); </span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“">æ€»ç»“</h2><ol><li><p>StrategyåŠå…¶å­ç±»ä¸ºç»„ä»¶æä¾›äº†ä¸€ç³»åˆ—å¯é‡ç”¨çš„ç®—æ³•ï¼Œä»è€Œå¯ä»¥ä½¿å¾—ç±»å‹åœ¨è¿è¡Œæ—¶æ–¹ä¾¿åœ°æ ¹æ®éœ€è¦åœ¨å„ä¸ªç®—æ³•ä¹‹é—´è¿›è¡Œåˆ‡æ¢ã€‚</p></li><li><p>Strategyæ¨¡å¼æä¾›äº†ç”¨æ¡ä»¶åˆ¤æ–­è¯­å¥ä»¥å¤–çš„å¦ä¸€ç§é€‰æ‹©ï¼Œæ¶ˆé™¤æ¡ä»¶åˆ¤æ–­è¯­è‹Ÿï¼Œå°±æ˜¯åœ¨è§£è€¦åˆã€‚å«æœ‰è®¸å¤šæ¡ä»¶åˆ¤æ–­è¯­å¥çš„ä»£ç é€šå¸¸éƒ½éœ€è¦Strategyæ¨¡å¼ã€‚(å¦‚æœif-elseæ˜¯ç»å¯¹ç¨³å®šä¸å˜çš„ï¼Œä¸å¤ªéœ€è¦strategyæ¨¡å¼)</p></li><li><p>å¦‚æœStrategyå¯¹è±¡æ²¡æœ‰å®ä¾‹å˜é‡ï¼Œé‚£ä¹ˆå„ä¸ªä¸Šä¸‹æ–‡å¯ä»¥å…±äº«åŒä¸€ä¸ªStrategyå¯¹è±¡ï¼Œä»è€ŒèŠ‚çœå¯¹è±¡å¼€é”€ã€‚</p></li></ol><p><img src="/img/PatternDesign/PatternDesign03.png" alt="PatternDesign03"></p>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼(äºŒ)- Template Mothod</title>
      <link href="/2021/11/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F02/"/>
      <url>/2021/11/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F02/</url>
      
        <content type="html"><![CDATA[<h2 id="è®¾è®¡åŠ¨æœº">è®¾è®¡åŠ¨æœº</h2><ol><li><p>æœ‰ç¨³å®šçš„æ•´ä½“ç»“æ„ï¼Œä½†å„ä¸ªå­æ­¥éª¤æœ‰æ”¹å˜çš„éœ€æ±‚</p></li><li><p>åœ¨ç¡®è®¤ç¨³å®šæ“ä½œç»“æ„å‰æä¸‹ï¼Œçµæ´»åº”å¯¹å„ä¸ªå­æ­¥éª¤çš„å˜åŒ–å’Œæ™šæœŸå®ç°éœ€æ±‚</p></li></ol><h2 id="å®šä¹‰">å®šä¹‰</h2><blockquote><p>å®šä¹‰ä¸€ä¸ªæ“ä½œä¸­çš„ç®—æ³•çš„éª¨æ¶(ç¨³å®š),è€Œå°†ä¸€äº›æ­¥éª¤å»¶è¿Ÿ(å˜åŒ–)åˆ°å­ç±»ä¸­ã€‚Template Methodä½¿å¾—å­ç±»å¯ä»¥ä¸æ”¹å˜(å¤ç”¨)ä¸€ä¸ªç®—æ³•çš„ç»“æ„å³å¯é‡å®šä¹‰(overrideé‡å†™)è¯¥ç®—æ³•çš„æŸäº›ç‰¹å®šæ­¥éª¤ã€‚</p></blockquote><h2 id="ç»“æ„">ç»“æ„</h2><p><img src="/img/PatternDesign/02_03.png" alt="ç»“æ„"></p><h2 id="ä¾‹å­">ä¾‹å­</h2><h3 id="ç»“æ„åŒ–è½¯ä»¶è®¾è®¡æµç¨‹-æ—©ç»‘å®š">ç»“æ„åŒ–è½¯ä»¶è®¾è®¡æµç¨‹(æ—©ç»‘å®š)</h3><p><img src="/img/PatternDesign/02_01.png" alt="ç»“æ„åŒ–è½¯ä»¶è®¾è®¡æµç¨‹"></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//lib.cpp</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Library</span>&#123;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Step1</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Step3</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Step5</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//app.cpp</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Application</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">Step2</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Step4</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="function">Library <span class="title">lib</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function">Application <span class="title">app</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">lib.<span class="built_in">Step1</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (app.<span class="built_in">Step2</span>())&#123;</span><br><span class="line">lib.<span class="built_in">Step3</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)&#123;</span><br><span class="line">app.<span class="built_in">Step4</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">lib.<span class="built_in">Step5</span>();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ¨¡ç‰ˆæ–¹æ³•è®¾è®¡æµç¨‹-æ™šç»‘å®š">æ¨¡ç‰ˆæ–¹æ³•è®¾è®¡æµç¨‹(æ™šç»‘å®š)</h3><p><img src="/img/PatternDesign/02_02.png" alt="æ¨¡ç‰ˆæ–¹æ³•è®¾è®¡æµç¨‹"></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//lib.cpp</span></span><br><span class="line"><span class="comment">//ç¨‹åºåº“å¼€å‘äººå‘˜</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Library</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="comment">//ç¨³å®š template method</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Run</span><span class="params">()</span></span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">Step1</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">Step2</span>()) &#123; <span class="comment">//æ”¯æŒå˜åŒ– ==&gt; è™šå‡½æ•°çš„å¤šæ€è°ƒç”¨</span></span><br><span class="line">            <span class="built_in">Step3</span>(); </span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)&#123;</span><br><span class="line">            <span class="built_in">Step4</span>(); <span class="comment">//æ”¯æŒå˜åŒ– ==&gt; è™šå‡½æ•°çš„å¤šæ€è°ƒç”¨</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">Step5</span>();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">virtual</span> ~<span class="built_in">Library</span>()&#123; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Step1</span><span class="params">()</span> </span>&#123; <span class="comment">//ç¨³å®š</span></span><br><span class="line">        <span class="comment">//.....</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Step3</span><span class="params">()</span> </span>&#123;<span class="comment">//ç¨³å®š</span></span><br><span class="line">        <span class="comment">//.....</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Step5</span><span class="params">()</span> </span>&#123; <span class="comment">//ç¨³å®š</span></span><br><span class="line"><span class="comment">//.....</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="keyword">bool</span> <span class="title">Step2</span><span class="params">()</span> </span>= <span class="number">0</span>;<span class="comment">//å˜åŒ–</span></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Step4</span><span class="params">()</span> </span>=<span class="number">0</span>; <span class="comment">//å˜åŒ–</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//app.cpp</span></span><br><span class="line"><span class="comment">//åº”ç”¨ç¨‹åºå¼€å‘äººå‘˜</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Application</span> :</span> <span class="keyword">public</span> Library &#123;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="keyword">bool</span> <span class="title">Step2</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//... å­ç±»é‡å†™å®ç°</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Step4</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">//... å­ç±»é‡å†™å®ç°</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    Library* pLib=<span class="keyword">new</span> <span class="built_in">Application</span>();</span><br><span class="line">    lib-&gt;<span class="built_in">Run</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> pLib;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“">æ€»ç»“</h2><ol><li>Template Methodæ¨¡å¼æ˜¯ä¸€ -ç§éå¸¸åŸºç¡€æ€§çš„è®¾è®¡æ¨¡å¼,åœ¨é¢å‘å¯¹è±¡ç³»ç»Ÿä¸­æœ‰ç€å¤§é‡çš„åº”ç”¨ã€‚å®ƒç”¨æœ€ç®€æ´çš„æœºåˆ¶(è™šå‡½æ•°çš„å¤šæ€æ€§)ä¸ºå¾ˆå¤šåº”ç”¨ç¨‹åºæ¡†æ¶æä¾›äº†çµæ´»çš„æ‰©å±•ç‚¹,æ˜¯ä»£ç å¤ç”¨æ–¹é¢çš„åŸºæœ¬å®ç°ç»“æ„</li><li>é™¤äº†å¯ä»¥çµæ´»åº”å¯¹å­æ­¥éª¤çš„å˜åŒ–å¤–ï¼Œâ€œä¸è¦è°ƒç”¨æˆ‘,è®©æˆ‘æ¥è°ƒç”¨å°”â€çš„åå‘æ§åˆ¶ç»“æ„æ˜¯Template Methodçš„å…¸å‹åº”ç”¨ã€‚</li><li>åœ¨å…·ä½“å®ç°æ–¹é¢,è¢«Template Methodè°ƒç”¨çš„è™šæ–¹æ³•å¯ä»¥å…·æœ‰å®ç°,ä¹Ÿå¯ä»¥æ²¡æœ‰ä»»ä½•å®ç°(æŠ½è±¡æ–¹æ³•ã€çº¯è™šæ–¹æ³•) ,ä½†ä¸€èˆ¬æ¨èå°†å®ƒä»¬è®¾ç½®ä¸ºprotectedæ–¹æ³•ã€‚<br><img src="/img/PatternDesign/PatternDesign02.png" alt="PatternDesign02"></li></ol>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼(ä¸€)-é¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™</title>
      <link href="/2021/11/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F01/"/>
      <url>/2021/11/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F01/</url>
      
        <content type="html"><![CDATA[<h2 id="è®¤è¯†é¢å‘å¯¹è±¡">è®¤è¯†é¢å‘å¯¹è±¡</h2><h3 id="ç†è§£éš”ç¦»å˜åŒ–ï¼šé¢å‘å¯¹è±¡çš„æ„å»ºæ–¹å¼æ›´èƒ½é€‚åº”è½¯ä»¶éœ€æ±‚çš„å˜åŒ–ï¼Œé™ä½å˜åŒ–å¸¦æ¥çš„å½±å“">ç†è§£éš”ç¦»å˜åŒ–ï¼šé¢å‘å¯¹è±¡çš„æ„å»ºæ–¹å¼æ›´èƒ½é€‚åº”è½¯ä»¶éœ€æ±‚çš„å˜åŒ–ï¼Œé™ä½å˜åŒ–å¸¦æ¥çš„å½±å“</h3><h3 id="å„å¸å…¶èŒ">å„å¸å…¶èŒ</h3><ul><li>æ–°å¢ç±»å‹ä¸åº”è¯¥å½±å“åŸæ¥ç±»å‹çš„å®ç°</li></ul><h3 id="ä½•ä¸ºå¯¹è±¡">ä½•ä¸ºå¯¹è±¡</h3><ul><li>è¯­è¨€å±‚æ¬¡ï¼šå¯¹è±¡å°è£…äº†ä»£ç å’Œæ•°æ®</li><li>è§„æ ¼å±‚æ¬¡ï¼šå¯¹è±¡æ˜¯å¯è¢«ä½¿ç”¨çš„å…¬å…±æ¥å£</li><li>æ¦‚å¿µå±‚æ¬¡ï¼šå¯¹è±¡æ˜¯æŸç§æ‹¥æœ‰ä»»åŠ¡çš„æŠ½è±¡</li></ul><h2 id="å…«å¤§è®¾è®¡åŸåˆ™">å…«å¤§è®¾è®¡åŸåˆ™</h2><h3 id="ä¾èµ–å€’ç½®åŸåˆ™DIP">ä¾èµ–å€’ç½®åŸåˆ™DIP</h3><ul><li>é«˜å±‚æ¨¡å—(ç¨³å®š)ä¸åº”è¯¥ä¾èµ–ä¸åº•å±‚æ¨¡å—(å˜åŒ–),éƒ½åº”è¯¥ä¾èµ–äºæŠ½è±¡(ç¨³å®š)</li><li>æŠ½è±¡(ç¨³å®š)ä¸ä¾èµ–äºå®ç°ç»†èŠ‚ï¼Œå®ç°ç»†èŠ‚ä¾èµ–äºæŠ½è±¡(ç¨³å®š)</li></ul><h3 id="å¼€æ”¾å°é—­åŸåˆ™OCP">å¼€æ”¾å°é—­åŸåˆ™OCP</h3><ul><li>å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹æ›´æ”¹å°é—­</li><li>ç±»æ¨¡å—åº”è¯¥æ˜¯å¯æ‰©å±•çš„ï¼Œä½†ä¸å¯ä¿®æ”¹</li></ul><h3 id="å•ä¸€èŒè´£åŸåˆ™SRP">å•ä¸€èŒè´£åŸåˆ™SRP</h3><ul><li>ä¸€ä¸ªç±»åº”è¯¥ä»…æœ‰ä¸€ä¸ªå¼•èµ·å®ƒå˜åŒ–çš„åŸå› </li><li>å˜åŒ–çš„æ–¹å‘éšå«ç´¯çš„è´£ä»»</li></ul><h3 id="Liskovæ›¿æ¢åŸåˆ™">Liskovæ›¿æ¢åŸåˆ™</h3><ul><li>å­ç±»å¿…é¡»èƒ½å¤Ÿæ›¿æ¢ä»–ä»¬çš„åŸºç±»(IS A)</li><li>ç»§æ‰¿è¡¨è¾¾ç±»å‹æŠ½è±¡</li></ul><h3 id="æ¥å£éš”ç¦»åŸåˆ™-ISP">æ¥å£éš”ç¦»åŸåˆ™(ISP)</h3><ul><li>æ¥å£å°è€Œå®Œå¤‡</li><li>ä¸åº”è¯¥å¼ºè¿«å®¢æˆ·ç¨‹åºä¾èµ–ä»–ä»¬ä¸ç”¨çš„æ–¹æ³•</li></ul><h3 id="ä¼˜å…ˆä½¿ç”¨å¯¹è±¡ç»„åˆï¼Œè€Œä¸æ˜¯ç±»ç»§æ‰¿">ä¼˜å…ˆä½¿ç”¨å¯¹è±¡ç»„åˆï¼Œè€Œä¸æ˜¯ç±»ç»§æ‰¿</h3><ul><li>ç±»ç»§æ‰¿é€šå¸¸ç»´ç™½ç®±å¤ç”¨ï¼Œå¯¹è±¡ç»„åˆé€šå¸¸ä¸ºé»‘ç®±å¤ç”¨</li><li>ç»§æ‰¿åœ¨æŸç§ç¨‹åº¦ä¸Šç ´åäº†å°è£…æ€§ï¼Œå­ç±»çˆ¶ç±»è€¦åˆé«˜</li><li>é¢å¯¹è±¡ç»„åˆåˆ™åªè¦æ±‚è¢«ç»„åˆçš„å¯¹è±¡å…·æœ‰è‰¯å¥½å®šä¹‰çš„æ¥å£ï¼Œè€¦åˆåº¦ä½ã€‚</li></ul><h3 id="å°è£…å˜åŒ–ç‚¹">å°è£…å˜åŒ–ç‚¹</h3><ul><li>ä½¿ç”¨å°è£…æ¥åˆ›å»ºå¯¹è±¡ä¹‹é—´çš„åˆ†ç•Œå±‚,è®©è®¾è®¡è€…å¯ä»¥åœ¨åˆ†ç•Œå±‚ä¸€ä¾§è¿›è¡Œä¿®æ”¹,è€Œä¸ä¼šå¯¹å¦ä¸€ä¾§äº§ç”Ÿä¸è‰¯çš„å½±å“,ä»è€Œå®ç°å±‚æ¬¡é—´çš„æ¾è€¦åˆã€‚</li></ul><h3 id="é’ˆå¯¹æ¥å£ç¼–ç¨‹ï¼Œè€Œéé’ˆå¯¹å®ç°ç¼–ç¨‹">é’ˆå¯¹æ¥å£ç¼–ç¨‹ï¼Œè€Œéé’ˆå¯¹å®ç°ç¼–ç¨‹</h3><ul><li>å®¢æˆ·ç¨‹åºæ— éœ€è·çŸ¥å¯¹è±¡çš„å…·ä½“ç±»å‹,åªéœ€è¦çŸ¥é“å¯¹è±¡æ‰€å…·æœ‰çš„æ¥å£</li><li>ä¸å°†å˜é‡ç±»å‹å£°æ˜ä¸ºæŸä¸ªç‰¹å®šçš„å…·ä½“ç±»,è€Œæ˜¯å£°æ˜ä¸ºæŸä¸ªæ¥å£</li><li>å‡å°‘ç³»ç»Ÿä¸­å„éƒ¨åˆ†çš„ä¾èµ–å…³ç³»,ä»è€Œå®ç°&quot;é«˜å†…èšã€æ¾è€¦åˆâ€çš„ç±»å‹è®¾è®¡æ–¹æ¡ˆ</li></ul><p><img src="/img/PatternDesign/PatternDesign01.png" alt="é¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™"></p>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C++Primerè¯»ä¹¦ç¬”è®°(ä¸€)-è®¿é—®æ§åˆ¶ä¸ç»§æ‰¿</title>
      <link href="/2021/10/27/C-Primer%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E4%B8%8E%E7%BB%A7%E6%89%BF/"/>
      <url>/2021/10/27/C-Primer%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E4%B8%8E%E7%BB%A7%E6%89%BF/</url>
      
        <content type="html"><![CDATA[<p>â€‹æ¯ä¸ªç±»é€šè¿‡æˆå‘˜<strong>è®¿é—®è¿ç®—ç¬¦</strong>æ§åˆ¶å…¶æˆå‘˜å¯¹äºæ´¾ç”Ÿç±»å’Œç±»çš„ç”¨æˆ·æ¥è¯´æ˜¯å¦æ˜¯å¯è®¿é—®çš„ã€‚</p><h3 id="å—ä¿æŠ¤çš„æˆå‘˜">å—ä¿æŠ¤çš„æˆå‘˜</h3><p>â€‹ä¸€ä¸ªç±»ä½¿ç”¨<code>protected</code>å…³é”®å­—æ¥å£°æ˜é‚£äº›å¸Œæœ›ä¸æ´¾ç”Ÿç±»åˆ†äº«ä½†ä¸æƒ³è¢«å…¶ä»–ç”¨æˆ·è®¿é—®çš„æˆå‘˜ã€‚å¯ä»¥è¯´protectedæ˜¯å¤¹åœ¨privateæˆå‘˜å’Œpublicæˆå‘˜çš„ä¸­å’Œäº§ç‰©ã€‚ä¸»è¦æœ‰ä»¥ä¸‹ä¸‰æ¡æ€§è´¨</p><ol><li>å—ä¿æŠ¤æˆå‘˜å¯¹äºç±»çš„ç”¨æˆ·è€…ä¸å¯è®¿é—®</li><li>å—ä¿æŠ¤æˆå‘˜å¯¹äºæ´¾ç”Ÿç±»çš„æˆå‘˜å’Œå‹å…ƒæ˜¯å¯è®¿é—®</li><li>æ´¾ç”Ÿç±»çš„æˆå‘˜æˆ–è€…å‹å…ƒåªèƒ½é€šè¿‡<strong>æ´¾ç”Ÿç±»å¯¹è±¡</strong>æ¥è®¿é—®åŸºç±»çš„å—ä¿æŠ¤æˆå‘˜ï¼Œæ´¾ç”Ÿç±»å¯¹äºä¸€ä¸ª<strong>åŸºç±»å¯¹è±¡</strong>ä¸­çš„å—ä¿æŠ¤æˆå‘˜æ²¡æœ‰è®¿é—®æƒé™ã€‚å³æ´¾ç”Ÿç±»çš„æˆå‘˜å’Œå‹å…ƒåªèƒ½è®¿é—®<u>æ´¾ç”Ÿç±»å¯¹è±¡ä¸­çš„åŸºç±»éƒ¨åˆ†çš„å—ä¿æŠ¤æˆå‘˜</u>(ç®¡å¥½è‡ªå®¶)ï¼Œè€Œå¯¹ä¸€ä¸ªæ™®é€šåŸºç±»å¯¹è±¡ä¸­çš„å—ä¿æŠ¤æˆå‘˜æ˜¯æ²¡æœ‰è®¿é—®æƒé™çš„ã€‚</li></ol><p>ç¬¬ä¸‰ç‚¹ä¸¾ä¾‹</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å®šä¹‰åŸºç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span>&#123;</span></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="keyword">int</span> prot_mem;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//å®šä¹‰æ´¾ç”Ÿç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sneaky</span>:</span> <span class="keyword">public</span> Base&#123;</span><br><span class="line">    <span class="function"><span class="keyword">friend</span> <span class="keyword">void</span> <span class="title">clobber</span><span class="params">(Sneaky&amp;)</span></span>;<span class="comment">//èƒ½è®¿é—®Sneaky::prot_mem</span></span><br><span class="line">    <span class="function"><span class="keyword">friend</span> <span class="keyword">void</span> <span class="title">clobber</span><span class="params">(Base&amp;)</span></span>;   <span class="comment">//ä¸èƒ½è®¿é—®Base::proe_mem å¯¹äºä¸€ä¸ªåŸºç±»å¯¹è±¡ä¸­çš„å—ä¿æŠ¤æˆå‘˜æ²¡æœ‰è®¿é—®æƒé™</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><table><thead><tr><th></th><th style="text-align:center">ç±»æœ¬èº«</th><th style="text-align:center">ç±»çš„å®ä¾‹åŒ–å¯¹è±¡(ç±»çš„ç”¨æˆ·)</th><th style="text-align:center">ç±»çš„æ´¾ç”Ÿ</th></tr></thead><tbody><tr><td>publicæˆå‘˜</td><td style="text-align:center">âˆš</td><td style="text-align:center">âˆš</td><td style="text-align:center">âˆš</td></tr><tr><td>privateæˆå‘˜</td><td style="text-align:center">âˆš</td><td style="text-align:center">X</td><td style="text-align:center">X</td></tr><tr><td>protectedæˆå‘˜</td><td style="text-align:center">âˆš</td><td style="text-align:center">X</td><td style="text-align:center">âˆš</td></tr></tbody></table><p>âˆšè¡¨ç¤ºå¯è®¿é—®ï¼ŒXè¡¨ç¤ºä¸å¯è®¿é—®</p><h3 id="ä¸‰ç§ç»§æ‰¿æ–¹å¼â€”â€”å…¬æœ‰ã€ç§æœ‰å’Œå—ä¿æŠ¤ç»§æ‰¿">ä¸‰ç§ç»§æ‰¿æ–¹å¼â€”â€”å…¬æœ‰ã€ç§æœ‰å’Œå—ä¿æŠ¤ç»§æ‰¿</h3><p>â€‹ä¸åŠ å£°æ˜ï¼Œclassé»˜è®¤ç§æœ‰ç»§æ‰¿ï¼Œstructé»˜è®¤å…¬æœ‰ç»§æ‰¿</p><p>â€‹ç±»å¯¹å…¶ç»§æ‰¿è€Œæ¥çš„æˆå‘˜çš„è®¿é—®æƒé™æ”¶åˆ°ä¸¤ä¸ªå› ç´ å½±å“ï¼š1.åŸºç±»ä¸­çš„æˆå‘˜è®¿é—®ç¬¦ 2. æ´¾ç”Ÿåˆ—è¡¨çš„è®¿é—®è¯´æ˜ç¬¦</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å®šä¹‰åŸºç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">pub_mem</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">char</span> priv_mem;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="keyword">int</span> prop_men;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å®šä¹‰å…¬æœ‰æ´¾ç”Ÿ</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pub_Derv</span>:</span><span class="keyword">public</span> Base&#123;</span><br><span class="line">  <span class="comment">//æ­£ç¡®ï¼Œå¯è®¿é—®åŸºç±»éƒ¨åˆ†çš„å—ä¿æŠ¤æˆå‘˜</span></span><br><span class="line">  <span class="function"><span class="keyword">int</span> <span class="title">f</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> prop_men;&#125;</span><br><span class="line">    </span><br><span class="line">  <span class="comment">//é”™è¯¯ï¼Œä¸èƒ½è®¿é—®åŸºç±»éƒ¨åˆ†çš„ç§æœ‰æˆå‘˜</span></span><br><span class="line">  <span class="comment">//char g()&#123;return priv_mem;&#125;    </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å®šä¹‰ç§æœ‰æ´¾ç”Ÿ</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pri_Derv</span>:</span><span class="keyword">private</span> Base&#123;</span><br><span class="line">  <span class="comment">//æ­£ç¡®ï¼Œæ´¾ç”Ÿåˆ—è¡¨ä¸­è®¿é—®è¯´æ˜ç¬¦ä¸å½±å“æ´¾ç”Ÿç±»å¯¹äºåŸºç±»éƒ¨åˆ†çš„è®¿é—®æƒé™</span></span><br><span class="line">  <span class="function"><span class="keyword">int</span> <span class="title">f1</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> prop_men;&#125;      </span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>â€‹æ´¾ç”Ÿåˆ—è¡¨çš„è®¿é—®è¯´æ˜ç¬¦ä¸å½±å“æ´¾ç”Ÿç±»å¯¹åŸºç±»éƒ¨åˆ†æˆå‘˜çš„è®¿é—®æƒé™ï¼Œè¿™åªä¸åŸºç±»ä¸­çš„æˆå‘˜è®¿é—®ç¬¦æœ‰å…³ï¼Œæ´¾ç”Ÿåˆ—è¡¨ä¸­çš„è®¿é—®è¯´æ˜ç¬¦çš„ç›®çš„æ˜¯</p><p>æ§åˆ¶æ´¾ç”Ÿç±»ç”¨æˆ·(åŒ…æ‹¬æ´¾ç”Ÿç±»çš„æ´¾ç”Ÿ)å¯¹äº<strong>åŸºç±»æˆå‘˜</strong>çš„è®¿é—®æƒé™</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Pub_Derv d1;</span><br><span class="line">Pri_Derv d2;</span><br><span class="line">d1.<span class="built_in">pub_mem</span>();<span class="comment">//æ­£ç¡®</span></span><br><span class="line"><span class="comment">//d2.pub_mem()  //é”™è¯¯ï¼Œç»è¿‡ç§æœ‰ç»§æ‰¿åï¼ŒåŸºç±»ä¸­çš„å…¬æœ‰æˆå‘˜å¯¹äºæ´¾ç”Ÿç±»ç”¨æˆ·ä¸å¯è®¿é—®</span></span><br></pre></td></tr></table></figure><h3 id="æ´¾ç”Ÿç±»å‘åŸºç±»è½¬æ¢çš„å¯è®¿é—®æ€§">æ´¾ç”Ÿç±»å‘åŸºç±»è½¬æ¢çš„å¯è®¿é—®æ€§</h3><p>æ´¾ç”Ÿç±»å‘åŸºç±»è½¬æ¢: åŸºç±»çš„æŒ‡é’ˆæŒ‡å‘æ´¾ç”Ÿç±»æˆ–è€…åŸºç±»çš„å¼•ç”¨ç»‘å®šåˆ°æ´¾ç”Ÿç±»å¯¹è±¡(å®é™…ä¸Šæ˜¯æŒ‡å‘æˆ–è€…ç»‘å®šåˆ°æ´¾ç”Ÿç±»çš„åŸºç±»éƒ¨åˆ†)</p><ul><li>åªæœ‰å½“æ´¾ç”Ÿç±»å…¬æœ‰çš„ç»§æ‰¿åŸºç±»ï¼Œ<strong>ç”¨æˆ·ä»£ç </strong>æ‰èƒ½ä½¿ç”¨æ´¾ç”Ÿç±»å‘åŸºç±»è½¬æ¢ã€‚ç§æœ‰å’Œä¿æŠ¤ç»§æ‰¿éƒ½ä¸è¡Œ</li><li>æ´¾ç”Ÿç±»çš„<strong>æˆå‘˜å‡½æ•°å’Œå‹å…ƒ</strong>éƒ½èƒ½ä½¿ç”¨æ´¾ç”Ÿç±»å‘åŸºç±»çš„è½¬æ¢ï¼Œä¸ç»§æ‰¿æ–¹å¼æ— å…³</li><li>å¦‚æœæ´¾ç”Ÿç±»æ˜¯å…¬æœ‰æˆ–è€…ä¿æŠ¤ç»§æ‰¿åŸºç±»ï¼Œé‚£ä¹ˆæ´¾ç”Ÿç±»çš„æ´¾ç”Ÿç±»çš„æˆå‘˜å‡½æ•°å’Œå‹å…ƒå¯ä»¥å®ç°æ´¾ç”Ÿç±»å‘å…¶åŸºç±»çš„è½¬æ¢</li></ul><p>ç±»çš„è®¾è®¡å°tip</p><p>â€‹ç±»æœ‰ä¸‰ç§ç”¨æˆ·ï¼šç±»çš„å®ç°è€…ã€æ´¾ç”Ÿç±»ä»¥åŠç±»çš„ä½¿ç”¨è€…ã€‚åŸºç±»åº”è¯¥å°†æ¥å£æˆå‘˜å£°æ˜ä¸ºå…¬æœ‰ï¼›åŒæ—¶å°†å®ç°éƒ¨åˆ†åˆ†æˆä¸¤ç»„ï¼š1.å£°æ˜ä¸º<code>protected</code>ä¾›æ´¾ç”Ÿç±»è®¿é—® 2. å£°æ˜ä¸º<code>private</code>å…±åŸºç±»è‡ªèº«å’ŒåŸºç±»çš„å‹å…ƒè®¿é—®</p><table><thead><tr><th>ç±»çš„ç”¨æˆ·</th><th>è®¿é—®æƒé™</th></tr></thead><tbody><tr><td>ç±»çš„å®ç°è€…</td><td>å…¨éƒ¨</td></tr><tr><td>ç±»çš„ä½¿ç”¨è€…</td><td>ç±»çš„å…¬å…±æ¥å£</td></tr><tr><td>æ´¾ç”Ÿç±»</td><td>ç±»çš„ä¿æŠ¤æˆå‘˜</td></tr></tbody></table><h3 id="å‹å…ƒä¸ç»§æ‰¿">å‹å…ƒä¸ç»§æ‰¿</h3><p>â€‹å‹å…ƒå…³ç³»ä¸èƒ½ä¼ é€’ä¹Ÿä¸èƒ½ç»§æ‰¿ï¼Œ<strong>æ¯ä¸ªç±»è´Ÿè´£è‡ªå·±çš„æˆå‘˜çš„è®¿é—®æƒé™</strong>ã€‚åŸºç±»çš„å‹å…ƒåªèƒ½è®¿é—®åŸºç±»ï¼Œä¸èƒ½è®¿é—®å®ƒçš„æ´¾ç”Ÿç±»æœ¬èº«æˆå‘˜ï¼Œä½†æ˜¯å¯ä»¥è®¿é—®æ´¾ç”Ÿç±»ä¸­çš„åŸºç±»éƒ¨åˆ†çš„æˆå‘˜ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span>&#123;</span></span><br><span class="line">    <span class="keyword">friend</span> <span class="class"><span class="keyword">class</span> <span class="title">Pal</span>;</span><span class="comment">//å‹å…ƒå£°æ˜</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pal</span>&#123;</span></span><br><span class="line">  <span class="function"><span class="keyword">int</span> <span class="title">f</span><span class="params">(Base b)</span></span>&#123;<span class="keyword">return</span> b.prot_mem;&#125;<span class="comment">//æ­£ç¡®</span></span><br><span class="line"><span class="comment">//int f2(Sneaky s)&#123;return s.j;&#125;//é”™è¯¯ ä¸èƒ½è®¿é—®æ´¾ç”Ÿç±»æœ¬èº«æˆå‘˜</span></span><br><span class="line">  <span class="function"><span class="keyword">int</span> <span class="title">f3</span><span class="params">(Sneaky s)</span></span>&#123;<span class="keyword">return</span> s.prot_mem;&#125; <span class="comment">//æ­£ç¡®,å¯ä»¥è®¿é—®æ´¾ç”Ÿç±»ä¸­çš„åŸºç±»éƒ¨åˆ†çš„æˆå‘˜</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> C++Primerè¯»ä¹¦ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
            <tag> è¯»ä¹¦ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MoreEffectiveC++(ä¸€)</title>
      <link href="/2021/10/26/MoreEffectiveC/"/>
      <url>/2021/10/26/MoreEffectiveC/</url>
      
        <content type="html"><![CDATA[<h1>ä¸€ã€åŸºç¡€ Basics</h1><h2 id="æ¡æ¬¾1-æŒ‡é’ˆ-pointer-ä¸å¼•ç”¨-reference-çš„é€‰æ‹©">æ¡æ¬¾1 æŒ‡é’ˆ(pointer)ä¸å¼•ç”¨(reference)çš„é€‰æ‹©</h2><p>1.pointerå¯ä»¥ä¸ºç©ºï¼Œä½†referenceä¸èƒ½</p><p>å› æ­¤å¯¹äºä¸€ä¸ªå˜é‡å¦‚æœæ€»æ˜¯ä»£è¡¨ä¸€ä¸ªå¯¹è±¡ï¼Œåˆ™åº”è¯¥è¯¥è€ƒè™‘ä¸ºreference</p><p>ä¸”ä½¿ç”¨referenceä¸éœ€è¦æµ‹è¯•å…¶æœ‰æ•ˆæ€§ï¼Œæ•ˆç‡æ›´é«˜ã€‚ä½¿ç”¨pointerå‰éœ€åˆ¤æ–­æ˜¯å¦ä¸ºç©º</p><p>2.pointerå¯ä»¥é‡æ–°è¢«èµ‹å€¼ï¼Œä½†referenceæ€»æ˜¯ä»£è¡¨åˆå§‹åŒ–çš„å¯¹è±¡</p><p>å½“å­˜åœ¨ä¸æŒ‡å‘ä»»ä½•å¯¹è±¡æˆ–è€…æŒ‡å‘å¯¹è±¡æœ‰å˜åŒ–æ—¶åº”è¯¥ä½¿ç”¨pointer</p><p>3.åœ¨å®ç°æ“ä½œç¬¦é‡è½½æ˜¯ï¼Œå¸¸å¸¸è¿”å›ç±»å‹ä¸ºreferenceï¼Œå¯ä»¥ä½œä¸ºå·¦å€¼</p><h2 id="æ¡æ¬¾2-ä½¿ç”¨c-è½¬å‹æ“ä½œç¬¦">æ¡æ¬¾2 ä½¿ç”¨c++è½¬å‹æ“ä½œç¬¦</h2><p>4ä¸ªæ–°çš„è½¬å‹æ“ä½œç¬¦(cast operators):<code>static_cast,const_cast,dynamic_cast,reinterpret_cast</code></p><p>å†™æ³•ä¸º: <code>static_cast&lt;type&gt;(expression)</code> æ³¨æ„åœ¨<code>static_cast&lt;vector&lt;int&gt; &gt;</code>æœ€åä¸¤ä¸ª<code>&gt;</code>æœ€å¥½æœ‰ç©ºæ ¼ï¼Œé˜²æ­¢ç¼–è¯‘å™¨è®¤ä¸ºæ˜¯<code>&gt;&gt;</code></p><table><thead><tr><th style="text-align:left">æ“ä½œç¬¦</th><th>ä½œç”¨</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td style="text-align:left"><code>static_cast</code></td><td>ç”¨äºåŸºæœ¬çš„ç±»å‹è½¬æ¢</td><td>ä¸æ¶‰åŠç»§æ‰¿æœºåˆ¶</td></tr><tr><td style="text-align:left"><code>const_cast</code></td><td>ç”¨äºæ”¹å˜è¡¨è¾¾å¼çš„å¸¸é‡å±æ€§ï¼Œå»æ‰constæ€§è´¨</td><td></td></tr><tr><td style="text-align:left"><code>dynamic_cast</code></td><td>ç”¨äºæ‰§è¡Œç»§æ‰¿ä½“ç³»ä¸­å®‰å…¨å‘ä¸‹æˆ–è€…è·¨ç³»è½¬å‹åŠ¨ä½œ(å°†æŒ‡å‘baseçš„æŒ‡é’ˆè½¬æ¢æˆæŒ‡å‘derived)</td><td>å¯¹äºpointerï¼Œå¤±è´¥è¿”å›nullï¼Œå¯¹äºreferenceï¼Œå¤±è´¥è¿”å›exceptionï¼›åªèƒ½ååŠ©å·¡èˆªåœ¨ç»§æ‰¿ä½“ç³»ä¸­ï¼Œæ— æ³•åº”ç”¨åœ¨ç¼ºä¹è™šå‡½æ•°çš„ç±»å‹ä¸Š</td></tr><tr><td style="text-align:left"><code>reinterpret_cast</code></td><td>æœ€å¸¸ç”¨äºè½¬æ¢â€œå‡½æ•°æŒ‡é’ˆâ€</td><td>ä¸ç¼–è¯‘å¹³å°æœ‰å…³ï¼Œä¸å…·æœ‰ç§»æ¤æ€§</td></tr></tbody></table><h2 id="æ¡æ¬¾3-ä¸ä»¥å¤šæ€æ–¹å¼å¤„ç†æ•°ç»„">æ¡æ¬¾3 ä¸ä»¥å¤šæ€æ–¹å¼å¤„ç†æ•°ç»„</h2><p>å¯¹äºæ•°ç»„<code>array</code>ï¼Œæ•°ç»„åä¹Ÿä¸ºé¦–åœ°å€ã€‚<code>array[i]</code> === <code>*(array+i)</code></p><p><code>array</code>ä¸<code>array+i</code>å†…å­˜ä¹‹é—´çš„è·ç¦»ä¸€å®šæ˜¯<code>i*sizeof(item)</code></p><p>ç¼–è¯‘å™¨å¯¹äºæ•°ç»„ä¸­å¯¹è±¡çš„å¤§å°åœ¨å£°æ˜æ—¶å®šä¸‹ï¼Œå¯¼è‡´å¤šæ€æ—¶æ˜¯æ— æ³•æ­£ç¡®å®šä½å®é™…çš„å†…å­˜è·ç¦»</p><h2 id="æ¡æ¬¾4-éå¿…è¦ä¸æä¾›é»˜è®¤æ„é€ å‡½æ•°">æ¡æ¬¾4 éå¿…è¦ä¸æä¾›é»˜è®¤æ„é€ å‡½æ•°</h2><p>ä¸æä¾›é»˜è®¤æ„é€ å‡½æ•°ä¼šå¸¦æ¥ä¸€ä¸‹ä¸‰ç‚¹çš„ä¸ä¾¿</p><ul><li>ä¸èƒ½äº§ç”Ÿç±»å¯¹è±¡çš„æ•°ç»„(è§£å†³æ–¹æ³•ï¼š1ï¼Œnon-heapæ•°ç»„ï¼Œæå‰ç»™å®šåˆå§‹åŒ–çš„å˜é‡ 2æŒ‡é’ˆæ•°ç»„ 3ï¼Œ<code>placement new</code>æ–¹å¼)</li><li>ä¸é€‚ç”¨äºåŸºäºæ¨¡æ¿çš„å®¹å™¨ç±»ï¼Œå› ä¸ºè¢«å®ä¾‹åŒ–çš„<strong>ç›®æ ‡ç±»å‹</strong>éœ€è¦ä¸€ä¸ªé»˜è®¤æ„é€ å‡½æ•°</li><li>è™šåŸºç±»ä¸æä¾›é»˜è®¤æ„é€ å‡½æ•°ï¼Œæ´¾ç”Ÿç±»å¿…é¡»æä¾›åˆå§‹åŒ–å‚æ•°</li></ul><p>ç„¶è€Œï¼Œå¦‚æœå«æœ‰æ— æ„ä¹‰æˆå‘˜å˜é‡çš„å¯¹è±¡å­˜åœ¨å¦‚æœå¯ä»¥ç”Ÿå­˜ï¼Œé‚£ä¹ˆå¯¹äºå¤§éƒ¨åˆ†çš„æˆå‘˜å‡½æ•°éƒ½å¿…é¡»æ£€æµ‹è¯¥æˆå‘˜å˜é‡ï¼Œé™ä½æ•ˆç‡ã€‚</p><p>å¦‚æœç±»çš„æ„é€ å‡½æ•°èƒ½å¤Ÿä¿è¯å¯¹è±¡çš„æ‰€æœ‰å­—æ®µéƒ½è¢«æ­£ç¡®åˆå§‹å“ˆï¼Œé‚£ä¹ˆè¿™äº›æµ‹è¯•ä»£ç ã€å¯¹äºçš„å¤„ç†ç¨‹åºæ‰€å¸¦æ¥çš„æ—¶é—´å’Œç©ºé—´çš„ä»£ä»·å¯ä»¥å…é™¤ï¼Œ</p><p>æ˜¾ç„¶ï¼Œé»˜è®¤æ„é€ å‡½æ•°æ— æ³•å¸¦æ¥è¿™æ ·çš„ä¿è¯ï¼Œé‚£ä¹ˆ<strong>æœ€å¥½é¿å…</strong>è®©é»˜è®¤æ„é€ å‡½æ•°å‡ºç°ã€‚</p><h1>äºŒã€æ“ä½œç¬¦ Operators</h1><h2 id="æ¡æ¬¾5-å¯¹å®šåˆ¶çš„â€œç±»å‹è½¬åŒ–å‡½æ•°â€ä¿æŒè­¦è§‰">æ¡æ¬¾5 å¯¹å®šåˆ¶çš„â€œç±»å‹è½¬åŒ–å‡½æ•°â€ä¿æŒè­¦è§‰</h2><p>å½“å­˜åœ¨ä»¥ä¸‹æ¡ä»¶ä¹‹ä¸€ï¼Œä¾¿æœ‰å¯èƒ½å‘ç”Ÿéšå¼ç±»å‹è½¬æ¢</p><ul><li>å«æœ‰å•è‡ªå˜é‡æ„é€ å‡½æ•°ã€‚èƒ½ä»¥å•ä¸€å˜é‡æˆåŠŸåˆå§‹åŒ–å¯¹è±¡(åˆ©ç”¨å…³é”®è¯<code>explicit</code>é˜»æ­¢éšå¼è½¬æ¢,æˆ–é‡‡ç”¨proxy class)</li><li>æˆå‘˜å‡½æ•°å«æœ‰éšå¼ç±»å‹æ“ä½œå‡½æ•°ã€‚å¦‚ operator double()const;</li></ul><p>æœ€å¥½ä¸æä¾›ä»»ä½•ç±»å‹è½¬æ¢å‡½æ•°ï¼Œé—®é¢˜åœ¨äºæ­¤ç±»å‡½æ•°çš„è°ƒç”¨å¯èƒ½è¶…å‡ºä½ çš„é¢„æœŸï¼Œç»“æœå¯èƒ½æ˜¯ä¸æ­£ç¡®ï¼Œä¸ç›´è§‚å¹¶ä¸”éš¾ä»¥è°ƒè¯•ã€‚</p><p>ä¾‹å­ï¼š</p><p>æ ‡å‡†åº“ç¨‹åºstringç±»å¹¶æœªå«æœ‰**ä»stringå¯¹è±¡åˆ°Cé£æ ¼char*çš„éšå¼è½¬æ¢å‡½æ•° **ï¼Œè€Œæ˜¯éœ€è¦æ˜¾ç¤ºè°ƒç”¨<code>c_str</code>æˆå‘˜å‡½æ•°æ¥æ‰§è¡Œè¿™ç§è½¬åŒ–è¡Œä¸º</p><h2 id="æ¡æ¬¾6-è‡ªå¢è‡ªå‡æ“ä½œç¬¦çš„å‰ç½®ä¸åç½®">æ¡æ¬¾6 è‡ªå¢è‡ªå‡æ“ä½œç¬¦çš„å‰ç½®ä¸åç½®</h2><p>è‡ªå¢è‡ªå‡çš„é‡è½½ï¼Œä¸ºäº†åŒºåˆ«å‰ç½®ä¸åç½®åªå¥½è®©åç½®æœ‰ä¸€ä¸ªintå½¢å‚ï¼Œç¼–è¯‘å™¨é»˜è®¤æŒ‡å®šä¸º0</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UPInt</span>&#123;</span></span><br><span class="line">    UPInt&amp; <span class="keyword">operator</span>++();<span class="comment">//å‰ç½®++</span></span><br><span class="line">    <span class="keyword">const</span> UPInt <span class="keyword">operator</span>++(<span class="keyword">int</span>);<span class="comment">//åç½®++</span></span><br><span class="line">&#125;;</span><br><span class="line"> UPInt&amp; UPInt::<span class="keyword">operator</span>++()&#123;</span><br><span class="line">     *<span class="keyword">this</span> +=<span class="number">1</span>;     <span class="comment">//ç´¯åŠ </span></span><br><span class="line">     <span class="keyword">return</span> *<span class="keyword">this</span>;<span class="comment">//å–å‡º</span></span><br><span class="line"> &#125;</span><br><span class="line"><span class="keyword">const</span> UPInt UPInt::<span class="keyword">operator</span>++(<span class="keyword">int</span>)&#123;</span><br><span class="line">    UPInt oldValue = *<span class="keyword">this</span>; <span class="comment">//å–å‡º</span></span><br><span class="line">    ++(*<span class="keyword">this</span>);<span class="comment">//ç´¯åŠ </span></span><br><span class="line">    <span class="keyword">return</span> oldValue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‰ç½®ï¼šincrement and fetch ç´¯åŠ ç„¶åå–å‡ºï¼Œè¿”å›å€¼æ˜¯å¼•ç”¨</p><p>åç½®ï¼šfetch and increment å–å‡ºç„¶åç´¯åŠ ï¼Œè¿”å›å€¼æ˜¯ä¸€ä¸ªconstå¸¸é‡(é˜²æ­¢i++++å‡ºç°ï¼Œæ¯«æ— æ„ä¹‰)</p><p><strong>å°½å¯èƒ½ä½¿ç”¨å‰ç½®å¼</strong>  åŸå› åœ¨äº</p><ul><li>åç½®å¼ä¼šäº§ç”Ÿä¸´æ—¶å˜é‡</li><li>åç½®å¼ä¸€èˆ¬æ˜¯ä»¥å‰ç½®å¼ä¸ºåŸºç¡€ä¸Šå®ç°çš„</li></ul><h2 id="æ¡æ¬¾7-ä¸è¦é‡è½½-æ“ä½œç¬¦">æ¡æ¬¾7 ä¸è¦é‡è½½<code>&amp;&amp;</code>,<code>||</code>,<code>,</code>æ“ä½œç¬¦</h2><p>c++å¯¹äºçœŸå‡è¡¨è¾¾å¼é‡‡ç”¨<strong>éª¤æ­»å¼</strong>çš„è¯„ä¼°æ–¹å¼ã€‚ä¸€æ—¦è¯¥è¡¨è¾¾å¼çš„çœŸå‡å€¼ç¡®å®šåï¼Œå‰©ä½™éƒ¨åˆ†å°†ä¸å†è¿›è¡Œè®¡ç®—ã€‚</p><p>å³ä½¿c++å…è®¸æˆ‘ä»¬é‡è½½ï¼Œä½†æ˜¯<strong>å‡½æ•°è°ƒç”¨å¼</strong>ä¼šå–ä»£<strong>éª¤æ­»å¼</strong>ï¼Œè¿™æœ‰æ‚–æ¸¸æˆè§„åˆ™</p><p>å¦‚å°†<code>&amp;&amp;</code>é‡è½½ï¼Œ</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(expr1 &amp;&amp; expr2)</span><br><span class="line">;</span><br><span class="line"><span class="comment">//å®é™…ç¼–è¯‘æ˜¯ä¸‹åˆ—ä¸¤è€…ä¹‹ä¸€</span></span><br><span class="line"><span class="keyword">if</span>(expr1.<span class="keyword">operator</span>&amp;&amp;(expr2))  <span class="comment">//æˆå‘˜å‡½æ•°å½¢å¼</span></span><br><span class="line">    ;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">operator</span>&amp;&amp;(expr1,expr2))  <span class="comment">//å…¨å±€å‡½æ•°å½¢å¼</span></span><br><span class="line">    ;</span><br></pre></td></tr></table></figure><p>æ“ä½œç¬¦é‡è½½çš„ç›®çš„æ˜¯è®©ç¨‹åºæ›´å®¹æ˜“è¢«é˜…è¯»ï¼Œè¢«æ’°å†™ï¼Œè¢«ç†è§£ï¼Œè€Œä¸æ˜¯<s>ç‚«æŠ€</s>æˆ–è€…<s>å¤¸è€€</s></p><h2 id="æ¡æ¬¾8-äº†è§£newä¸delete">æ¡æ¬¾8 äº†è§£<code>new</code>ä¸<code>delete</code></h2><h1>ä¸‰ã€ å¼‚å¸¸Exceptions</h1><h2 id="æ¡æ¬¾9-åˆ©ç”¨ææ„å‡½æ•°é¿å…æ³„æ¼èµ„æº">æ¡æ¬¾9 åˆ©ç”¨ææ„å‡½æ•°é¿å…æ³„æ¼èµ„æº</h2><p>å®è´¨ä¸Šå°±æ˜¯é‡‡ç”¨æ™ºèƒ½æŒ‡é’ˆï¼Œä¸å¿…æ‹…å¿ƒå†…å­˜æ³„æ¼</p><p>æŠŠèµ„æº(ä¸€èˆ¬æ˜¯æŒ‡é’ˆ)å°è£…åœ¨å¯¹è±¡ä¸­(å¦‚æ™ºèƒ½æŒ‡é’ˆè¿™ç§å¯¹è±¡)ï¼Œåˆ©ç”¨è¿™ç§å¯¹è±¡çš„ææ„å‡½æ•°é¿å…èµ„æºæ³„éœ²</p><h2 id="æ¡æ¬¾10-åœ¨æ„é€ å‡½æ•°å†…ç»„ç»‡èµ„æºæ³„éœ²">æ¡æ¬¾10 åœ¨æ„é€ å‡½æ•°å†…ç»„ç»‡èµ„æºæ³„éœ²</h2><p>è™½ç„¶å¯ä»¥åœ¨ææ„å‡½æ•°ä¸­è¿›è¡Œèµ„æºé‡Šæ”¾ï¼Œç„¶è€Œå¦‚æœå¼‚å¸¸å‘ç”Ÿåœ¨å¯¹è±¡çš„æ„é€ é˜¶æ®µï¼Œä¾¿ä¸å¯è¡Œã€‚</p><p>åŸå› æ˜¯<u><strong>c++åªä¼šææ„å·²æ„é€ å®Œæˆçš„å¯¹è±¡</strong></u>ï¼Œè¿™ç§æœºç†çš„ç†ç”±åœ¨äºé¿å…é¢å¤–å¼€é”€ï¼šå¦‚æœéœ€è¦ææ„æœªå®Œæˆæ„é€ çš„å¯¹è±¡ï¼Œå¿…ç„¶è¦è®°å½•ä¸‹æ„é€ å‡½æ•°è¿›è¡Œåˆ°ä»€ä¹ˆç¨‹åº¦ï¼Œè¿™åŠ¿å¿…ä¼šé€ æˆé¢å¤–å¼€é”€ã€‚</p><p>å¯¹äºæŒ‡é’ˆæˆå‘˜å˜é‡ï¼Œä¸€å¾‹é‡‡ç”¨æ™ºèƒ½æŒ‡é’ˆå¯æœ‰æ•ˆçš„é¿å…èµ„æºæ³„éœ²</p>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Gitä¹‹sshè¿æ¥å¤šä¸ªè¿œç¨‹ä»“åº“</title>
      <link href="/2021/10/21/Git%E4%B9%8Bssh%E8%BF%9E%E6%8E%A5%E5%A4%9A%E4%B8%AA%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93/"/>
      <url>/2021/10/21/Git%E4%B9%8Bssh%E8%BF%9E%E6%8E%A5%E5%A4%9A%E4%B8%AA%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93/</url>
      
        <content type="html"><![CDATA[<h3 id="æœ¬åœ°ä»“åº“sshè¿æ¥å¤šä¸ªè¿œç¨‹ä»“åº“">æœ¬åœ°ä»“åº“sshè¿æ¥å¤šä¸ªè¿œç¨‹ä»“åº“</h3><p>ç”±äºGitHubä¸åŒçš„ä¸¤ä¸ªè´¦æˆ·ä¸å¯ä»¥é…ç½®ç›¸åŒçš„å…¬é’¥ï¼Œå› æ­¤æœ¬åœ°ä»“åº“sshè¿æ¥å¤šä¸ªè¿œç¨‹ä»“åº“å¿…é¡»ç”Ÿæˆä¸åŒçš„å¯†é’¥</p><h4 id="1-ç”Ÿæˆå¯†é’¥">1.ç”Ÿæˆå¯†é’¥</h4><p>å¯¹äºä½¿ç”¨sshè¿æ¥è¿œç¨‹ä»“åº“ï¼Œéœ€è¦ç”Ÿæˆéå¯¹ç§°å¯†é’¥å¹¶å°†å…¬é’¥æ·»åŠ åˆ°è¿œç¨‹ä»“åº“ä¸­</p><pre><code><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd ~/.ssh</span><br><span class="line">ssh-keygen -t rsa -f ~/.ssh/&lt;filename&gt; -C &quot;yourmail@xxx.com&quot;</span><br></pre></td></tr></table></figure></code></pre><p>é€šå¸¸<code>id_rsa</code>å’Œ<code>id_rsa.pub</code>æ˜¯é»˜è®¤å¯†é’¥ï¼Œé¢å¤–ç”Ÿæˆçš„å¯†é’¥éœ€è¦è‡ªå®šä¹‰</p><h4 id="2-é…ç½®sshçš„config">2.é…ç½®sshçš„config</h4><ol><li><p>åˆ›å»ºconfigæ–‡ä»¶</p> <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ~/.ssh</span><br><span class="line">touch config</span><br><span class="line">vim config</span><br></pre></td></tr></table></figure></li><li><p>ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œä½¿ä¸åŒå¯†é’¥æŒ‡å‘ä¸åŒè¿œç¨‹ä»“åº“</p> <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> ç¬¬ä¸€ä¸ªè´¦å·ï¼Œé»˜è®¤ä½¿ç”¨çš„è´¦å·</span></span><br><span class="line">Host github.com</span><br><span class="line">HostName github.com</span><br><span class="line">User git</span><br><span class="line">IdentityFile ~/.ssh/id_rsa</span><br><span class="line"><span class="meta">#</span><span class="bash"> ç¬¬äºŒä¸ªè´¦å·</span></span><br><span class="line">Host second.github.com  # secondä¸ºå‰ç¼€åï¼Œå¯ä»¥ä»»æ„è®¾ç½®</span><br><span class="line">HostName github.com</span><br><span class="line">User git</span><br><span class="line">IdentityFile ~/.ssh/&lt;filename&gt;</span><br></pre></td></tr></table></figure></li><li><p>æ¸…ç©ºæœ¬åœ°ç¼“å­˜ï¼Œæ·»åŠ æ–°çš„sshå¯†é’¥åˆ°SSH agenthä¸­</p> <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ssh-add -D</span><br><span class="line">ssh-add id_rsa</span><br><span class="line">ssh-add &lt;filename&gt;</span><br></pre></td></tr></table></figure><p>åŸç†åˆ†æ<br>1.ssh å®¢æˆ·ç«¯æ˜¯é€šè¿‡ç±»ä¼¼ <a href="mailto:git@github.com">git@github.com</a>:githubUserName/repoName.git ** çš„åœ°å€æ¥è¯†åˆ«ä½¿ç”¨æœ¬åœ°çš„å“ªä¸ªç§é’¥çš„ï¼Œåœ°å€ä¸­çš„ User æ˜¯@å‰é¢çš„gitï¼Œ Host æ˜¯@åé¢çš„github.comã€‚<br>2.å¦‚æœæ‰€æœ‰è´¦å·çš„ User å’Œ Host éƒ½ä¸º git å’Œ <a href="http://github.com">github.com</a>ï¼Œé‚£ä¹ˆå°±åªèƒ½ä½¿ç”¨ä¸€ä¸ªç§é’¥ã€‚æ‰€ä»¥è¦å¯¹User å’Œ Host è¿›è¡Œé…ç½®ï¼Œè®©æ¯ä¸ªè´¦å·ä½¿ç”¨è‡ªå·±çš„ Hostï¼Œæ¯ä¸ª Host çš„åŸŸååš CNAME è§£æåˆ° <a href="http://github.com">github.com</a>ï¼Œå¦‚ä¸Šé¢é…ç½®ä¸­çš„Host <a href="http://second.github.com">second.github.com</a>ã€‚<br>3.é…ç½®äº†åˆ«åä¹‹åï¼Œæ–°çš„åœ°å€å°±æ˜¯git@second.github.com:githubUserName/repName.git**ï¼ˆåœ¨æ·»åŠ è¿œç¨‹ä»“åº“æ—¶ä½¿ç”¨ï¼‰ã€‚<br>è¿™æ · ssh åœ¨è¿æ¥æ—¶å°±å¯ä»¥åŒºåˆ«ä¸åŒçš„è´¦å·äº†</p></li><li><p>æµ‹è¯•sshé“¾æ¥</p> <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ssh -T git@github.com</span><br><span class="line">ssh -T git@second.github.com</span><br><span class="line"><span class="meta">#</span><span class="bash"> xxx! Youâ€™ve successfully authenticated, but GitHub does not provide bash access.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> å‡ºç°ä¸Šè¿°æç¤ºï¼Œè¿æ¥æˆåŠŸ</span></span><br></pre></td></tr></table></figure></li></ol><h4 id="3-ä»“åº“é…ç½®">3. ä»“åº“é…ç½®</h4><ol><li><p>è®¾ç½®è¿œç¨‹ä»“åº“å³å¯ï¼Œæ³¨æ„å¯¹åº”ï¼Œæ¯”å¦‚è¯´<filename>è¿™ä¸ªå…¬é’¥æ”¾åœ¨äº†ç¬¬äºŒä¸ªä»“åº“ï¼Œå°±è¦æ³¨æ„ä¿®æ”¹host</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote add &lt;remotename&gt; git@second.github.com:githubUserName/repName.git</span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      <categories>
          
          <category> Git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Git </tag>
            
            <tag> Ssh </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Windowsç»ˆç«¯ä»£ç†</title>
      <link href="/2021/10/21/Windows%E7%BB%88%E7%AB%AF%E4%BB%A3%E7%90%86/"/>
      <url>/2021/10/21/Windows%E7%BB%88%E7%AB%AF%E4%BB%A3%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h3 id="ä¸´æ—¶ç”Ÿæ•ˆ">ä¸´æ—¶ç”Ÿæ•ˆ</h3><ol><li>è·å¾—ä»£ç†æœåŠ¡å™¨çš„ä½¿ç”¨çš„<strong>ç«¯å£å·</strong>å’Œ<strong>ä»£ç†åè®®</strong><br><img src="/img/v2ray_proxy.png" alt="v2ray_proxy.png"></li><li>åœ¨cmdä¸­è®¾ç½®ç¯å¢ƒå˜é‡</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> ä½¿ç”¨sock5ä»£ç†</span></span><br><span class="line">set http_proxy=socks5://127.0.0.1:10808</span><br><span class="line">set https_proxy=socks5://127.0.0.1:10808</span><br></pre></td></tr></table></figure><h3 id="æ°¸ä¹…ç”Ÿæ•ˆ">æ°¸ä¹…ç”Ÿæ•ˆ</h3><p>è‹¥è¦æ°¸ä¹…ç”Ÿæ•ˆï¼Œåœ¨ç³»ç»Ÿä¸­è®¾ç½®ç¯å¢ƒå˜é‡å³å¯<br><img src="/img/sysenv.jpg" alt="sysenv.jpg"></p><h3 id="æµ‹è¯•">æµ‹è¯•</h3><p>é‡å¯cmdå‘½ä»¤è¡Œï¼Œä½¿ç”¨ curl <a href="http://www.google.com">www.google.com</a> ï¼Œå¦‚æœæœ‰å†…å®¹è¿”å›ï¼Œè¯´æ˜è®¾ç½®æˆåŠŸï¼ˆä¸å¯ä»¥æ˜¯ <strong>ping</strong> å‘½ä»¤è¿›è¡Œæµ‹è¯•ï¼Œä¸èµ°httpåè®®ï¼ï¼ï¼‰</p>]]></content>
      
      
      <categories>
          
          <category> proxy </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Windows </tag>
            
            <tag> proxy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>&gt;/dev/null 2&gt;&amp;1è¯¦è§£</title>
      <link href="/2021/10/19/dev-null-2-1%E8%AF%A6%E8%A7%A3/"/>
      <url>/2021/10/19/dev-null-2-1%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h3 id="1-shellè¾“å…¥è¾“å‡ºé‡å®šå‘">1.shellè¾“å…¥è¾“å‡ºé‡å®šå‘</h3><p>å¤§å¤šæ•° UNIX ç³»ç»Ÿå‘½ä»¤ä»ä½ çš„ç»ˆç«¯æ¥å—è¾“å…¥å¹¶å°†æ‰€äº§ç”Ÿçš„è¾“å‡ºå‘é€å›â€‹â€‹åˆ°æ‚¨çš„ç»ˆç«¯ã€‚ä¸€ä¸ªå‘½ä»¤é€šå¸¸ä»ä¸€ä¸ªå«æ ‡å‡†è¾“å…¥çš„åœ°æ–¹è¯»å–è¾“å…¥ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™æ°å¥½æ˜¯ä½ çš„ç»ˆç«¯ã€‚åŒæ ·ï¼Œä¸€ä¸ªå‘½ä»¤é€šå¸¸å°†å…¶è¾“å‡ºå†™å…¥åˆ°æ ‡å‡†è¾“å‡ºï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¹Ÿæ˜¯ä½ çš„ç»ˆç«¯ã€‚</p><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ¯ä¸ª Unix/Linux å‘½ä»¤è¿è¡Œæ—¶éƒ½ä¼šæ‰“å¼€ä¸‰ä¸ªæ–‡ä»¶ï¼š</p><ul><li>æ ‡å‡†è¾“å…¥æ–‡ä»¶(stdin)ï¼šstdinçš„æ–‡ä»¶æè¿°ç¬¦ä¸º0ï¼ŒUnixç¨‹åºé»˜è®¤ä»stdinè¯»å–æ•°æ®ã€‚</li><li>æ ‡å‡†è¾“å‡ºæ–‡ä»¶(stdout)ï¼šstdout çš„æ–‡ä»¶æè¿°ç¬¦ä¸º1ï¼ŒUnixç¨‹åºé»˜è®¤å‘stdoutè¾“å‡ºæ•°æ®ã€‚</li><li>æ ‡å‡†é”™è¯¯æ–‡ä»¶(stderr)ï¼šstderrçš„æ–‡ä»¶æè¿°ç¬¦ä¸º2ï¼ŒUnixç¨‹åºä¼šå‘stderræµä¸­å†™å…¥é”™è¯¯ä¿¡æ¯ã€‚</li></ul><p>é‡å®šå‘å‘½ä»¤åˆ—è¡¨å¦‚ä¸‹ï¼š</p><table><thead><tr><th style="text-align:left">å‘½ä»¤</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:left">command &gt; file</td><td>å°†è¾“å‡ºé‡å®šå‘åˆ° fileã€‚</td></tr><tr><td style="text-align:left">command &lt; file</td><td>å°†è¾“å…¥é‡å®šå‘åˆ° fileã€‚</td></tr><tr><td style="text-align:left">command &gt;&gt; file</td><td>å°†è¾“å‡ºä»¥è¿½åŠ çš„æ–¹å¼é‡å®šå‘åˆ° fileã€‚</td></tr><tr><td style="text-align:left">n &gt; file</td><td>å°†æ–‡ä»¶æè¿°ç¬¦ä¸º n çš„æ–‡ä»¶é‡å®šå‘åˆ° fileã€‚</td></tr><tr><td style="text-align:left">n &gt;&gt; file</td><td>å°†æ–‡ä»¶æè¿°ç¬¦ä¸º n çš„æ–‡ä»¶ä»¥è¿½åŠ çš„æ–¹å¼é‡å®šå‘åˆ° fileã€‚</td></tr><tr><td style="text-align:left">n &gt;&amp; m</td><td>å°†è¾“å‡ºæ–‡ä»¶ m å’Œ n åˆå¹¶ã€‚</td></tr><tr><td style="text-align:left">n &lt;&amp; m</td><td>å°†è¾“å…¥æ–‡ä»¶ m å’Œ n åˆå¹¶ã€‚</td></tr><tr><td style="text-align:left">&lt;&lt; tag</td><td>å°†å¼€å§‹æ ‡è®° tag å’Œç»“æŸæ ‡è®° tag ä¹‹é—´çš„å†…å®¹ä½œä¸ºè¾“å…¥ã€‚</td></tr></tbody></table><h3 id="2-dev-null-æ–‡ä»¶">2./dev/null æ–‡ä»¶</h3><p>/dev/null æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ–‡ä»¶ï¼Œå†™å…¥åˆ°å®ƒçš„å†…å®¹éƒ½ä¼šè¢«ä¸¢å¼ƒï¼›å¦‚æœå°è¯•ä»è¯¥æ–‡ä»¶è¯»å–å†…å®¹ï¼Œé‚£ä¹ˆä»€ä¹ˆä¹Ÿè¯»ä¸åˆ°ã€‚ä½†æ˜¯ /dev/null æ–‡ä»¶éå¸¸æœ‰ç”¨ï¼Œå°†å‘½ä»¤çš„è¾“å‡ºé‡å®šå‘åˆ°å®ƒï¼Œä¼šèµ·åˆ°&quot;ç¦æ­¢è¾“å‡º&quot;çš„æ•ˆæœã€‚å¦‚æœå¸Œæœ›å±è”½stdout å’Œstderr,å¯ä»¥è¿™æ ·å†™</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">command &gt; /dev/null 2&gt;&amp;1</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼š0 æ˜¯æ ‡å‡†è¾“å…¥ï¼ˆSTDINï¼‰ï¼Œ1 æ˜¯æ ‡å‡†è¾“å‡ºï¼ˆSTDOUTï¼‰ï¼Œ2 æ˜¯æ ‡å‡†é”™è¯¯è¾“å‡ºï¼ˆSTDERRï¼‰ã€‚</p><p>è¿™é‡Œçš„ 2 å’Œ &gt; ä¹‹é—´ä¸å¯ä»¥æœ‰ç©ºæ ¼ï¼Œ2&gt; æ˜¯ä¸€ä½“çš„æ—¶å€™æ‰è¡¨ç¤ºé”™è¯¯è¾“å‡ºã€‚</p><h3 id="3-dev-null-2-1è¯¦è§£">3./dev/null 2&gt;&amp;1è¯¦è§£</h3><p>&amp; è¡¨ç¤ºç­‰åŒäºçš„æ„æ€ï¼Œ2&gt;&amp;1ï¼Œè¡¨ç¤º2çš„è¾“å‡ºé‡å®šå‘ç­‰åŒäº1</p><p>1 è¡¨ç¤ºstdoutæ ‡å‡†è¾“å‡ºï¼Œç³»ç»Ÿé»˜è®¤å€¼æ˜¯1ï¼Œæ‰€ä»¥&quot;&gt;/dev/null&quot;ç­‰åŒäº â€œ1&gt;/dev/nullâ€</p><p>é‚£ä¹ˆ/dev/null 2&gt;&amp;1è¯­å¥æ‰§è¡Œè¿‡ç¨‹ä¸ºï¼š</p><p><code>1&gt;/dev/null </code>ï¼šé¦–å…ˆè¡¨ç¤ºæ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ°ç©ºè®¾å¤‡æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯ä¸è¾“å‡ºä»»ä½•ä¿¡æ¯åˆ°ç»ˆç«¯ï¼Œè¯´ç™½äº†å°±æ˜¯ä¸æ˜¾ç¤ºä»»ä½•ä¿¡æ¯ã€‚</p><p><code>2&gt;&amp;1 </code>ï¼šæ¥ç€ï¼Œæ ‡å‡†é”™è¯¯è¾“å‡ºé‡å®šå‘ åˆ° æ ‡å‡†è¾“å‡ºï¼Œå› ä¸ºä¹‹å‰æ ‡å‡†è¾“å‡ºå·²ç»é‡å®šå‘åˆ°äº†ç©ºè®¾å¤‡æ–‡ä»¶ï¼Œæ‰€ä»¥æ ‡å‡†é”™è¯¯è¾“å‡ºä¹Ÿé‡å®šå‘åˆ°ç©ºè®¾å¤‡æ–‡ä»¶</p><p>æœ€å¸¸ç”¨çš„æ–¹å¼æœ‰ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">command &gt; file 2&gt;file</span><br><span class="line"></span><br><span class="line">command &gt; file 2&gt;&amp;1</span><br></pre></td></tr></table></figure><p>ä¸åŒä¹‹å¤„<br>1.command &gt; file 2&gt;file çš„æ„æ€æ˜¯å°†å‘½ä»¤æ‰€äº§ç”Ÿçš„æ ‡å‡†è¾“å‡ºä¿¡æ¯,å’Œé”™è¯¯çš„è¾“å‡ºä¿¡æ¯é€åˆ°file ä¸­.command &gt; file 2&gt;file è¿™æ ·çš„å†™æ³•,stdoutå’Œstderréƒ½ç›´æ¥é€åˆ°fileä¸­, fileä¼šè¢«æ‰“å¼€ä¸¤æ¬¡,è¿™æ ·stdoutå’Œstderrä¼šäº’ç›¸è¦†ç›–,è¿™æ ·å†™ç›¸å½“ä½¿ç”¨äº†FD1å’ŒFD2ä¸¤ä¸ªåŒæ—¶å»æŠ¢å file çš„ç®¡é“ã€‚<br>2.command &gt;file 2&gt;&amp;1 è¿™æ¡å‘½ä»¤å°±å°†stdoutç›´æ¥é€å‘file, stderr ç»§æ‰¿äº†FD1ç®¡é“å,å†è¢«é€å¾€file,æ­¤æ—¶,file åªè¢«æ‰“å¼€äº†ä¸€æ¬¡,ä¹Ÿåªä½¿ç”¨äº†ä¸€ä¸ªç®¡é“FD1,å®ƒåŒ…æ‹¬äº†stdoutå’Œstderrçš„å†…å®¹ã€‚</p><p>ä»IOæ•ˆç‡ä¸Š,å‰ä¸€æ¡å‘½ä»¤çš„æ•ˆç‡è¦æ¯”åé¢ä¸€æ¡çš„å‘½ä»¤æ•ˆç‡è¦ä½æ‰€ä»¥åœ¨ç¼–å†™shellè„šæœ¬çš„æ—¶å€™,è¾ƒå¤šçš„æ—¶å€™æˆ‘ä»¬ä¼šcommand &gt; file 2&gt;&amp;1 è¿™æ ·çš„å†™æ³•ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Shell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Producer-consumer problem</title>
      <link href="/2021/10/19/Producer-consumer%20problem/"/>
      <url>/2021/10/19/Producer-consumer%20problem/</url>
      
        <content type="html"><![CDATA[<h3 id="1-è¿›ç¨‹åŒæ­¥ä¸ä¿¡å·é‡">1.è¿›ç¨‹åŒæ­¥ä¸ä¿¡å·é‡</h3><p>è¿›ç¨‹åŒæ­¥:è®©å¤šä¸ªè¿›ç¨‹&quot;èµ°èµ°åœåœ&quot;æ¥ä¿è¯å¤šè¿›ç¨‹åˆä½œçš„åˆç†æœ‰åº(ä»¥ç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜ä¸ºä¾‹è¿›è¡Œè®²è§£)</p><h4 id="1-1ç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜">1.1ç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜</h4><p><strong>ç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜</strong>ï¼ˆè‹±è¯­ï¼šProducer-consumer problemï¼‰ï¼Œä¹Ÿç§°<strong>æœ‰é™ç¼“å†²é—®é¢˜</strong>ï¼ˆBounded-buffer problemï¼‰ï¼Œæ˜¯ä¸€ä¸ª<a href="https://zh.wikipedia.org/wiki/%E5%A4%9A%E8%BF%9B%E7%A8%8B">å¤šè¿›ç¨‹</a><a href="https://zh.wikipedia.org/wiki/%E5%90%8C%E6%AD%A5">åŒæ­¥</a>é—®é¢˜çš„ç»å…¸æ¡ˆä¾‹ã€‚è¯¥é—®é¢˜æè¿°äº†å…±äº«å›ºå®šå¤§å°<a href="https://zh.wikipedia.org/wiki/%E7%BC%93%E5%86%B2%E5%8C%BA">ç¼“å†²åŒº</a>çš„ä¸¤ä¸ªè¿›ç¨‹â€”â€”å³æ‰€è°“çš„â€œç”Ÿäº§è€…â€å’Œâ€œæ¶ˆè´¹è€…â€â€”â€”åœ¨å®é™…è¿è¡Œæ—¶ä¼šå‘ç”Ÿçš„é—®é¢˜ã€‚ç”Ÿäº§è€…çš„ä¸»è¦ä½œç”¨æ˜¯ç”Ÿæˆä¸€å®šé‡çš„æ•°æ®æ”¾åˆ°ç¼“å†²åŒºä¸­ï¼Œç„¶åé‡å¤æ­¤è¿‡ç¨‹ã€‚ä¸æ­¤åŒæ—¶ï¼Œæ¶ˆè´¹è€…ä¹Ÿåœ¨ç¼“å†²åŒºæ¶ˆè€—è¿™äº›æ•°æ®ã€‚è¯¥é—®é¢˜çš„å…³é”®å°±æ˜¯è¦ä¿è¯ç”Ÿäº§è€…ä¸ä¼šåœ¨ç¼“å†²åŒºæ»¡æ—¶åŠ å…¥æ•°æ®ï¼Œæ¶ˆè´¹è€…ä¹Ÿä¸ä¼šåœ¨ç¼“å†²åŒºä¸­ç©ºæ—¶æ¶ˆè€—æ•°æ®ã€‚</p><p>è¦è§£å†³è¯¥é—®é¢˜ï¼Œå°±å¿…é¡»è®©ç”Ÿäº§è€…åœ¨ç¼“å†²åŒºæ»¡æ—¶ä¼‘çœ ï¼ˆè¦ä¹ˆå¹²è„†å°±æ”¾å¼ƒæ•°æ®ï¼‰ï¼Œç­‰åˆ°ä¸‹æ¬¡æ¶ˆè´¹è€…æ¶ˆè€—ç¼“å†²åŒºä¸­çš„æ•°æ®çš„æ—¶å€™ï¼Œç”Ÿäº§è€…æ‰èƒ½è¢«å”¤é†’ï¼Œå¼€å§‹å¾€ç¼“å†²åŒºæ·»åŠ æ•°æ®ã€‚åŒæ ·ï¼Œä¹Ÿå¯ä»¥è®©æ¶ˆè´¹è€…åœ¨ç¼“å†²åŒºç©ºæ—¶è¿›å…¥ä¼‘çœ ï¼Œç­‰åˆ°ç”Ÿäº§è€…å¾€ç¼“å†²åŒºæ·»åŠ æ•°æ®ä¹‹åï¼Œå†å”¤é†’æ¶ˆè´¹è€…ã€‚é€šå¸¸é‡‡ç”¨<a href="https://zh.wikipedia.org/wiki/%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1">è¿›ç¨‹é—´é€šä¿¡</a>çš„æ–¹æ³•è§£å†³è¯¥é—®é¢˜ï¼Œå¸¸ç”¨çš„æ–¹æ³•æœ‰<a href="https://zh.wikipedia.org/wiki/%E4%BF%A1%E5%8F%B7%E9%87%8F">ä¿¡å·ç¯æ³•</a>[<a href="https://zh.wikipedia.org/zh-hans/%E7%94%9F%E4%BA%A7%E8%80%85%E6%B6%88%E8%B4%B9%E8%80%85%E9%97%AE%E9%A2%98#cite_note-1">1]</a>ç­‰ã€‚å¦‚æœè§£å†³æ–¹æ³•ä¸å¤Ÿå®Œå–„ï¼Œåˆ™å®¹æ˜“å‡ºç°æ­»é”çš„æƒ…å†µã€‚å‡ºç°æ­»é”æ—¶ï¼Œä¸¤ä¸ªçº¿ç¨‹éƒ½ä¼šé™·å…¥ä¼‘çœ ï¼Œç­‰å¾…å¯¹æ–¹å”¤é†’è‡ªå·±ã€‚è¯¥é—®é¢˜ä¹Ÿèƒ½è¢«æ¨å¹¿åˆ°å¤šä¸ªç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„æƒ…å½¢ã€‚</p><h4 id="1-2å®ç°">1.2å®ç°</h4><h5 id="1-2-1ä¸å®Œå–„å®ç°">1.2.1ä¸å®Œå–„å®ç°</h5>  <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> itemCount = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">procedure <span class="title">producer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        item = <span class="built_in">produceItem</span>();</span><br><span class="line">      <span class="comment">//ç¼“å­˜åŒºæ»¡ï¼Œç”Ÿäº§è€…ä¼‘çœ </span></span><br><span class="line">        <span class="keyword">if</span> (itemCount == BUFFER_SIZE) &#123;</span><br><span class="line">            <span class="built_in">sleep</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">putItemIntoBuffer</span>(item);</span><br><span class="line">        itemCount = itemCount + <span class="number">1</span>;</span><br><span class="line">      <span class="comment">//ç¼“å­˜åŒºæ•°é‡ä¸º1ï¼Œå”¤é†’æ¶ˆè´¹è€…</span></span><br><span class="line">        <span class="keyword">if</span> (itemCount == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="built_in">wakeup</span>(consumer);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">procedure <span class="title">consumer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">      <span class="comment">//ç¼“å­˜åŒºç©ºï¼Œæ¶ˆè´¹è€…ä¼‘çœ </span></span><br><span class="line">        <span class="keyword">if</span> (itemCount == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">sleep</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        item = <span class="built_in">removeItemFromBuffer</span>();</span><br><span class="line">        itemCount = itemCount - <span class="number">1</span>;</span><br><span class="line">      <span class="comment">//ç¼“å­˜åŒºæ•°é‡ä¸ºBUFFER_SIZE - 1ï¼Œå”¤é†’ç”Ÿäº§è€…</span></span><br><span class="line">        <span class="keyword">if</span> (itemCount == BUFFER_SIZE - <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="built_in">wakeup</span>(producer);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">consumeItem</span>(item);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å­˜åœ¨çš„é—®é¢˜ï¼šå¯èƒ½å¯¼è‡´ç«äº‰æ¡ä»¶ï¼Œè¿›è€Œå¼•å‘æ­»é”ï¼Œå¦‚ä»¥ä¸‹æƒ…å†µ</p><ol><li>æ¶ˆè´¹è€…æŠŠæœ€åä¸€ä¸ª itemCount çš„å†…å®¹è¯»å‡ºæ¥ï¼Œæ³¨æ„å®ƒç°åœ¨æ˜¯é›¶ã€‚æ¶ˆè´¹è€…è¿”å›åˆ°whileçš„èµ·å§‹å¤„ï¼Œç°åœ¨è¿›å…¥ if å—ï¼›</li><li>å°±åœ¨è°ƒç”¨sleepä¹‹å‰ï¼ŒCPUå†³å®šå°†æ—¶é—´è®©ç»™ç”Ÿäº§è€…ï¼Œäºæ˜¯æ¶ˆè´¹è€…åœ¨æ‰§è¡Œ sleep ä¹‹å‰å°±è¢«ä¸­æ–­äº†ï¼Œç”Ÿäº§è€…å¼€å§‹æ‰§è¡Œï¼›</li><li>ç”Ÿäº§è€…ç”Ÿäº§å‡ºä¸€é¡¹æ•°æ®åå°†å…¶æ”¾å…¥ç¼“å†²åŒºï¼Œç„¶ååœ¨ itemCount ä¸ŠåŠ  1ï¼›</li><li>ç”±äºç¼“å†²åŒºåœ¨ä¸Šä¸€æ­¥åŠ  1 ä¹‹å‰ä¸ºç©ºï¼Œç”Ÿäº§è€…å°è¯•å”¤é†’æ¶ˆè´¹è€…ï¼›</li><li>é—æ†¾çš„æ˜¯ï¼Œæ¶ˆè´¹è€…å¹¶æ²¡æœ‰åœ¨ä¼‘çœ ï¼Œå”¤é†’æŒ‡ä»¤ä¸èµ·ä½œç”¨ã€‚å½“æ¶ˆè´¹è€…æ¢å¤æ‰§è¡Œçš„æ—¶å€™ï¼Œæ‰§è¡Œ sleepï¼Œä¸€è§‰ä¸é†’ã€‚å‡ºç°è¿™ç§æƒ…å†µçš„åŸå› åœ¨äºï¼Œæ¶ˆè´¹è€…åªèƒ½è¢«ç”Ÿäº§è€…åœ¨ itemCount ä¸º 1 çš„æƒ…å†µä¸‹å”¤é†’ï¼›</li><li>ç”Ÿäº§è€…ä¸åœåœ°å¾ªç¯æ‰§è¡Œï¼Œç›´åˆ°ç¼“å†²åŒºæ»¡ï¼Œéšåè¿›å…¥ä¼‘çœ ã€‚</li></ol><p>å¦‚æœå­˜åœ¨å¤šä¸ªç”Ÿäº§è€…ï¼Œä¹Ÿæ˜¯ä¸è¡Œçš„ï¼ŒitemCountå«ä¹‰ä¸è¶³ä»¥è¡¨è¾¾ä¼‘çœ ä¸­çš„ç”Ÿäº§è€…ã€‚ä¼šå­˜åœ¨æœ‰äº›ç”Ÿäº§è€…ä¸€ç›´ä¼‘çœ </p><p><img src="/img/image-20210919131635850.png" alt="image-20210919131635850"></p><h5 id="1-2-2é‡‡å–ä¿¡å·ç¯å®ç°">1.2.2é‡‡å–ä¿¡å·ç¯å®ç°</h5><p>ä¿¡å·ç¯å¯ä»¥é¿å…ä¸Šè¿°å”¤é†’æŒ‡ä»¤ä¸èµ·ä½œç”¨çš„æƒ…å†µã€‚è¯¥æ–¹æ³•ä½¿ç”¨äº†ä¸¤ä¸ªä¿¡å·ç¯ï¼ŒfillCount å’Œ emptyCountã€‚fillCount ç”¨äºè®°å½•ç¼“å†²åŒºä¸­å°†è¢«è¯»å–çš„æ•°æ®é¡¹æ•°ï¼ˆå®é™…ä¸Šå°±æ˜¯æœ‰å¤šå°‘æ•°æ®é¡¹åœ¨ç¼“å†²åŒºé‡Œï¼‰ï¼ŒemptyCount ç”¨äºè®°å½•ç¼“å†²åŒºä¸­ç©ºé—²ç©ºé—´æ•°ã€‚å½“æœ‰æ–°æ•°æ®é¡¹è¢«æ”¾å…¥ç¼“å†²åŒºæ—¶ï¼ŒfillCount å¢åŠ ï¼ŒemptyCount å‡å°‘ã€‚å¦‚æœåœ¨ç”Ÿäº§è€…å°è¯•å‡å°‘ <strong>emptyCount çš„æ—¶å€™å‘ç°å…¶å€¼ä¸ºé›¶ï¼Œé‚£ä¹ˆç”Ÿäº§è€…å°±è¿›å…¥ä¼‘çœ </strong>ã€‚ç­‰åˆ°æœ‰æ•°æ®é¡¹è¢«æ¶ˆè€—ï¼ŒemptyCount å¢åŠ çš„æ—¶å€™ï¼Œç”Ÿäº§è€…æ‰è¢«å”¤é†’ã€‚æ¶ˆè´¹è€…çš„è¡Œä¸ºç±»ä¼¼ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">semaphore fillCount = <span class="number">0</span>; <span class="comment">// ç”Ÿäº§çš„é¡¹ç›®</span></span><br><span class="line">semaphore emptyCount = BUFFER_SIZE; <span class="comment">// å‰©ä½™ç©ºé—´</span></span><br><span class="line"></span><br><span class="line"><span class="function">procedure <span class="title">producer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        item = <span class="built_in">produceItem</span>();</span><br><span class="line">        <span class="built_in">down</span>(emptyCount);</span><br><span class="line">      <span class="comment">//è‹¥emptyCountä¸º0ï¼Œç”Ÿäº§è€…è¿›å…¥ä¼‘çœ </span></span><br><span class="line">      <span class="comment">//è‹¥emotyCountä¸ºè´Ÿæ•°ï¼Œè¡¨ç¤ºæœ‰ç”Ÿäº§è€…åœ¨ä¼‘çœ </span></span><br><span class="line">        <span class="built_in">putItemIntoBuffer</span>(item);</span><br><span class="line">        <span class="built_in">up</span>(fillCount);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">procedure <span class="title">consumer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="built_in">down</span>(fillCount);</span><br><span class="line">        item = <span class="built_in">removeItemFromBuffer</span>();</span><br><span class="line">        <span class="built_in">up</span>(emptyCount);</span><br><span class="line">        <span class="built_in">consumeItem</span>(item);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°æ–¹æ³•åœ¨åªæœ‰ä¸€ä¸ªç”Ÿäº§è€…å’Œä¸€ä¸ªæ¶ˆè´¹è€…æ—¶èƒ½è§£å†³é—®é¢˜ã€‚å¯¹äºå¤šä¸ªç”Ÿäº§è€…æˆ–è€…å¤šä¸ªæ¶ˆè´¹è€…å…±äº«ç¼“å†²åŒºçš„æƒ…å†µï¼Œè¯¥ç®—æ³•ä¹Ÿä¼šå¯¼è‡´ç«äº‰æ¡ä»¶ï¼Œå‡ºç°ä¸¤ä¸ªæˆ–ä»¥ä¸Šçš„è¿›ç¨‹åŒæ—¶è¯»æˆ–å†™åŒä¸€ä¸ªç¼“å†²åŒºæ§½çš„æƒ…å†µã€‚</p><p>ä¸ºäº†è¯´æ˜è¿™ç§æƒ…å†µæ˜¯å¦‚ä½•å‘ç”Ÿçš„ï¼Œå¯ä»¥å‡è®¾ putItemIntoBuffer() çš„ä¸€ç§å¯èƒ½çš„å®ç°ï¼šå…ˆå¯»æ‰¾ä¸‹ä¸€ä¸ªå¯ç”¨ç©ºæ§½ï¼Œç„¶åå†™å…¥æ•°æ®é¡¹ã€‚ä¸‹åˆ—æƒ…å½¢æ˜¯å¯èƒ½å‡ºç°çš„ï¼š</p><ol><li>ä¸¤ä¸ªç”Ÿäº§è€…éƒ½å‡å°‘ emptyCount çš„å€¼ï¼›</li><li>æŸä¸€ç”Ÿäº§è€…å¯»æ‰¾åˆ°ä¸‹ä¸€ä¸ªå¯ç”¨ç©ºæ§½ï¼›</li><li>å¦ä¸€ç”Ÿäº§è€…ä¹Ÿæ‰¾åˆ°äº†ä¸‹ä¸€ä¸ªå¯ç”¨ç©ºæ§½ï¼Œç»“æœå’Œä¸Šä¸€æ­¥è¢«æ‰¾åˆ°çš„æ˜¯åŒä¸€ä¸ªç©ºæ§½ï¼›</li><li>ä¸¤ä¸ªç”Ÿäº§è€…å‘å¯ç”¨ç©ºæ§½å†™å…¥æ•°æ®ã€‚</li></ol><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦åœ¨ä¿è¯åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªç”Ÿäº§è€…èƒ½å¤Ÿæ‰§è¡Œ putItemIntoBuffer()ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œéœ€è¦å¯»æ‰¾ä¸€ç§æ–¹æ³•æ¥äº’æ–¥åœ°æ‰§è¡Œä¸´ç•ŒåŒºçš„ä»£ç ã€‚ä¸ºäº†è¾¾åˆ°è¿™ä¸ªç›®çš„ï¼Œå¯å¼•å…¥ä¸€ä¸ªäºŒå€¼ä¿¡å·ç¯ mutexï¼Œå…¶å€¼åªèƒ½ä¸º 1 æˆ–è€… 0ã€‚å¦‚æœæŠŠçº¿ç¨‹æ”¾å…¥ down(mutex) å’Œ up(mutex) ä¹‹é—´ï¼Œå°±å¯ä»¥é™åˆ¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½è¢«æ‰§è¡Œã€‚å¤šç”Ÿäº§è€…ã€æ¶ˆè´¹è€…çš„è§£å†³ç®—æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">semaphore mutex = <span class="number">1</span>;</span><br><span class="line"><span class="comment">//åªæœ‰mutexä¸º1æ‰å…è®¸è¿›å…¥ä¿®æ”¹å…±äº«ç¼“å†²åŒº</span></span><br><span class="line">semaphore fillCount = <span class="number">0</span>;</span><br><span class="line">semaphore emptyCount = BUFFER_SIZE;</span><br><span class="line"></span><br><span class="line"><span class="function">procedure <span class="title">producer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        item = <span class="built_in">produceItem</span>();</span><br><span class="line">        <span class="built_in">down</span>(emptyCount);</span><br><span class="line">        <span class="built_in">down</span>(mutex);</span><br><span class="line">        <span class="built_in">putItemIntoBuffer</span>(item);</span><br><span class="line">        <span class="built_in">up</span>(mutex);</span><br><span class="line">        <span class="built_in">up</span>(fillCount);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">procedure <span class="title">consumer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="built_in">down</span>(fillCount);</span><br><span class="line">        <span class="built_in">down</span>(mutex);</span><br><span class="line">        item = <span class="built_in">removeItemFromBuffer</span>();</span><br><span class="line">        <span class="built_in">up</span>(mutex);</span><br><span class="line">        <span class="built_in">up</span>(emptyCount);</span><br><span class="line">        <span class="built_in">consumeItem</span>(item);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ä»£ç ä¸­ while è¯­å¥çš„ç”¨æ³•ï¼Œéƒ½æ˜¯ç”¨åœ¨æµ‹è¯•ç¼“å†²åŒºæ˜¯å¦å·²æ»¡æˆ–ç©ºçš„æ—¶å€™ã€‚å½“å­˜åœ¨å¤šä¸ªæ¶ˆè´¹è€…æ—¶ï¼Œæœ‰å¯èƒ½é€ æˆç«äº‰æ¡ä»¶çš„æƒ…å†µæ˜¯ï¼šæŸä¸€æ¶ˆè´¹è€…åœ¨ä¸€é¡¹æ•°æ®è¢«æ”¾å…¥ç¼“å†²åŒºä¸­æ—¶è¢«å”¤é†’ï¼Œä½†æ˜¯å¦ä¸€æ¶ˆè´¹è€…å·²ç»åœ¨ç®¡ç¨‹ä¸Šç­‰å¾…äº†ä¸€æ®µæ—¶é—´å¹¶ç§»é™¤äº†è¿™é¡¹æ•°æ®ã€‚å¦‚æœ while è¯­å¥è¢«æ”¹æˆ ifï¼Œåˆ™ä¼šå‡ºç°æ”¾å…¥ç¼“å†²åŒºçš„æ•°æ®é¡¹è¿‡å¤šï¼Œæˆ–ç§»é™¤ç©ºç¼“å†²åŒºä¸­çš„å…ƒç´ çš„æƒ…å†µã€‚</p><h3 id="2-ä¿¡å·é‡ä¸´ç•ŒåŒºä¿æŠ¤">2.ä¿¡å·é‡ä¸´ç•ŒåŒºä¿æŠ¤</h3><p>å¤šä¸ªç”Ÿäº§è€…å…±åŒä¿®æ”¹emptyCountï¼Œç”±äºæ—¶é—´åˆ†ç‰‡æ‰§è¡Œçš„å…³ç³»ï¼Œæœ‰å¯èƒ½ä½¿å¾—emptyCountçš„å€¼ä¸çœŸå®æƒ…å†µä¸ç¬¦åˆã€‚è¿™ç§é”™è¯¯æ˜¯æœ‰å¤šä¸ªè¿›ç¨‹å¹¶å‘æ“ä½œå…±äº«æ•°æ®å¼•èµ·ï¼Œä¸è°ƒåº¦é¡ºåºæœ‰å…³ï¼Œéš¾ä»¥å‘ç°å’Œè°ƒè¯•ã€‚</p><p>è‹¥è¿™ç§æƒ…å†µ(ä¼ªä»£ç )</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">emptyCount = <span class="number">5</span>;</span><br><span class="line"><span class="comment">//regæ˜¯å¯„å­˜å™¨</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ç”Ÿäº§è€…P1è¿›è¡Œç”Ÿäº§</span></span><br><span class="line">reg = emptyCount;</span><br><span class="line">reg = reg <span class="number">-1</span>;</span><br><span class="line">emptyCount = reg;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç”Ÿäº§è€…P2è¿›è¡Œç”Ÿäº§</span></span><br><span class="line">reg = emptyCount;</span><br><span class="line">reg = reg <span class="number">-1</span>;</span><br><span class="line">emptyCount = reg;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å®é™…æœ‰å¯èƒ½çš„è°ƒåº¦æƒ…å†µ</span></span><br><span class="line">p1.reg = emptyCount; <span class="comment">//5</span></span><br><span class="line">p1.reg = p1.reg <span class="number">-1</span>;  <span class="comment">//4</span></span><br><span class="line">p2.reg = emptyCount; <span class="comment">//5</span></span><br><span class="line">p2.reg = p2.reg <span class="number">-1</span>;  <span class="comment">//4</span></span><br><span class="line">emptyCount = p1.reg; <span class="comment">//4</span></span><br><span class="line">emptyCount = p2.reg; <span class="comment">//4</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ“ä½œç³»ç»Ÿ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç”Ÿäº§è€… </tag>
            
            <tag> æ“ä½œç³»ç»Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
